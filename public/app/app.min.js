!function(){"use strict";function e(e,t,r,n){n.state("app",{templateUrl:"app/app.html"}),r.html5Mode({enabled:!0,requireBase:!1}),e.otherwise(function(e){e.get("$state").go("app.404")}),t.interceptors.push("apiInterceptor")}function t(e,t){e.initialize(),t.initialize()}angular.module("app",["ngAnimate","ngSanitize","permission","ui.router","satellizer","angular-loading-bar","720kb.tooltips","ui.bootstrap","directives","filters","services","config","access-control","util","viewsAndPartials","auth","home","profile","articles","category","ui","search","me","404"]).config(e).run(t),e.$inject=["$urlRouterProvider","$httpProvider","$locationProvider","$stateProvider"],t.$inject=["configService","userService"]}(),function(){"use strict";function e(e){e.state("app.404",{views:{"wide-content":{templateUrl:"app/404/404.html",controller:"NotFoundController as vm"}},params:{message:null}})}angular.module("404",[]).config(e),e.$inject=["$stateProvider"]}(),function(){"use strict";function e(e){e.state("app.article",{url:"/@:username/:articleSlug",views:{head:{templateUrl:"app/articles/article/head.html",controller:"ArticleHeadController as vm"},"article-content":{templateUrl:"app/articles/article/article.html",controller:"ArticleController as vm"}},resolve:{articleResolver:t}}).state("app.write",{url:"/write",data:{permissions:{only:["isAuthenticated"],redirectTo:"app.home"}},views:{head:{templateUrl:"app/articles/write-or-edit/head.html"},"wide-content":{templateUrl:"app/articles/write-or-edit/write-or-edit.html",controller:"WriteOrEditController as vm"}},resolve:{writeOrEditResolver:r}}).state("app.edit",{url:"/@:username/:articleSlug/edit?draft",data:{permissions:{only:["isAuthenticated"],redirectTo:"app.home"}},views:{head:{templateUrl:"app/articles/write-or-edit/head.html"},"wide-content":{templateUrl:"app/articles/write-or-edit/write-or-edit.html",controller:"WriteOrEditController as vm"}},params:{title:null,body:null,categories:null,draft:{value:"false",squash:!0}},resolve:{writeOrEditResolver:r}})}function t(e,t){return t.getPublic(e.articleSlug)}function r(e,t){return"true"===e.toParams.draft?t.getDraft(e.toParams.articleSlug):"false"===e.toParams.draft?t.getPublic(e.toParams.articleSlug):void 0}angular.module("articles",[]).config(e),e.$inject=["$stateProvider"],t.$inject=["$stateParams","articleService"],r.$inject=["$state","articleService"]}(),function(){"use strict";function e(e,r,n){r.loginUrl=n.url+"/authenticate",e.state("app.signup",{url:"/signup",data:{permissions:{except:["isAuthenticated"],redirectTo:"app.home"}},views:{head:{templateUrl:"app/auth/signup/head.html"},"wide-content":{templateUrl:"app/auth/signup/signup.html",controller:"SignupController as vm"}}}).state("app.login",{url:"/login",data:{permissions:{except:["isAuthenticated"],redirectTo:"app.home"}},views:{head:{templateUrl:"app/auth/login/head.html"},"wide-content":{templateUrl:"app/auth/login/login.html",controller:"LoginController as vm"}}}).state("app.logout",{url:"/logout",data:{permissions:{except:["isAnonymous"],redirectTo:"app.login"}},resolve:{logoutResolver:t}}).state("app.reset",{url:"/reset",views:{head:{templateUrl:"app/auth/password-forgot/head.html"},"wide-content":{templateUrl:"app/auth/password-forgot/password-forgot.html",controller:"PasswordForgotController as vm"}}}).state("app.reset-password",{url:"/reset/:token",data:{permissions:{only:["isTokenValid"],redirectTo:"app.reset"}},views:{head:{templateUrl:"app/auth/password-reset/head.html"},"wide-content":{templateUrl:"app/auth/password-reset/password-reset.html",controller:"PasswordResetController as vm"}}})}function t(e){return e.logout()}angular.module("auth",[]).config(e),e.$inject=["$stateProvider","$authProvider","config"],t.$inject=["authService"]}(),function(){"use strict";function e(e){e.state("app.category",{url:"/category/:categorySlug",views:{head:{templateUrl:"app/category/head.html",controller:"CategoryHeadController as vm"},header:{templateUrl:"app/category/header.html",controller:"CategoryHeaderController as vm"},"wide-content":{templateUrl:"app/category/content.html",controller:"CategoryContentController as vm"}},resolve:{categoryResolver:t}})}function t(e,t){return t.getAllForCategory(e.categorySlug)}angular.module("category",[]).config(e),e.$inject=["$stateProvider"],t.$inject=["$stateParams","articleService"]}(),function(){"use strict";function e(e){e.state("app.me",{url:"/me","abstract":!0,data:{permissions:{only:["isAuthenticated"],redirectTo:"app.home"}}})}angular.module("me",["stories","settings"]).config(e),e.$inject=["$stateProvider"]}(),function(){"use strict";function e(e){e.state("app.profile",{url:"/@:username",views:{head:{templateUrl:"app/profile/head.html",controller:"ProfileHeadController as vm"},header:{templateUrl:"app/profile/header.html",controller:"ProfileHeaderController as vm"},"wide-content":{templateUrl:"app/profile/content.html",controller:"ProfileContentController as vm"}},resolve:{profileResolver:t}})}function t(e,t){return t.getUser(e.username)}angular.module("profile",[]).config(e),e.$inject=["$stateProvider"],t.$inject=["$stateParams","profileService"]}(),function(){"use strict";function e(e){e.state("app.search",{url:"/search?q",views:{"search-header":{templateUrl:"app/search/header.html",controller:"SearchHeaderController as vm"},"wide-content":{templateUrl:"app/search/content.html"}}}).state("app.search.results",{views:{"results@app.search":{templateUrl:"app/search/results.html",controller:"SearchResultsController as vm"}},resolve:{searchResolver:r}})}function t(e,t){e.$on("$stateChangeStart",function(e,r,n){"app.search"==r.name&&n.q&&(e.preventDefault(),t.go("app.search.results",{q:n.q}))})}function r(e,t){return t.all(e.q)}angular.module("search",[]).config(e).run(t),e.$inject=["$stateProvider"],t.$inject=["$rootScope","$state"],r.$inject=["$stateParams","searchService"]}(),function(){"use strict";function e(e){e.state("app.home",{url:"/",views:{head:{templateUrl:"app/home/head.html"},header:{templateUrl:"app/home/header.html",controller:"HomeHeaderController as vm"},content:{templateUrl:"app/home/content.html",controller:"HomeContentController as vm"}},resolve:{articlesResolver:t}})}function t(e){return e.get()}angular.module("home",[]).config(e),e.$inject=["$stateProvider"],t.$inject=["articleService"]}(),function(){"use strict";angular.module("ui",["ui.form-group-item","ui.focus","ui.affix","ui.heading","ui.modal","ui.scroll-to-top-when","ui.toggle-active","ui.widget","ui.profile-card","ui.subview-menu","ui.navbar","ui.header-canopy","ui.alert","ui.message","ui.when-scrolled"])}(),function(){"use strict";function e(e){e.state("app.me.settings",{url:"/settings",views:{"head@app":{templateUrl:"app/me/settings/head.html"},"wide-content@app":{templateUrl:"app/me/settings/settings.html"}},"default":"app.me.settings.account",params:{menu:"settings"}}).state("app.me.settings.account",{url:"/account",views:{"@app.me.settings":{templateUrl:"app/me/settings/account/account.html",controller:"SettingsAccountController as vm"}}}).state("app.me.settings.password",{url:"/password",views:{"@app.me.settings":{templateUrl:"app/me/settings/password/password.html",controller:"SettingsPasswordController as vm"}}})}function t(e){e.goDefaultChildState()}angular.module("settings",[]).config(e).run(t),e.$inject=["$stateProvider"],t.$inject=["redirectService"]}(),function(){"use strict";function e(e){e.state("app.me.stories",{url:"/stories",views:{"head@app":{templateUrl:"app/me/stories/head.html"},"wide-content@app":{templateUrl:"app/me/stories/stories.html"}},"default":"app.me.stories.drafts",params:{menu:"stories"}}).state("app.me.stories.drafts",{url:"/drafts",views:{"@app.me.stories":{templateUrl:"app/me/stories/drafts/drafts.html",controller:"DraftsController as vm"}},resolve:{draftsResolver:r}}).state("app.me.stories.published",{url:"/published",views:{"@app.me.stories":{templateUrl:"app/me/stories/published/published.html",controller:"PublishedController as vm"}},resolve:{publishedResolver:n}}).state("app.me.stories.unpublished",{url:"/unpublished",views:{"@app.me.stories":{templateUrl:"app/me/stories/unpublished/unpublished.html",controller:"UnpublishedController as vm"}},resolve:{unpublishedResolver:o}})}function t(e){e.goDefaultChildState()}function r(e){return e.getUserDrafts()}function n(e){return e.getUserPublished()}function o(e){return e.getUserUnpublished()}angular.module("stories",[]).config(e).run(t),e.$inject=["$stateProvider"],t.$inject=["redirectService"],r.$inject=["articleService"],n.$inject=["articleService"],o.$inject=["articleService"]}(),function(){"use strict";function e(e,t,r,n,o,i){function a(){n.definePermission("isAnonymous",c),n.definePermission("isAuthenticated",u),n.definePermission("isTokenValid",l)}function s(){o.defineRole("isEditableByUser",[],d)}function c(){return!e.isAuthenticated()}function u(){return e.isAuthenticated()}function l(e){var n=t.defer();return r.verifyToken(e.token).then(function(e){200==e.status?n.resolve():n.reject()})["catch"](function(){n.reject()}),n.promise}function d(e){var r=t.defer();return i.verifyEdit(e.articleSlug).then(function(e){200==e.status?r.resolve():r.reject()})["catch"](function(){r.reject()}),r.promise}a(),s()}angular.module("access-control",[]).run(e),e.$inject=["$auth","$q","authService","PermissionStore","RoleStore","articleService"]}(),function(){"use strict";function e(e,t){e.configure({smart:!0,"tooltip-hide-trigger":"mouseleave",speed:"fast"}),t.includeSpinner=!1}angular.module("config",[]).config(e),e.$inject=["tooltipsConfProvider","cfpLoadingBarProvider"]}(),function(){"use strict";angular.module("directives",[])}(),function(){"use strict";function e(e,t){function r(r,o){var i=o[0].tagName.toLowerCase();"view-title"!==i&&"viewTitle"!==i||o.remove(),r.$watch(function(){return o.text()},function(t){e.viewTitle=n=t}),r.$on("$destroy",function(){n=void 0,t(function(){n||delete e.viewTitle})})}var n,o={restrict:"EA",link:r};return o}angular.module("directives").directive("viewTitle",e),e.$inject=["$rootScope","$timeout"]}(),function(){"use strict";angular.module("filters",[])}(),function(){"use strict";angular.module("services",[])}(),function(){"use strict";angular.module("util",[])}(),function(){"use strict";angular.module("ui.affix",[])}(),function(){"use strict";angular.module("ui.alert",[])}(),function(){"use strict";angular.module("ui.focus",[])}(),function(){"use strict";angular.module("ui.form-group-item",[])}(),function(){"use strict";angular.module("ui.header-canopy",[])}(),function(){"use strict";angular.module("ui.heading",[])}(),function(){"use strict";angular.module("ui.message",[])}(),function(){"use strict";angular.module("ui.modal",[])}(),function(){"use strict";angular.module("ui.navbar",[])}(),function(){"use strict";angular.module("ui.profile-card",[])}(),function(){"use strict";angular.module("ui.scroll-to-top-when",[])}(),function(){"use strict";angular.module("ui.subview-menu",[])}(),function(){"use strict";angular.module("ui.toggle-active",[])}(),function(){"use strict";angular.module("ui.when-scrolled",[])}(),function(){"use strict";angular.module("ui.widget",[])}(),function(){"use strict";function e(e,t){function r(){t.go("app.search.results",{q:n.q})}var n=this;n.message=e.message,n.search=r,n.q=""}angular.module("404").controller("NotFoundController",e),e.$inject=["$stateParams","$state"]}(),function(){"use strict";function e(){function e(e,t,r){e.articles=e.$eval(r.data)||null,e.$on("stories:loaded",function(t,r){for(var n=0;n<r.length;n++)e.articles.push(r[n])})}var t={restrict:"AE",scope:{},templateUrl:"app/articles/articles.html",link:e};return t}angular.module("articles").directive("articles",e)}(),function(){"use strict";function e(e,t,r,n){function o(){C&&U.get(y).then(function(t){0===t.articles.length?C=!1:(y=t.nextPageUrl,e.$broadcast("stories:loaded",t.articles))})["catch"](function(e){console.log("Error loading more stories: ",e)})}function i(e){return t.get(r.url+(e||"/articles")).then(n.handleSuccess,n.handleError)}function a(){return t.get(r.url+"/top-stories").then(n.handleSuccess,n.handleError)}function s(e){return t.get(r.url+"/category/"+e).then(n.handleSuccess,n.handleError)}function c(){return t.get(r.url+"/articles/draft").then(n.handleSuccess,n.handleError)}function u(){return t.get(r.url+"/articles/published").then(n.handleSuccess,n.handleError)}function l(){return t.get(r.url+"/articles/unpublished").then(n.handleSuccess,n.handleError)}function d(e){return t.get(r.url+"/articles/"+e).then(n.handleSuccess,n.handleError)}function f(e){return t.get(r.url+"/articles/"+e+"/draft").then(n.handleSuccess,n.handleError)}function p(e){return t.post(r.url+"/articles/create/public",e).then(n.handleSuccess,n.handleError)}function m(e){return t.put(r.url+"/articles/save/draft",e).then(n.handleSuccess,n.handleError)}function g(e,o){return t.put(r.url+"/articles/"+o+"/edit",e).then(n.handleSuccess,n.handleError)}function h(e){return t.post(r.url+"/articles/"+e+"/edit/verify").then(n.handleSuccess,n.handleError)}function v(e){return t.put(r.url+"/articles/"+e+"/publish").then(n.handleSuccess,n.handleError)}function $(e){return t.put(r.url+"/articles/"+e+"/unpublish").then(n.handleSuccess,n.handleError)}function S(e){return t.put(r.url+"/articles/"+e+"/delete").then(n.handleSuccess,n.handleError)}function w(e){return t.put(r.url+"/articles/heart/"+e,null,{ignoreLoadingBar:!0})}function b(e){return t.put(r.url+"/articles/unheart/"+e,null,{ignoreLoadingBar:!0})}var y="/articles?page=2",C=!0,U={loadStories:o,get:i,getTopStories:a,getAllForCategory:s,getUserDrafts:c,getUserPublished:u,getUserUnpublished:l,getPublic:d,getDraft:f,createPublic:p,saveDraft:m,edit:g,verifyEdit:h,publish:v,unpublish:$,forceDelete:S,heart:w,unheart:b};return U}angular.module("articles").factory("articleService",e),e.$inject=["$rootScope","$http","config","apiService"]}(),function(){"use strict";function e(e,t,r,n,o,i){function a(t){return e.post(i.url+"/signup",t)}function s(r){return t.login(r).then(function(){return e.get(i.url+"/authenticate/user").then(n.handleSuccess,n.handleError)})}function c(){return e.post(i.url+"/logout").then(function(){return t.logout().then(function(){o.removeUser(),r.go("app.home")})})}function u(t){return e.post(i.url+"/reset",t).then(n.handleSuccess,n.handleError)}function l(t,r){return e.post(i.url+"/reset/"+t,r).then(n.handleSuccess,n.handleError)}function d(t){return e.get(i.url+"/reset/verify/"+t)}var f={signup:a,login:s,logout:c,sendResetLink:u,resetPassword:l,verifyToken:d};return f}angular.module("auth").factory("authService",e),e.$inject=["$http","$auth","$state","apiService","userService","config"]}(),function(){"use strict";function e(e){var t=this;t.articles=e.articles}angular.module("category").controller("CategoryContentController",e),e.$inject=["categoryResolver"]}(),function(){"use strict";function e(e){var t=this;t.category=e.category}angular.module("category").controller("CategoryHeadController",e),e.$inject=["categoryResolver"]}(),function(){"use strict";function e(e){var t=this;t.category=e.category}angular.module("category").controller("CategoryHeaderController",e),e.$inject=["categoryResolver"]}(),function(){"use strict";function e(e){var t=this;t.articles=e.articles,t.user=e.user,t.hasContent=t.articles.length>0}angular.module("profile").controller("ProfileContentController",e),e.$inject=["profileResolver"]}(),function(){"use strict";function e(e){var t=this;t.user=e.user}angular.module("profile").controller("ProfileHeadController",e),e.$inject=["profileResolver"]}(),function(){"use strict";function e(e){var t=this;t.user=e.user}angular.module("profile").controller("ProfileHeaderController",e),e.$inject=["profileResolver"]}(),function(){"use strict";function e(e,t,r){function n(n){return e.get(r.url+"/profile/user/"+n).then(t.handleSuccess,t.handleError)}var o={getUser:n};return o}angular.module("profile").factory("profileService",e),e.$inject=["$http","apiService","config"]}(),function(){"use strict";function e(e){function t(){e.go("app.search.results",{q:r.q})}var r=this;r.search=t,r.q=""}angular.module("search").controller("SearchHeaderController",e),e.$inject=["$state"]}(),function(){"use strict";function e(e){var t=this;t.articles=e.articles,t.categories=e.categories,t.users=e.users,t.results=t.articles.length>0||t.categories.length>0||t.users.length>0}angular.module("search").controller("SearchResultsController",e),e.$inject=["searchResolver"]}(),function(){"use strict";function e(e,t,r){function n(n){return e.get(r.url+"/search?q="+n).then(t.handleSuccess,t.handleError)}function o(n){return e.get(r.url+"/search/categories?q="+n).then(t.handleSuccess,t.handleError)}var i={all:n,findCategories:o};return i}angular.module("search").factory("searchService",e),e.$inject=["$http","apiService","config"]}(),function(){"use strict";function e(e,t){function r(){t.getTopStories().then(function(e){i.topArticles=e.articles})["catch"](function(e){console.log("Error fetching top stories: ",e)})}function n(){for(var e=0;e<i.articles.length;e++)if(i.articles[e].categories)for(var t=0;t<i.articles[e].categories.length;t++)o(i.articles[e].categories[t])||i.categories.push(i.articles[e].categories[t])}function o(e){return i.categories.some(function(t){return Object.is(JSON.stringify(e),JSON.stringify(t))})}var i=this;i.articles=e.articles,i.topArticles=[],i.categories=[],i.loadStories=t.loadStories,r(),n()}angular.module("home").controller("HomeContentController",e),e.$inject=["articlesResolver","articleService"]}(),function(){"use strict";function e(){}angular.module("home").controller("HomeHeaderController",e)}(),function(){"use strict";function e(e){var t=this;t.article=e.article,t.author=e.author}angular.module("articles").controller("ArticleController",e),e.$inject=["articleResolver"]}(),function(){"use strict";function e(e){var t=this;t.article=e.article}angular.module("articles").controller("ArticleHeadController",e),e.$inject=["articleResolver"]}(),function(){"use strict";function e(){function e(e,t,r){if(r.data){var n=e.$eval(r.data);e.categories=n,e.inverse=r.inverse||!1}}var t={restrict:"EA",templateUrl:"app/articles/categories/categories.html",link:e};return t}angular.module("articles").directive("categories",e)}(),function(){"use strict";function e(e){function t(t,r,n){function o(){!s&&c<5?e.heart(n.id).then(i):s&&c<5&&e.unheart(n.id).then(a)}function i(){s=!0,t.heartSuccess=!0,t.heartCount++,c++}function a(){s=!1,t.heartSuccess=!1,t.heartCount--,c++}var s=!1,c=0;n.count&&(t.heartCount=n.count,t.heart=o)}var r={restrict:"EA",scope:{},templateUrl:"app/articles/hearts/hearts.html",link:t};return r}angular.module("ui").directive("hearts",e),e.$inject=["articleService"]}(),function(){"use strict";function e(){function e(e,t,r){if(r.data){var n=e.$eval(r.data);e.articles=n}}var t={restrict:"A",scope:{},templateUrl:"app/articles/top-stories/top-stories.html",link:e};return t}angular.module("articles").directive("topStories",e)}(),function(){"use strict";function e(e){function t(t,r,n,o){function i(){t.$apply(function(){o.$setViewValue(a.getData())})}var a=CKEDITOR.replace(r[0],{language:"en",extraPlugins:"confighelper,autogrow",placeholder:"Share your story..."});if(!o)throw"ng-model is missing!";a.on("instanceReady",function(){a.setData(o.$viewValue),e.$broadcast("editor:ready")}),a.on("change",i),a.on("key",i),a.on("dataReady",i),o.$render=function(e){a.setData(o.$viewValue)}}var r={require:"?ngModel",restrict:"A",link:t};return r}angular.module("articles").directive("editor",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,r,n,o,i,a,s,c,u){function l(){U=!0}function d(){C=!0,f(a.article)}function f(e){if(b.data.id=e.id,b.data.title=e.title,b.data.body=e.body,e.categories)for(var t=0;t<e.categories.length;t++)p(e.categories[t])}function p(e){b.data.categoryIdList.indexOf(e.id)===-1&&b.data.categoryIdList.push(e.id);for(var t=!0,r=0;r<b.categoriesSelected.length;r++)if(b.categoriesSelected[r].id===e.id){t=!1;break}t&&b.categoriesSelected.push(e)}function m(e){var t=b.data.categoryIdList.indexOf(e);t>-1&&b.data.categoryIdList.splice(t,1);for(var r=0;r<b.categoriesSelected.length;r++)b.categoriesSelected[r].id===e&&b.categoriesSelected.splice(r,1)}function g(){c.findCategories(b.q).then(function(e){b.categoriesFromSearch=e.categories})["catch"](function(e){console.log("Error searching for categories: ",e)})}function h(){U?v():C&&("true"===n.draft?v():"false"===n.draft&&$())}function v(){s.saveDraft(b.data).then(function(e){t.$broadcast("message",{message:e.message})})["catch"](function(e){console.log("Error saving draft: ",e)})}function $(){s.edit(b.data,n.articleSlug).then(function(e){t.$broadcast("message",{message:e.message})})["catch"](function(e){console.log("Error editing article: ",e)})}function S(){b.data.title.length>0||b.data.body.length>0||b.data.categoryIdList.length>0?"app.write"===o.current.name||"true"===n.draft?s.createPublic(b.data).then(function(e){w(e.article)})["catch"](function(e){console.log("Error creating article: ",e)}):"app.edit"===o.current.name&&"false"===n.draft&&s.edit(b.data,n.articleSlug).then(function(e){w(e.article),t.$broadcast("message",{message:e.message})})["catch"](function(e){console.log("Error editing article: ",e)}):(b.errors={title:!0,body:!0},i(function(){b.errors={}},1e3))}function w(e){o.go("app.article",{username:e.author.username,articleSlug:e.slug},{notify:!1}).then(function(){t.$broadcast("$stateChangeSuccess")})}var b=this,y={id:"",title:"",body:"",categoryIdList:[]},C=!1,U=!1;switch(b.q="",b.categoriesSelected=[],b.categoriesFromSearch=[],b.data={id:"",title:"",body:"",categoryIdList:[]},b.submit=S,b.search=g,b.addCategory=p,b.removeCategory=m,o.current.name){case"app.write":l();break;case"app.edit":d()}e.onbeforeunload=function(){return h(),null},r.$on("editor:ready",function(){y=JSON.stringify(b.data)}),r.$on("$stateChangeStart",function(e,r,n,i,a){function s(){o.go(r.name,n,{notify:!1}).then(function(){t.$broadcast("$stateChangeSuccess",r,n,i,a)})}var c=y===JSON.stringify(b.data);if(!c){e.preventDefault();var l={actionButtonText:"Save",closeButtonText:"Don't save",headerText:"Save",bodyText:"You've made some changes. Do you want to save?"};u.showModal({},l).then(function(){h(),s()})["catch"](s)}}),r.$watch("vm.q",function(e){!e||e.length<=1||i(function(){e===b.q&&b.search()},1e3)})}angular.module("articles").controller("WriteOrEditController",e),e.$inject=["$window","$rootScope","$scope","$stateParams","$state","$timeout","writeOrEditResolver","articleService","searchService","modalService"]}(),function(){"use strict";function e(e,t,r,n){function o(e){n.login(e).then(i,a)}function i(e){r.setUser(e.user),t.go("app.home")}function a(t){t.data&&!t.data.error?(s.errors=t.data,console.log(s.errors)):t.data.error&&e.$broadcast("input:error",{message:t.data.error.message})}var s=this;s.login=o}angular.module("auth").controller("LoginController",e),e.$inject=["$rootScope","$state","userService","authService"]}(),function(){"use strict";function e(e,t){function r(){t.sendResetLink({email:i.email}).then(n,o)}function n(t){i.errors=[],e.$broadcast("input:success",{message:t.message})}function o(t){t.data&&!t.data.error?(i.errors=t.data,console.log(i.error)):t.data.error&&e.$broadcast("input:error",{message:t.data.error.message})}var i=this;i.sendResetLink=r}angular.module("auth").controller("PasswordForgotController",e),e.$inject=["$rootScope","authService"]}(),function(){"use strict";function e(e,t,r){function n(){r.resetPassword(t.token,{token:t.token,password:a.password,passwordConfirmation:a.passwordConfirmation}).then(o,i)}function o(t){a.errors=[],e.$broadcast("input:success",{message:t.message})}function i(t){t.data&&!t.data.error?a.errors=t.data:t.data.password?(a.errors=t.data.password,console.log(a.errors)):t.data.error&&e.$broadcast("input:error",{message:t.data.error.message})}var a=this;a.resetPassword=n}angular.module("auth").controller("PasswordResetController",e),e.$inject=["$rootScope","$stateParams","authService"]}(),function(){"use strict";function e(e,t){function r(){t.signup({name:i.name,email:i.email,password:i.password,passwordConfirmation:i.passwordConfirmation}).then(n,o)}function n(){e("LoginController").login({email:i.email,password:i.password})}function o(e){e.data&&!e.data.error?(i.errors=e.data,console.log(i.errors)):e.data.error&&(i.errors=e.data.error.message,console.log(i.errors))}var i=this;i.signup=r}angular.module("auth").controller("SignupController",e),e.$inject=["$controller","authService"]}(),function(){"use strict";function e(){function e(e,t){for(var r=0;r<e.length;r++)e[r].slug==t&&e.splice(r,1);return e}var t={removeFromCollection:e};return t}angular.module("me").factory("meStoriesService",e)}(),function(){"use strict";function e(e){e.decorator("$state",["$delegate","$rootScope",function(e,t){return t.$on("$stateChangeStart",function(t,r,n,o,i){e.toState=r,e.toParams=n,e.fromState=o,e.fromParams=i}),e}])}function t(e,t){function r(){o.prepareDocument()}function n(){e.$on("$stateChangeSuccess",function(){t[0].body.scrollTop=t[0].documentElement.scrollTop=0})}var o={initialize:r,prepareDocument:n};return o}angular.module("config").constant("config",{url:"http://"+window.location.hostname+"/api/v1",version:"1.0.0"}).config(e).factory("configService",t),e.$inject=["$provide","cfpLoadingBarProvider"],t.$inject=["$rootScope","$document"]}(),function(){"use strict";function e(e){function t(e,t){r.append(t),e.$on("$destroy",function(){t.remove()})}var r=angular.element(e[0].head),n={restrict:"A",link:t};return n}angular.module("directives").directive("viewHead",e),e.$inject=["$document"]}(),function(){"use strict";function e(){function e(e){return String(e).replace(/[&<>"'\/]/g,function(e){return t[e]})}var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};return e}angular.module("filters").filter("escapeHtml",e)}(),function(){"use strict";function e(){function e(e,t,r,n){if(!e)return"";if(r=parseInt(r),!r||e.length<=r)return e;if(e=e.substr(0,r),t){var o=e.lastIndexOf(" ");o!=-1&&(e=e.substr(0,o))}return e+(n||"&hellip;")}return e}angular.module("filters").filter("shorten",e)}(),function(){"use strict";function e(e,t){function r(e){return e}function n(e){return e}function o(e){return e}function i(r){return 404==r.status&&t.get("$state").go("app.404",{message:r.data.error.message}),e.reject(r)}var a={request:r,requestError:n,response:o,responseError:i};return a}angular.module("services").factory("apiInterceptor",e),e.$inject=["$q","$injector"]}(),function(){"use strict";function e(e){function t(e){return"object"==typeof e.data?e.data:void r(e)}function r(t){return e.reject(t)}var n={handleSuccess:t,handleError:r};return n}angular.module("services").factory("apiService",e),e.$inject=["$q"]}(),function(){"use strict";function e(e,t){function r(){e.$on("$stateChangeStart",function(e,r,n){r["default"]&&(e.preventDefault(),t.go(r["default"],n))})}var n={goDefaultChildState:r};return n}angular.module("services").factory("redirectService",e),e.$inject=["$rootScope","$state"]}(),function(){"use strict";function e(e){function t(){var e=localStorage.getItem("user");null!==e?a(e,!0):s()}function r(e){o(e),a(e)}function n(){i(),s()}function o(e){localStorage.setItem("user",JSON.stringify(e))}function i(){localStorage.removeItem("user")}function a(t,r){e.$broadcast("authenticated"),r?e.currentUser=JSON.parse(t):e.currentUser=t}function s(){e.$broadcast("unauthenticated"),e.currentUser=null}var c={initialize:t,setUser:r,removeUser:n};return c}angular.module("services").factory("userService",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(){var e={};return e}angular.module("util").factory("util",e)}(),function(){"use strict";function e(e){function t(t,r){var n,o=angular.element(document.querySelector("#navbar")),i=angular.element(document.querySelector("#header")),a=angular.element(document.querySelector("#search-header"));e(function(){n=o[0].offsetTop+i[0].offsetHeight||a[0].offsetHeight,r.affix({offset:{top:n}})},!1)}var r={restrict:"A",link:t};return r}angular.module("ui.affix").directive("uiAffix",e),e.$inject=["$timeout"]}(),function(){"use strict";function e(){function e(e){e.$on("input:success",function(t,r){e.error=!1,e.success=!0,e.message=r.message}),e.$on("input:error",function(t,r){e.success=!1,e.error=!0,e.message=r.message})}var t={restrict:"A",templateUrl:"app/ui/alert/alert.html",link:e};return t}angular.module("ui.alert").directive("uiAlert",e)}(),function(){"use strict";function e(){function e(e,t){t.focus()}var t={restrict:"A",link:e};return t}angular.module("ui.focus").directive("uiFocus",e)}(),function(){"use strict";function e(){}function t(){function e(e,t,r){e.input=r.input||!1,e.textarea=r.textarea||!1,e.type=r.type||"text",e.label=r.label,e.id=r.id}var t={restrict:"A",scope:{model:"=",errors:"=",submit:"="},bindToController:!0,controller:"FormGroupItemController as vm",templateUrl:"app/ui/form-group-item/form-group-item.html",link:e};return t}angular.module("ui.form-group-item").controller("FormGroupItemController",e).directive("uiFormGroupItem",t)}(),function(){"use strict";function e(){function e(e,t,r){r.title&&r.description?(e.title=r.title,e.description=r.description):console.log("Missing title or description attribute in header-canopy-category directive!")}var t={restrict:"EA",templateUrl:"app/ui/header-canopy/header-canopy-category.html",link:e};return t}angular.module("ui.header-canopy").directive("uiHeaderCanopyCategory",e)}(),function(){"use strict";function e(){function e(e,t){e.close=function(){t.hide()}}var t={restrict:"A",link:e};return t}angular.module("ui.header-canopy").directive("uiHeaderCanopyHome",e)}(),function(){"use strict";function e(){function e(e,t,r){r.title?e.title=r.title:console.log("Missing title or description attribute in header-canopy-plain directive!")}var t={restrict:"EA",templateUrl:"app/ui/header-canopy/header-canopy-plain.html",link:e};return t}angular.module("ui.header-canopy").directive("uiHeaderCanopyPlain",e)}(),function(){"use strict";function e(){function e(e,t,r){if(r.user){var n=e.$eval(r.user);e.name=n.name,e.bio=n.bio,e.profileImage=n.profileImage}else console.log("Missing user attribute in header-canopy-profile directive!")}var t={restrict:"EA",templateUrl:"app/ui/header-canopy/header-canopy-profile.html",link:e};return t}angular.module("ui.header-canopy").directive("uiHeaderCanopyProfile",e)}(),function(){"use strict";function e(){function e(e,t,r){r.title&&(e.title=r.title,e.bold=r.bold||!1)}var t={restrict:"EA",scope:{},templateUrl:"app/ui/heading/heading.html",link:e};return t}angular.module("ui.heading").directive("uiHeading",e)}(),function(){"use strict";function e(e){function t(t,r,n){function o(){r.animate({top:"0px"},100)}function i(){r.animate({top:"-500px"},100)}t.$on("message",function(r,n){t.message=n.message,o(),e(function(){i()},5e3)})}var r={restrict:"A",templateUrl:"app/ui/message/message.html",replace:!0,link:t};return r}angular.module("ui.message").directive("uiMessage",e),e.$inject=["$timeout"]}(),function(){"use strict";function e(e){function t(e,t){return e||(e={}),e.backdrop="static",i.show(e,t)}function r(t,r){function i(e,t){e.modalOptions=s,e.modalOptions.ok=function(e){t.close(e)},e.modalOptions.close=function(e){t.dismiss("cancel")}}var a={},s={};return angular.extend(a,n,t),angular.extend(s,o,r),a.controller||(a.controller=i),i.$inject=["$scope","$uibModalInstance"],e.open(a).result}var n={backdrop:!0,keyboard:!0,animation:!1,templateUrl:"app/ui/modal/modal.html"},o={closeButtonText:"Cancel",actionButtonText:"Continue",headerText:"Are you sure?",bodyText:"This action may be irreversible."},i={showModal:t,show:r};return i}angular.module("ui.modal").factory("modalService",e),e.$inject=["$uibModal"]}(),function(){"use strict";function e(e,t){function r(r,n){function o(){return n.removeClass("closed"),t(function(){return n.css({overflow:"visible"});
},150)}function i(){var e=a.scrollTop();0===e?n.removeClass("shadow"):n.addClass("shadow"),Math.abs(c-e)<=s||(e>c?n.addClass("closed"):n.removeClass("closed"),c=e)}var a=angular.element(e),s=50,c=0;n.bind("mouseover",o),a.on("scroll",i)}var n={restrict:"A",link:r};return n}angular.module("ui.navbar",[]).directive("uiNavScroll",e),e.$inject=["$window","$timeout"]}(),function(){"use strict";function e(e,t){function r(){e.go("app.search.results",{q:n.q})}var n=this;n.writing=!1,n.search=r,n.q="",t.$watch(function(){return e.current.name},function(){n.writing="app.write"==e.current.name||"app.edit"==e.current.name,"app.home"===e.current.name?n.addBoxedLayout=!0:n.addBoxedLayout=!1})}angular.module("ui.navbar").controller("NavbarController",e),e.$inject=["$state","$scope"]}(),function(){"use strict";function e(){var e={restrict:"EA",templateUrl:"app/ui/navbar/navbar.html",controller:"NavbarController as vm"};return e}angular.module("ui.navbar").directive("uiNavbar",e)}(),function(){"use strict";function e(){function e(e,t,r){if(r.user){var n=e.$eval(r.user),o=r.articleDate,i=r.viewCount;e.profileImage=n.profileImage,e.username=n.username,e.name=n.name,e.bio=n.bio,e.date=o,e.viewCount=i,e.hoverTemplate='<div class="profile-card-hover"><div class="profile-card-hover--content"><a href="/@'+e.username+'"><h1>'+e.name+"</h1></a><p>"+e.bio+'</p></div><div class="profile-card-hover--image"><a href="/@'+e.username+'" title="View the profile of '+e.name+'"><img class="avatar md" src="'+e.profileImage+'"></a></div><div class="clearfix"></div><div class="profile-card-hover--footer"><a class="btn btn-primary text-center" href="/@'+e.username+'">Visit profile</a></div></div>'}}var t={restrict:"EA",templateUrl:"app/ui/profile-card/profile-card-sm.html",link:e};return t}angular.module("ui.profile-card").directive("uiProfileCardSm",e)}(),function(){"use strict";function e(){function e(e,t,r){if(r.user){var n=e.$eval(r.user);e.profileImage=n.profileImage,e.username=n.username,e.name=n.name,e.bio=n.bio}}var t={restrict:"EA",templateUrl:"app/ui/profile-card/profile-card.html",link:e};return t}angular.module("ui.profile-card").directive("uiProfileCard",e)}(),function(){"use strict";function e(e){function t(t,r,n){t.$on(n.scrollToTopWhen,function(){e(function(){angular.element(r)[0].scrollTop=0})})}var r={restrict:"A",link:t};return r}angular.module("ui.scroll-to-top-when").directive("uiScrollToTopWhen",e),e.$inject=["$timeout"]}(),function(){"use strict";function e(e,t,r,n){function o(){for(var e=0;e<a.menu.length;e++)a.menu[e].state==n.current.name?a.menu[e].selected=!0:a.menu[e].selected=!1}function i(e){n.go(e.state)}var a=this;a.menu=[],a.go=i,t.$watch(function(){return r.menu},function(){a.menu=e.getMenu(r.menu)}),t.$watch(function(){return n.current.name},function(){o()})}angular.module("ui.subview-menu").controller("SubviewMenuController",e),e.$inject=["subviewMenuService","$scope","$stateParams","$state"]}(),function(){"use strict";function e(){var e={restrict:"EA",templateUrl:"app/ui/subview-menu/subview-menu.html",controller:"SubviewMenuController as vm"};return e}angular.module("ui.subview-menu").directive("uiSubviewMenu",e)}(),function(){"use strict";function e(){function e(e){return t[e]}var t={settings:[{state:"app.me.settings.account",label:"Account",selected:!1},{state:"app.me.settings.password",label:"Password",selected:!1}],stories:[{state:"app.me.stories.drafts",label:"Drafts",selected:!1},{state:"app.me.stories.published",label:"Published",selected:!1},{state:"app.me.stories.unpublished",label:"Unpublished",selected:!1}]},r={getMenu:e};return r}angular.module("ui.subview-menu").factory("subviewMenuService",e)}(),function(){"use strict";function e(){function e(e,t){t.bind("click",function(){t.toggleClass("active")})}var t={restrict:"A",link:e};return t}angular.module("ui.toggle-active").directive("uiToggleActive",e)}(),function(){"use strict";function e(e,t){function r(r,n,o){var i=angular.element(e),a=!0;i.on("scroll",function(){a&&i.scrollTop()+i.height()>=t.height()/2&&(a=!1,r.$apply(o.uiWhenScrolled))}),r.$on("stories:loaded",function(){a=!0})}var n={restrict:"A",link:r};return n}angular.module("ui.when-scrolled").directive("uiWhenScrolled",e),e.$inject=["$window","$document"]}(),function(){"use strict";function e(){}angular.module("ui.widget").controller("WidgetFooterController",e)}(),function(){"use strict";function e(){function e(e,t,r){e.text=r.text||null}var t={restrict:"A",scope:{submit:"="},bindToController:!0,controller:"WidgetFooterController as vm",templateUrl:"app/ui/widget/widget-footer.html",link:e};return t}angular.module("ui.widget").directive("uiWidgetFooter",e)}(),function(){"use strict";function e(){function e(e,t,r){e.title=r.title||null,e.description=r.description||null}var t={restrict:"A",templateUrl:"app/ui/widget/widget-header.html",link:e};return t}angular.module("ui.widget").directive("uiWidgetHeader",e)}(),function(){"use strict";function e(e,t,r){function n(){t.updateUsername({username:s.username}).then(i,a)}function o(){t.updateBio({bio:s.bio}).then(i,a)}function i(t){s.errors=[],e.$broadcast("input:success",{message:t.message}),r.setUser(t.user)}function a(t){t.data&&!t.data.error?s.errors=t.data:t.data.error&&e.$broadcast("input:error",{message:t.data.error.message})}var s=this;s.updateUsername=n,s.updateBio=o,s.username=e.currentUser.username,s.bio=e.currentUser.bio}angular.module("settings").controller("SettingsAccountController",e),e.$inject=["$rootScope","settingsAccountService","userService"]}(),function(){"use strict";function e(e,t,r){function n(n){return e.put(r.url+"/settings/account/username",n).then(t.handleSuccess,t.handleError)}function o(n){return e.put(r.url+"/settings/account/bio",n).then(t.handleSuccess,t.handleError)}var i={updateUsername:n,updateBio:o};return i}angular.module("settings").factory("settingsAccountService",e),e.$inject=["$http","apiService","config"]}(),function(){"use strict";function e(e,t){function r(){t.changePassword({username:e.currentUser.username,email:e.currentUser.email,password:i.password,newPassword:i.newPassword,newPasswordConfirmation:i.newPasswordConfirmation}).then(n,o)}function n(t){i.errors=[],e.$broadcast("input:success",{message:t.message})}function o(t){t.data&&!t.data.error?(i.errors=t.data,console.log(i.errors)):t.data.error&&e.$broadcast("input:error",{message:t.data.error.message})}var i=this;i.submit=r}angular.module("settings").controller("SettingsPasswordController",e),e.$inject=["$rootScope","settingsPasswordService"]}(),function(){"use strict";function e(e,t,r){function n(n){return e.put(t.url+"/settings/password",n).then(r.handleSuccess,r.handleError)}var o={changePassword:n};return o}angular.module("settings").factory("settingsPasswordService",e),e.$inject=["$http","config","apiService"]}(),function(){"use strict";function e(e,t,r,n,o){function i(e){var i={actionButtonText:"Delete",headerText:"Delete",bodyText:"Deleted drafts are gone forever. Are you sure?"};n.showModal({},i).then(function(){r.forceDelete(e).then(function(r){t.removeFromCollection(a.drafts,e),o.$broadcast("message",{message:r.message})})["catch"](function(e){console.log(e)})})}var a=this;a.drafts=e.drafts,a.message=e.message||"You have no drafts.",a.forceDelete=i}angular.module("stories").controller("DraftsController",e),e.$inject=["draftsResolver","meStoriesService","articleService","modalService","$rootScope"]}(),function(){"use strict";function e(e,t,r,n,o){function i(e){var i={actionButtonText:"Publish",headerText:"Publish",bodyText:"Published stories are viewable by the public."};n.showModal({},i).then(function(){r.publish(e).then(function(r){t.removeFromCollection(s.articles,e),o.$broadcast("message",{message:r.message})})["catch"](function(e){console.log(e)})})}function a(e){var i={actionButtonText:"Delete",headerText:"Delete",bodyText:"Deleted stories are gone forever. Are you sure?"};n.showModal({},i).then(function(){r.forceDelete(e).then(function(r){t.removeFromCollection(s.articles,e),o.$broadcast("message",{message:r.message})})["catch"](function(e){console.log(e)})})}var s=this;s.articles=e.articles,s.message=e.message||"You don't have any unpublished stories.",s.publish=i,s.forceDelete=a}angular.module("stories").controller("UnpublishedController",e),e.$inject=["unpublishedResolver","meStoriesService","articleService","modalService","$rootScope"]}(),function(){"use strict";function e(e,t,r,n,o){function i(e){a.articleSlug=e;var i={actionButtonText:"Unpublish",headerText:"Unpublish",bodyText:"Unpublished stories are hidden from the public."};n.showModal({},i).then(function(){r.unpublish(e).then(function(r){t.removeFromCollection(a.articles,e),o.$broadcast("message",{message:r.message})})["catch"](function(e){console.log(e)})})}var a=this;a.articles=e.articles,a.message=e.message||"You haven't published any stories yet.",a.unpublish=i}angular.module("stories").controller("PublishedController",e),e.$inject=["publishedResolver","meStoriesService","articleService","modalService","$rootScope"]}();