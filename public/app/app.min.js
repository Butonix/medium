(function () { 'use strict';

    angular
        .module('app', [

            /*
             |--------------------------------------------------------------------------
             | External Modules
             |--------------------------------------------------------------------------
             |
             | These are the modules created by the AngularJS team, open source
             | projects or third party modules.
             |
             */

                'ngAnimate', 'ngSanitize', 'permission', 'ui.router', 'satellizer', 'angular-loading-bar',
                '720kb.tooltips', 'ui.bootstrap',

            /*
             |--------------------------------------------------------------------------
             | Internal Modules
             |--------------------------------------------------------------------------
             |
             | These are the modules that are meant to be shared throughout the
             | app, either as some kind of config, data, reusable component,
             | view or partial, etc.
             |
             */

                // Shared
                'directives', 'filters', 'services', 'config', 'access-control', 'util',

                // $templateCache
                'viewsAndPartials',

                // Other
                'auth', 'home', 'profile', 'articles', 'category', 'ui', 'search', 'me',

                // Errors
                '404'

        ])
        .config(config)
        .run(run);

    /**
     * @type {string[]}
     */
    config.$inject = ['$urlRouterProvider', '$httpProvider', '$locationProvider', '$stateProvider'];

    /**
     * @type {string[]}
     */
    run.$inject = ['configService', 'userService'];

    /**
     * Configure app.
     *
     * @param $urlRouterProvider
     * @param $httpProvider
     * @param $locationProvider
     * @param $stateProvider
     */
    function config($urlRouterProvider, $httpProvider, $locationProvider, $stateProvider) {
        $stateProvider.state('app', {
            templateUrl: 'app/app.html'
        });

        $locationProvider.html5Mode({
            enabled: true,
            requireBase: false
        });

        $urlRouterProvider.otherwise(function($injector) {
            $injector.get('$state').go('app.404');
        });

        $httpProvider.interceptors.push('apiInterceptor');
    }

    /**
     *  Initialize global configuration.
     *  Initialize user if logged in.
     *
     * @param configService
     * @param userService
     */
    function run(configService, userService) {
        configService.initialize();
        userService.initialize();
    }

})();
(function () { 'use strict';

    angular
        .module('auth', [])
        .config(configuration);

    /**
     * @type {string[]}
     */
    configuration.$inject = ['$stateProvider', '$authProvider', 'config'];

    /**
     * @type {string[]}
     */
    logoutResolver.$inject = ['authService'];

    /**
     * @param $stateProvider
     * @param $authProvider
     * @param config
     */
    function configuration($stateProvider, $authProvider, config) {
        // Satellizer configuration that specifies which API
        // route the JWT should be retrieved from
        $authProvider.loginUrl = config.url + '/authenticate';

        $stateProvider
            .state('app.signup', {
                url: '/signup',
                data: {
                    permissions: {
                        except: ['isAuthenticated'],
                        redirectTo: 'app.home'
                    }
                },
                views: {
                    'head': {
                        templateUrl: 'app/auth/signup/head.html'
                    },
                    'wide-content': {
                        templateUrl: 'app/auth/signup/signup.html',
                        controller: 'SignupController as vm'
                    }
                }
            })
            .state('app.login', {
                url: '/login',
                data: {
                    permissions: {
                        except: ['isAuthenticated'],
                        redirectTo: 'app.home'
                    }
                },
                views: {
                    'head': {
                        templateUrl: 'app/auth/login/head.html'
                    },
                    'wide-content': {
                        templateUrl: 'app/auth/login/login.html',
                        controller: 'LoginController as vm'
                    }
                }
            })
            .state('app.logout', {
                url: '/logout',
                data: {
                    permissions: {
                        except: ['isAnonymous'],
                        redirectTo: 'app.login'
                    }
                },
                resolve: {
                    logoutResolver: logoutResolver
                }
            })
            .state('app.reset', {
                url: '/reset',
                views: {
                    'head': {
                        templateUrl: 'app/auth/password-forgot/head.html'
                    },
                    'wide-content': {
                        templateUrl: 'app/auth/password-forgot/password-forgot.html',
                        controller: 'PasswordForgotController as vm'
                    }
                }
            })
            .state('app.reset-password', {
                url: '/reset/:token',
                data: {
                    permissions: {
                        only: ['isTokenValid'],
                        redirectTo: 'app.reset'
                    }
                },
                views: {
                    'head': {
                        templateUrl: 'app/auth/password-reset/head.html'
                    },
                    'wide-content': {
                        templateUrl: 'app/auth/password-reset/password-reset.html',
                        controller: 'PasswordResetController as vm'
                    }
                }
            });
    }

    /**
     * @param authService
     * @returns {*}
     */
    function logoutResolver(authService) {
        return authService.logout();
    }

})();
(function() { 'use strict';

    angular
        .module('404', [])
        .config(config);

    /**
     * @type {string[]}
     */
    config.$inject = ['$stateProvider'];

    /**
     * @param $stateProvider
     */
    function config($stateProvider) {
        $stateProvider
            .state('app.404', {
                views: {
                    'wide-content': {
                        templateUrl: 'app/404/404.html',
                        controller: 'NotFoundController as vm'
                    }
                },
                params: {
                    message: null
                }
            });
    }

})();
(function () { 'use strict';

    angular
        .module('articles', [])
        .config(config);

    /**
     * @type {string[]}
     */
    config.$inject = ['$stateProvider'];

    /**
     * @type {string[]}
     */
    articleResolver.$inject = ['$stateParams', 'articleService'];

    /**
     * @type {string[]}
     */
    writeOrEditResolver.$inject = ['$state', 'articleService'];

    /**
     * @param $stateProvider
     */
    function config($stateProvider) {
        $stateProvider
            .state('app.article', {
                url: '/@:username/:articleSlug',
                views: {
                    'head': {
                        templateUrl: 'app/articles/article/head.html',
                        controller: 'ArticleHeadController as vm'
                    },
                    'article-content': {
                        templateUrl: 'app/articles/article/article.html',
                        controller: 'ArticleController as vm'
                    }
                },
                resolve: {
                    articleResolver: articleResolver
                }
            })
            .state('app.write', {
                url: '/write',
                data: {
                    permissions: {
                        only: ['isAuthenticated'],
                        redirectTo: 'app.home'
                    }
                },
                views: {
                    'head': {
                        templateUrl: 'app/articles/write-or-edit/head.html'
                    },
                    'wide-content': {
                        templateUrl: 'app/articles/write-or-edit/write-or-edit.html',
                        controller: 'WriteOrEditController as vm'
                    }
                },
                resolve: {
                    writeOrEditResolver: writeOrEditResolver
                }
            })
            .state('app.edit', {
                url: '/@:username/:articleSlug/edit?draft',
                data: {
                    permissions: {
                        only: ['isAuthenticated'],
                        redirectTo: 'app.home'
                    }
                },
                views: {
                    'head': {
                        templateUrl: 'app/articles/write-or-edit/head.html'
                    },
                    'wide-content': {
                        templateUrl: 'app/articles/write-or-edit/write-or-edit.html',
                        controller: 'WriteOrEditController as vm'
                    }
                },
                params: {
                    title: null,
                    body: null,
                    categories: null,
                    draft: {
                        value: 'false',
                        squash: true
                    }
                },
                resolve: {
                    writeOrEditResolver: writeOrEditResolver
                }
            });
    }

    /**
     * @param $stateParams
     * @param articleService
     * @returns {*}
     */
    function articleResolver($stateParams, articleService) {
        return articleService.getPublic($stateParams.articleSlug);
    }

    /**
     * @param $state
     * @param articleService
     * @returns {*}
     */
    function writeOrEditResolver($state, articleService) {
        // Fetch a draft
        if ($state.toParams.draft === 'true') {
            return articleService.getDraft($state.toParams.articleSlug);
        }
        // Fetch a public story
        else if ($state.toParams.draft === 'false') {
            return articleService.getPublic($state.toParams.articleSlug);
        }
    }

})();
(function() { 'use strict';

    angular
        .module('category', [])
        .config(config);

    /**
     * @type {string[]}
     */
    config.$inject = ['$stateProvider'];

    /**
     * @type {string[]}
     */
    categoryResolver.$inject = ['$stateParams', 'articleService'];

    /**
     * @param $stateProvider
     */
    function config($stateProvider) {
        $stateProvider
            .state('app.category', {
                url: '/category/:categorySlug',
                views: {
                    'head': {
                        templateUrl: 'app/category/head.html',
                        controller: 'CategoryHeadController as vm'
                    },
                    'header': {
                        templateUrl: 'app/category/header.html',
                        controller: 'CategoryHeaderController as vm'
                    },
                    'wide-content': {
                        templateUrl: 'app/category/content.html',
                        controller: 'CategoryContentController as vm'
                    }
                },
                resolve: {
                    categoryResolver: categoryResolver
                }
            });
    }

    function categoryResolver($stateParams, articleService) {
        return articleService.getAllForCategory($stateParams.categorySlug);
    }

})();
(function() { 'use strict';

    angular
        .module('profile', [])
        .config(config);

    /**
     * @type {string[]}
     */
    config.$inject = ['$stateProvider'];

    /**
     * @type {string[]}
     */
    profileResolver.$inject = ['$stateParams', 'profileService'];

    /**
     * @param $stateProvider
     */
    function config($stateProvider) {
        $stateProvider
            .state('app.profile', {
                url: '/@:username',
                views: {
                    'head': {
                        templateUrl: 'app/profile/head.html',
                        controller: 'ProfileHeadController as vm'
                    },
                    'header': {
                        templateUrl: 'app/profile/header.html',
                        controller: 'ProfileHeaderController as vm'
                    },
                    'wide-content': {
                        templateUrl: 'app/profile/content.html',
                        controller: 'ProfileContentController as vm'
                    }
                },
                resolve: {
                    profileResolver: profileResolver
                }
            });
    }

    /**
     * @param $stateParams
     * @param profileService
     * @returns {*}
     */
    function profileResolver($stateParams, profileService) {
        return profileService.getUser($stateParams.username);
    }

})();
(function() { 'use strict';

    angular
        .module('me', ['stories', 'settings'])
        .config(config);

    /**
     * @type {string[]}
     */
    config.$inject = ['$stateProvider'];

    /**
     * @param $stateProvider
     */
    function config($stateProvider) {
        $stateProvider
            .state('app.me', {
                url: '/me',
                abstract: true,
                data: {
                    permissions: {
                        only: ['isAuthenticated'],
                        redirectTo: 'app.home'
                    }
                }
            });
    }

})();
(function() { 'use strict';

    angular
        .module('home', [])
        .config(config);

    /**
     * @type {string[]}
     */
    config.$inject = ['$stateProvider'];

    /**
     * @type {string[]}
     */
    articlesResolver.$inject = ['articleService'];

    /**
     * @param $stateProvider
     */
    function config($stateProvider) {
        $stateProvider
            .state('app.home', {
                url: '/',
                views: {
                    'head': {
                        templateUrl: 'app/home/head.html'
                    },
                    'header': {
                        templateUrl: 'app/home/header.html',
                        controller: 'HomeHeaderController as vm'
                    },
                    'content': {
                        templateUrl: 'app/home/content.html',
                        controller: 'HomeContentController as vm'
                    }
                },
                resolve: {
                    articlesResolver: articlesResolver
                }
            });
    }

    /**
     * @param articleService
     * @returns {*}
     */
    function articlesResolver(articleService) {
        return articleService.get();
    }

})();
(function() { 'use strict';

    angular
        .module('search', [])
        .config(config)
        .run(run);

    /**
     * @type {string[]}
     */
    config.$inject = ['$stateProvider'];

    /**
     * @type {string[]}
     */
    run.$inject = ['$rootScope', '$state'];

    /**
     * @type {string[]}
     */
    searchResolver.$inject = ['$stateParams', 'searchService'];

    /**
     * @param $stateProvider
     */
    function config($stateProvider) {
        $stateProvider
            .state('app.search', {
                url: '/search?q',
                views: {
                    'search-header': {
                        templateUrl: 'app/search/header.html',
                        controller: 'SearchHeaderController as vm'
                    },
                    'wide-content': {
                        templateUrl: 'app/search/content.html'
                    }
                }
            })
            .state('app.search.results', {
                views: {
                    'results@app.search': {
                        templateUrl: 'app/search/results.html',
                        controller: 'SearchResultsController as vm'
                    }
                },
                resolve: {
                    searchResolver: searchResolver
                }
            });
    }

    /**
     * @param $rootScope
     * @param $state
     */
    function run($rootScope, $state) {
        // If '/search' is loaded via refresh or direct access from address bar and
        // it contains a query string, go to the results state with the query string.
        $rootScope.$on('$stateChangeStart', function(event, toState, toParams) {
            if (toState.name == 'app.search' && toParams.q) {
                event.preventDefault();

                $state.go('app.search.results', {
                    q: toParams.q
                });
            }
        });
    }

    /**
     * @param $stateParams
     * @param searchService
     * @returns {Promise|*|{src}|{options}}
     */
    function searchResolver($stateParams, searchService) {
        return searchService.all($stateParams.q);
    }

})();
(function() { 'use strict';

    angular.module('ui', [
        'ui.form-group-item',
        'ui.focus',
        'ui.affix',
        'ui.heading',
        'ui.modal',
        'ui.scroll-to-top-when',
        'ui.toggle-active',
        'ui.widget',
        'ui.profile-card',
        'ui.subview-menu',
        'ui.navbar',
        'ui.header-canopy',
        'ui.alert',
        'ui.message',
        'ui.when-scrolled'
    ]);

})();
(function () { 'use strict';

    angular
        .module('stories', [])
        .config(config)
        .run(run);

    /**
     * @type {string[]}
     */
    config.$inject = ['$stateProvider'];

    /**
     * @type {string[]}
     */
    run.$inject = ['redirectService'];

    /**
     * @type {string[]}
     */
    draftsResolver.$inject = ['articleService'];

    /**
     * @type {string[]}
     */
    publishedResolver.$inject = ['articleService'];

    /**
     * @type {string[]}
     */
    unpublishedResolver.$inject = ['articleService'];

    /**
     * @param $stateProvider
     */
    function config($stateProvider) {
        $stateProvider
            .state('app.me.stories', {
                url: '/stories',
                views: {
                    'head@app': {
                        templateUrl: 'app/me/stories/head.html'
                    },
                    'wide-content@app': {
                        templateUrl: 'app/me/stories/stories.html'
                    }
                },
                default: 'app.me.stories.drafts',
                params: {
                    menu: 'stories'
                }
            })
            .state('app.me.stories.drafts', {
                url: '/drafts',
                views: {
                    '@app.me.stories': {
                        templateUrl: 'app/me/stories/drafts/drafts.html',
                        controller: 'DraftsController as vm'
                    }
                },
                resolve: {
                    draftsResolver: draftsResolver
                }
            })
            .state('app.me.stories.published', {
                url: '/published',
                views: {
                    '@app.me.stories': {
                        templateUrl: 'app/me/stories/published/published.html',
                        controller: 'PublishedController as vm'
                    }
                },
                resolve: {
                    publishedResolver: publishedResolver
                }
            })
            .state('app.me.stories.unpublished', {
                url: '/unpublished',
                views: {
                    '@app.me.stories': {
                        templateUrl: 'app/me/stories/unpublished/unpublished.html',
                        controller: 'UnpublishedController as vm'
                    }
                },
                resolve: {
                    unpublishedResolver: unpublishedResolver
                }
            });
    }

    /**
     * @param redirectService
     */
    function run(redirectService) {
        redirectService.goDefaultChildState();
    }

    /**
     * @param articleService
     * @returns {*}
     */
    function draftsResolver(articleService) {
        return articleService.getUserDrafts();
    }

    /**
     * @param articleService
     * @returns {*}
     */
    function publishedResolver(articleService) {
        return articleService.getUserPublished();
    }

    /**
     * @param articleService
     * @returns {*}
     */
    function unpublishedResolver(articleService) {
        return articleService.getUserUnpublished();
    }

})();
(function() { 'use strict';

    angular
        .module('settings', [])
        .config(config)
        .run(run);

    /**
     * @type {string[]}
     */
    config.$inject = ['$stateProvider'];

    /**
     * @type {string[]}
     */
    run.$inject = ['redirectService'];

    /**
     * @param $stateProvider
     */
    function config($stateProvider) {
        $stateProvider
            .state('app.me.settings', {
                url: '/settings',
                views: {
                    'head@app': {
                        templateUrl: 'app/me/settings/head.html'
                    },
                    'wide-content@app': {
                        templateUrl: 'app/me/settings/settings.html'
                    }
                },
                default: 'app.me.settings.account',
                params: {
                    menu: 'settings'
                }
            })
            .state('app.me.settings.account', {
                url: '/account',
                views: {
                    '@app.me.settings': {
                        templateUrl: 'app/me/settings/account/account.html',
                        controller: 'SettingsAccountController as vm'
                    }
                }
            })
            .state('app.me.settings.password', {
                url: '/password',
                views: {
                    '@app.me.settings': {
                        templateUrl: 'app/me/settings/password/password.html',
                        controller: 'SettingsPasswordController as vm'
                    }
                }
            });
    }

    /**
     * @param redirectService
     */
    function run(redirectService) {
        redirectService.goDefaultChildState();
    }

})();
(function() { 'use strict';

    angular
        .module('config', [])
        .config(config);

    /**
     * @type {string[]}
     */
    config.$inject = ['tooltipsConfProvider', 'cfpLoadingBarProvider'];

    /**
     * @param tooltipsConfProvider
     * @param cfpLoadingBarProvider
     */
    function config(tooltipsConfProvider, cfpLoadingBarProvider) {
        tooltipsConfProvider.configure({
            'smart': true,
            'tooltip-hide-trigger': 'mouseleave',
            'speed': 'fast'
        });

        cfpLoadingBarProvider.includeSpinner = false;
    }

})();
(function() { 'use strict';

    angular
        .module('access-control', [])
        .run(run);

    /**
     * @type {string[]}
     */
    run.$inject = ['$auth', '$q', 'authService', 'PermissionStore', 'RoleStore', 'articleService'];

    /**
     * @param $auth
     * @param $q
     * @param authService
     * @param PermissionStore
     * @param RoleStore
     * @param articleService
     */
    function run($auth, $q, authService, PermissionStore, RoleStore, articleService) {
        /**
         * Set permissions.
         */
        initializePermissions();
        initializeRoles();

        /**
         * Define all permissions for app.
         */
        function initializePermissions() {
            PermissionStore.definePermission('isAnonymous', isAnonymous);
            PermissionStore.definePermission('isAuthenticated', isAuthenticated);
            PermissionStore.definePermission('isTokenValid', isTokenValid);
        }

        /**
         * Define all roles for the app.
         */
        function initializeRoles() {
            RoleStore.defineRole('isEditableByUser', [], isEditableByUser);
        }

        /**
         * Check if user is anonymous.
         *
         * @returns {boolean}
         */
        function isAnonymous() {
            return !$auth.isAuthenticated();
        }

        /**
         * Check if user is authenticated.
         *
         * @returns {boolean}
         */
        function isAuthenticated() {
            return $auth.isAuthenticated();
        }

        /**
         * Verify token in server.
         *
         * @param stateParams
         * @returns {*}
         */
        function isTokenValid(stateParams) {
            var deferred = $q.defer();

            authService
                .verifyToken(stateParams.token)
                .then(function(res) {
                    if (res.status == 200) {
                        deferred.resolve();
                    } else {
                        deferred.reject();
                    }
                })
                .catch(function() {
                    deferred.reject(); // Error with request
                });

            return deferred.promise;
        }

        /**
         * Verify the authenticated user with the article
         * they are trying to edit. Only the owner can access
         * the edit page of a given article.
         *
         * @param stateParams
         * @returns {*}
         */
        function isEditableByUser(stateParams) {
            var deferred = $q.defer();

            articleService
                .verifyEdit(stateParams.articleSlug)
                .then(function(res) {
                    if (res.status == 200) {
                        deferred.resolve();
                    } else {
                        deferred.reject();
                    }
                })
                .catch(function() {
                    deferred.reject();
                });

            return deferred.promise;
        }
    }

})();
(function() { 'use strict';

    angular.module('directives', []);

})();
(function() { 'use strict';

    angular
        .module('directives')
        .directive('viewTitle', viewTitle);

    /**
     * @type {string[]}
     */
    viewTitle.$inject = ['$rootScope', '$timeout'];

    /**
     * @param $rootScope
     * @param $timeout
     * @returns {{restrict: string, link: link}}
     */
    function viewTitle($rootScope, $timeout) {
        var title,
            directive = {
                restrict: 'EA',
                link: link
            };

        return directive;

        function link(scope, elem) {
            var tagName = elem[0].tagName.toLowerCase();

            // If we've been inserted as an element then we detach from the DOM because the caller
            // doesn't want us to have any visual impact in the document.
            // Otherwise, we're piggy-backing on an existing element so we'll just leave it alone.
            if (tagName === 'view-title' || tagName === 'viewTitle')
                elem.remove();

            scope.$watch(function() {
                return elem.text();
            }, function (newTitle) {
                $rootScope.viewTitle = title = newTitle;
            });

            scope.$on('$destroy', function () {
                title = undefined;

                // Wait until next digest cycle do delete viewTitle
                $timeout(function() {
                    if (!title) {
                        // No other view-title has reassigned title.
                        delete $rootScope.viewTitle;
                    }
                });
            });
        }
    }

})();
(function() { 'use strict';

    angular.module('filters', []);

})();
(function() { 'use strict';

    angular.module('util', []);

})();
(function() { 'use strict';

    angular.module('services', []);

})();
(function () {'use strict';

    angular.module('ui.affix', []);

})();
(function () { 'use strict';

    angular.module('ui.alert', []);

})();
(function() { 'use strict';

    angular.module('ui.form-group-item', []);

})();
(function () { 'use strict';

    angular.module('ui.heading', []);

})();
(function() { 'use strict';

    angular.module('ui.focus', []);

})();
(function() { 'use strict';

    angular.module('ui.header-canopy', []);

})();
(function () { 'use strict';

    angular.module('ui.modal', []);

})();
(function() { 'use strict';

    angular.module('ui.message', []);

})();
(function() { 'use strict';

    angular.module('ui.profile-card', []);

})();
(function() { 'use strict';

    angular.module('ui.navbar', []);

})();
(function() { 'use strict';

    angular.module('ui.subview-menu', []);

})();
(function () { 'use strict';

    angular.module('ui.scroll-to-top-when', []);

})();
(function() { 'use strict';

    angular.module('ui.widget', []);

})();
(function () { 'use strict';

    angular.module('ui.toggle-active', []);

})();
(function() { 'use strict';

    angular.module('ui.when-scrolled', []);

})();
(function () { 'use strict';

    angular
        .module('auth')
        .factory('authService', authService);

    /**
     * @type {string[]}
     */
    authService.$inject = ['$http', '$auth', '$state', 'apiService', 'userService', 'config'];

    /**
     * @param $http
     * @param $auth
     * @param $state
     * @param apiService
     * @param userService
     * @param config
     * @returns {{signup: signup, login: login, logout: logout, sendResetLink: sendResetLink, resetPassword: resetPassword, verifyToken: verifyToken}}
     */
    function authService($http, $auth, $state, apiService, userService, config) {
        var service = {
            signup: signup,
            login: login,
            logout: logout,
            sendResetLink: sendResetLink,
            resetPassword: resetPassword,
            verifyToken: verifyToken
        };

        return service;

        function signup(credentials) {
            return $http.post(config.url + '/signup', credentials);
        }

        function login(credentials) {
            return $auth.login(credentials).then(function() {
                return $http.get(config.url + '/authenticate/user')
                    .then(apiService.handleSuccess, apiService.handleError);
            });
        }

        function logout() {
            return $http.post(config.url + '/logout').then(function () { // Invalidate token in server
                return $auth.logout().then(function () { // Remove token from local storage
                    userService.removeUser(); // Remove user from local storage
                    $state.go('app.home');
                });
            });
        }

        function sendResetLink(email) {
            return $http.post(config.url + '/reset', email)
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function resetPassword(token, credentials) {
            return $http.post(config.url + '/reset/' + token, credentials)
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function verifyToken(token) {
            return $http.get(config.url + '/reset/verify/' + token);
        }
    }

})();
(function() { 'use strict';

    angular
        .module('404')
        .controller('NotFoundController', NotFoundController);

    /**
     * @type {string[]}
     */
    NotFoundController.$inject = ['$stateParams', '$state'];

    /**
     * @param $stateParams
     * @param $state
     * @constructor
     */
    function NotFoundController($stateParams, $state) {
        var vm = this;
        vm.message = $stateParams.message;
        vm.search = search;
        vm.q = '';

        function search() {
            $state.go('app.search.results', {q: vm.q});
        }
    }

})();
(function() { 'use strict';

    angular
        .module('articles')
        .directive('articles', articles);

    /**
     * @returns {{restrict: string, scope: {}, templateUrl: string, link: link}}
     */
    function articles() {
        var directive = {
            restrict: 'AE',
            scope: {},
            templateUrl: 'app/articles/articles.html',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            // Set the first interval of stories loaded from resolver
            scope.articles = scope.$eval(attrs.data) || null;

            scope.$on('stories:loaded', function(event, stories) {
                for (var i = 0; i < stories.length; i++) {
                    scope.articles.push(stories[i]);
                }
            });
        }
    }

})();
(function() { 'use strict';

    angular
        .module('articles')
        .factory('articleService', articleService);

    /**
     * @type {string[]}
     */
    articleService.$inject = ['$rootScope', '$http', 'config', 'apiService'];

    /**
     * @param $rootScope
     * @param $http
     * @param config
     * @param apiService
     * @returns {{loadStories: loadStories, get: get, getTopStories: getTopStories, getAllForCategory: getAllForCategory, getUserDrafts: getUserDrafts, getUserPublished: getUserPublished, getUserUnpublished: getUserUnpublished, getPublic: getPublic, getDraft: getDraft, createPublic: createPublic, saveDraft: saveDraft, edit: edit, verifyEdit: verifyEdit, publish: publish, unpublish: unpublish, forceDelete: forceDelete, heart: heart, unheart: unheart}}
     */
    function articleService($rootScope, $http, config, apiService) {
        var loadStoriesUrl = '/articles?page=2',
            hasMoreStoriesToLoad = true,
            service = {
            loadStories: loadStories,
            get: get,
            getTopStories: getTopStories,
            getAllForCategory: getAllForCategory,
            getUserDrafts: getUserDrafts,
            getUserPublished: getUserPublished,
            getUserUnpublished: getUserUnpublished,
            getPublic: getPublic,
            getDraft: getDraft,
            createPublic: createPublic,
            saveDraft: saveDraft,
            edit: edit,
            verifyEdit: verifyEdit,
            publish: publish,
            unpublish: unpublish,
            forceDelete: forceDelete,
            heart: heart,
            unheart: unheart
        };

        return service;

        function loadStories() {
            if (hasMoreStoriesToLoad) {
                service
                    .get(loadStoriesUrl)
                    .then(function (res) {
                        if (res.hasOwnProperty('message')) {
                            hasMoreStoriesToLoad = false;
                        } else {
                            loadStoriesUrl = res.nextPageUrl;
                            $rootScope.$broadcast('stories:loaded', res.articles);
                        }
                    })
                    .catch(function (res) {
                        console.log('Error loading more stories: ', res);
                    });
            }
        }

        function get(url) {
            return $http.get(config.url + (url || '/articles'))
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function getTopStories() {
            return $http.get(config.url + '/top-stories')
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function getAllForCategory(slug) {
            return $http.get(config.url + '/category/' + slug)
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function getUserDrafts() {
            return $http.get(config.url + '/articles/draft')
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function getUserPublished() {
            return $http.get(config.url + '/articles/published')
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function getUserUnpublished() {
            return $http.get(config.url + '/articles/unpublished')
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function getPublic(slug) {
            return $http.get(config.url + '/articles/' + slug)
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function getDraft(slug) {
            return $http.get(config.url + '/articles/' + slug + '/draft')
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function createPublic(data) {
            return $http.post(config.url + '/articles/create/public', data)
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function saveDraft(data) {
            return $http.put(config.url + '/articles/save/draft', data)
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function edit(data, slug) {
            return $http.put(config.url + '/articles/' + slug + '/edit', data)
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function verifyEdit(slug) {
            return $http.post(config.url + '/articles/' + slug + '/edit/verify')
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function publish(slug) {
            return $http.put(config.url + '/articles/' + slug + '/publish')
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function unpublish(slug) {
            return $http.put(config.url + '/articles/' + slug + '/unpublish')
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function forceDelete(slug) {
            return $http.put(config.url + '/articles/' + slug + '/delete')
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function heart(id) {
            return $http.put(config.url + '/articles/heart/' + id, null, {ignoreLoadingBar: true});
        }

        function unheart(id) {
            return $http.put(config.url + '/articles/unheart/' + id, null, {ignoreLoadingBar: true});
        }
    }

})();
(function () { 'use strict';

    angular
        .module('category')
        .controller('CategoryContentController', CategoryContentController);

    /**
     * @type {string[]}
     */
    CategoryContentController.$inject = ['categoryResolver'];

    /**
     * @param categoryResolver
     * @constructor
     */
    function CategoryContentController(categoryResolver) {
        var vm = this;
        vm.articles = categoryResolver.articles;
    }

})();
(function () { 'use strict';

    angular
        .module('category')
        .controller('CategoryHeadController', CategoryHeadController);

    /**
     * @type {string[]}
     */
    CategoryHeadController.$inject = ['categoryResolver'];

    /**
     * @param categoryResolver
     * @constructor
     */
    function CategoryHeadController(categoryResolver) {
        var vm = this;
        vm.category = categoryResolver.category;
    }

})();
(function() { 'use strict';

    angular
        .module('category')
        .controller('CategoryHeaderController', CategoryHeaderController);

    /**
     * @type {string[]}
     */
    CategoryHeaderController.$inject = ['categoryResolver'];

    /**
     * @param categoryResolver
     * @constructor
     */
    function CategoryHeaderController(categoryResolver) {
        var vm = this;
        vm.category = categoryResolver.category;
    }

})();
(function() { 'use strict';

    angular
        .module('profile')
        .controller('ProfileContentController', ProfileContentController);

    /**
     * @type {string[]}
     */
    ProfileContentController.$inject = ['profileResolver'];

    /**
     * @param profileResolver
     * @constructor
     */
    function ProfileContentController(profileResolver) {
        var vm = this;
        vm.articles = profileResolver.articles;
        vm.user = profileResolver.user;
        vm.hasContent = vm.articles.length > 0;
    }

})();
(function () { 'use strict';

    angular
        .module('profile')
        .controller('ProfileHeadController', ProfileHeadController);

    /**
     * @type {string[]}
     */
    ProfileHeadController.$inject = ['profileResolver'];

    /**
     * @param profileResolver
     * @constructor
     */
    function ProfileHeadController(profileResolver) {
        var vm = this;
        vm.user = profileResolver.user;
    }

})();
(function () { 'use strict';

    angular
        .module('profile')
        .controller('ProfileHeaderController', ProfileHeaderController);

    /**
     * @type {string[]}
     */
    ProfileHeaderController.$inject = ['profileResolver'];

    /**
     * @param profileResolver
     * @constructor
     */
    function ProfileHeaderController(profileResolver) {
        var vm = this;
        vm.user = profileResolver.user;
    }

})();
(function() { 'use strict';

    angular
        .module('profile')
        .factory('profileService', profileService);

    /**
     * @type {string[]}
     */
    profileService.$inject = ['$http', 'apiService', 'config'];

    /**
     * @param $http
     * @param apiService
     * @param config
     * @returns {{getUser: getUser}}
     */
    function profileService($http, apiService, config) {
        var service = {
            getUser: getUser
        };

        return service;

        function getUser(username) {
            return $http.get(config.url + '/profile/user/' + username)
                .then(apiService.handleSuccess, apiService.handleError);
        }
    }

})();
(function() { 'use strict';

    angular
        .module('home')
        .controller('HomeContentController', HomeContentController);

    /**
     * @type {string[]}
     */
    HomeContentController.$inject = ['articlesResolver', 'articleService'];

    /**
     * @param articlesResolver
     * @param articleService
     * @constructor
     */
    function HomeContentController(articlesResolver, articleService) {
        var vm = this;
        vm.articles = articlesResolver.articles;
        vm.topArticles = [];
        vm.categories = [];
        vm.loadStories = articleService.loadStories;

        getTopStories();
        addFeaturedCategories();

        function getTopStories() {
            articleService
                .getTopStories()
                .then(function(res) {
                    vm.topArticles = res.articles;
                })
                .catch(function(res) {
                    console.log('Error fetching top stories: ', res);
                });
        }

        function addFeaturedCategories() {
            for (var i = 0; i < vm.articles.length; i++) {
                for (var j = 0; j < vm.articles[i].categories.length; j++) {
                    if (!alreadyExists(vm.articles[i].categories[j])) {
                        vm.categories.push(vm.articles[i].categories[j]);
                    }
                }
            }
        }

        function alreadyExists(val) {
            return vm.categories.some(function (arrVal) {
                return Object.is(JSON.stringify(val), JSON.stringify(arrVal));
            });
        }
    }

})();


(function() { 'use strict';

    angular
        .module('home')
        .controller('HomeHeaderController', HomeHeaderController);

    /**
     * @constructor
     */
    function HomeHeaderController() {
        var vm = this;
    }

})();
(function () { 'use strict';

    angular
        .module('search')
        .controller('SearchHeaderController', SearchHeaderController);

    /**
     * @type {string[]}
     */
    SearchHeaderController.$inject = ['$state'];

    /**
     * @param $state
     * @constructor
     */
    function SearchHeaderController($state) {
        var vm = this;
        vm.search = search;
        vm.q = '';

        function search() {
            $state.go('app.search.results', {
                q: vm.q
            });
        }
    }

})();
(function() { 'use strict';

    angular
        .module('search')
        .controller('SearchResultsController', SearchResultsController);

    /**
     * @type {string[]}
     */
    SearchResultsController.$inject = ['searchResolver'];

    /**
     * @param searchResolver
     * @constructor
     */
    function SearchResultsController(searchResolver) {
        var vm = this;
        vm.articles = searchResolver.articles;
        vm.categories = searchResolver.categories;
        vm.users = searchResolver.users;
        vm.results = (vm.articles.length > 0 || vm.categories.length > 0 || vm.users.length > 0);
    }

})();
(function() { 'use strict';

    angular
        .module('search')
        .factory('searchService', searchService);

    /**
     * @type {string[]}
     */
    searchService.$inject = ['$http', 'apiService', 'config'];

    /**
     * @param $http
     * @param apiService
     * @param config
     * @returns {{all: all, findCategories: findCategories}}
     */
    function searchService($http, apiService, config) {
        var service = {
            all: all,
            findCategories: findCategories
        };

        return service;

        function all(q) {
            return $http.get(config.url + '/search?q=' + q)
                .then(apiService.handleSuccess, apiService.handleError);
        }

        function findCategories(q) {
            return $http.get(config.url + '/search/categories?q=' + q)
                .then(apiService.handleSuccess, apiService.handleError);
        }
    }

})();
(function() { 'use strict';

    angular
        .module('auth')
        .controller('LoginController', LoginController);

    /**
     * @type {string[]}
     */
    LoginController.$inject = ['$rootScope', '$state', 'userService', 'authService'];

    /**
     * @param $rootScope
     * @param $state
     * @param userService
     * @param authService
     * @constructor
     */
    function LoginController($rootScope, $state, userService, authService) {
        var vm = this;
        vm.login = login;

        /**
         * Log in with given credentials.
         *
         * @param credentials {email, password}
         */
        function login(credentials) {
            authService
                .login(credentials)
                .then(success, error);
        }

        /**
         * User successfully logged in on server; set user and go
         * to home state.
         *
         * @param res
         */
        function success(res) {
            userService.setUser(res.user);
            $state.go('app.home');
        }

        /**
         * User not logged in on server. Either validation errors
         * occurred, or something went wrong.
         *
         * @param res
         */
        function error(res) {
            if (res.data && !res.data.error) {
                vm.errors = res.data;
                console.log(vm.errors);
            } else if (res.data.error) {
                $rootScope.$broadcast('input:error', {
                    message: res.data.error.message
                });
            }
        }
    }

})();
(function() { 'use strict';

    angular
        .module('auth')
        .controller('PasswordForgotController', PasswordForgotController);

    /**
     * @type {string[]}
     */
    PasswordForgotController.$inject = ['$rootScope', 'authService'];

    /**
     * @param $rootScope
     * @param authService
     * @constructor
     */
    function PasswordForgotController($rootScope, authService) {
        var vm = this;
        vm.sendResetLink = sendResetLink;

        /**
         * Send password reset link to users email.
         */
        function sendResetLink() {
            authService
                .sendResetLink({email: vm.email})
                .then(success, error);
        }

        /**
         * Password reset link successfully sent.
         *
         * @param res
         */
        function success(res) {
            vm.errors = [];

            $rootScope.$broadcast('input:success', {
                message: res.message
            });
        }

        /**
         * Error sending password reset link.
         *
         * @param res
         */
        function error(res) {
            if (res.data && !res.data.error) { // Validation errors
                vm.errors = res.data;
                console.log(vm.error);
            } else if (res.data.error) { // Can't find account with email
                $rootScope.$broadcast('input:error', {
                    message: res.data.error.message
                });
            }
        }
    }

})();
(function () { 'use strict';

    angular
        .module('auth')
        .controller('PasswordResetController', PasswordResetController);

    /**
     * @type {string[]}
     */
    PasswordResetController.$inject = ['$rootScope', '$stateParams', 'authService'];

    /**
     * @param $rootScope
     * @param $stateParams
     * @param authService
     * @constructor
     */
    function PasswordResetController($rootScope, $stateParams, authService) {
        var vm = this;
        vm.resetPassword = resetPassword;

        /**
         * Reset users password.
         */
        function resetPassword() {
            authService
                .resetPassword($stateParams.token, {
                    token: $stateParams.token,
                    password: vm.password,
                    passwordConfirmation: vm.passwordConfirmation
                })
                .then(success, error);
        }

        /**
         * Password was successfully reset.
         *
         * @param res
         */
        function success(res) {
            vm.errors = [];

            $rootScope.$broadcast('input:success', {
                message: res.message
            });
        }

        /**
         * Password could not be reset.
         *
         * @param res
         */
        function error(res) {
            if (res.data && !res.data.error) { // Validation errors
                vm.errors = res.data;
            } else if (res.data.password) { // Other validation errors
                vm.errors = res.data.password;
                console.log(vm.errors);
            } else if (res.data.error) { // Other server errors
                $rootScope.$broadcast('input:error', {
                    message: res.data.error.message
                });
            }
        }
    }

})();
(function() { 'use strict';

    angular
        .module('auth')
        .controller('SignupController', SignupController);

    /**
     * @type {string[]}
     */
    SignupController.$inject = ['$controller', 'authService'];

    /**
     * @param $controller
     * @param authService
     * @constructor
     */
    function SignupController($controller, authService) {
        var vm = this;
        vm.signup = signup;

        function signup() {
            authService
                .signup({
                    name: vm.name,
                    email: vm.email,
                    password: vm.password,
                    passwordConfirmation: vm.passwordConfirmation
                })
                .then(success, error);
        }

        /**
         * User successfully registered, now log in.
         */
        function success() {
            $controller('LoginController')
                .login({
                    email: vm.email,
                    password: vm.password
                });
        }

        /**
         * Error registering user.
         *
         * @param res
         */
        function error(res) {
            if (res.data && !res.data.error) { // Validation errors
                vm.errors = res.data;
                console.log(vm.errors);
            } else if (res.data.error) { // Other server error
                vm.errors = res.data.error.message;
                console.log(vm.errors);
            }
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui')
        .directive('hearts', hearts);

    /**
     * @type {string[]}
     */
    hearts.$inject = ['articleService'];

    /**
     * @param articleService
     * @returns {{restrict: string, scope: {}, templateUrl: string, link: link}}
     */
    function hearts(articleService) {
        var directive = {
            restrict: 'EA',
            scope: {},
            templateUrl: 'app/articles/hearts/hearts.html',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            var flag = false;
            var limit = 0;

            if (attrs.count) {
                scope.heartCount = attrs.count;
                scope.heart = heart;
            }

            function heart() {
                if (!flag && limit < 5)
                    articleService.heart(attrs.id).then(doHeart);
                else if (flag && limit < 5)
                    articleService.unheart(attrs.id).then(undoHeart);
            }

            function doHeart() {
                flag = true;
                scope.heartSuccess = true;
                scope.heartCount++;
                limit++;
            }

            function undoHeart() {
                flag = false;
                scope.heartSuccess = false;
                scope.heartCount--;
                limit++;
            }
        }
    }

})();
(function() { 'use strict';

    angular
        .module('articles')
        .directive('categories', categories);

    /**
     * @returns {{restrict: string, templateUrl: string, link: link}}
     */
    function categories() {
        var directive = {
            restrict: 'EA',
            templateUrl: 'app/articles/categories/categories.html',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            if (attrs.data) {
                var data = scope.$eval(attrs.data);

                scope.categories = data;
                scope.inverse = attrs.inverse || false;
            }
        }
    }

})();
(function () { 'use strict';

    angular
        .module('articles')
        .controller('ArticleController', ArticleController);

    /**
     * @type {string[]}
     */
    ArticleController.$inject = ['articleResolver'];

    /**
     * @param articleResolver
     * @constructor
     */
    function ArticleController(articleResolver) {
        var vm = this;
        vm.article = articleResolver.article;
        vm.author = articleResolver.author;
    }

})();
(function () { 'use strict';

    angular
        .module('articles')
        .controller('ArticleHeadController', ArticleHeadController);

    /**
     * @type {string[]}
     */
    ArticleHeadController.$inject = ['articleResolver'];

    /**
     * @param articleResolver
     * @constructor
     */
    function ArticleHeadController(articleResolver) {
        var vm = this;
        vm.article = articleResolver.article;
    }

})();
(function() { 'use strict';

    angular
        .module('articles')
        .directive('editor', editor);

    /**
     * @type {string[]}
     */
    editor.$inject = ['$rootScope'];

    /**
     * @param $rootScope
     * @returns {{require: string, restrict: string, link: link}}
     */
    function editor($rootScope) {
        var directive = {
            require: '?ngModel',
            restrict: 'A',
            link: link
        };

        return directive;

        function link(scope, elem, attrs, ngModel) {
            var ck = CKEDITOR.replace(elem[0], {
                language: 'en',
                extraPlugins: 'confighelper,autogrow',
                placeholder: 'Share your story...'
            });

            if (!ngModel) throw 'ng-model is missing!';

            ck.on('instanceReady', function() {
                ck.setData(ngModel.$viewValue);

                $rootScope.$broadcast('editor:ready');
            });

            ck.on('change', updateModel);
            ck.on('key', updateModel);
            ck.on('dataReady', updateModel);

            ngModel.$render = function(value) {
                ck.setData(ngModel.$viewValue);
            };

            function updateModel() {
                scope.$apply(function() {
                    ngModel.$setViewValue(ck.getData());
                });
            }
        }
    }

})();
(function () { 'use strict';

    angular
        .module('articles')
        .controller('WriteOrEditController', WriteOrEditController);

    /**
     * @type {string[]}
     */
    WriteOrEditController.$inject = ['$window', '$rootScope', '$scope', '$stateParams', '$state', '$timeout', 'writeOrEditResolver', 'articleService', 'searchService', 'modalService'];

    /**
     * @param $window
     * @param $rootScope
     * @param $scope
     * @param $stateParams
     * @param $state
     * @param $timeout
     * @param writeOrEditResolver
     * @param articleService
     * @param searchService
     * @param modalService
     * @constructor
     */
    function WriteOrEditController($window, $rootScope, $scope, $stateParams, $state, $timeout, writeOrEditResolver, articleService, searchService, modalService) {
        var vm = this,
            VM_DATA = { // Constant representing the initial untouched editor data (for comparison purposes)
                id: '',
                title: '',
                body: '',
                categoryIdList: []
            },
            EDIT_MODE = false,
            WRITE_MODE = false;
        vm.q = '';
        vm.categoriesSelected = []; // List of categories selected by user, or passed in from edit mode
        vm.categoriesFromSearch = []; // List of categories returned from server during search
        vm.data = {
            id: '',
            title: '',
            body: '',
            categoryIdList: [] // List of category ID's to send to server on submit
        };
        vm.submit = submit;
        vm.search = search;
        vm.addCategory = addCategory;
        vm.removeCategory = removeCategory;

        switch ($state.current.name) {
            case 'app.write':
                initializeWriteMode();
                break;
            case 'app.edit':
                initializeEditMode();
                break;
        }

        function initializeWriteMode() {
            WRITE_MODE = true;
        }

        function initializeEditMode() {
            EDIT_MODE = true;

            setViewModelData(writeOrEditResolver.article);
        }

        // Save if user closes browser/navigates away from app
        $window.onbeforeunload = function () {
            save();

            return null; // Prevents alert box in browser from showing
        };

        // Create a constant string value of the vm.data for comparison later.
        $scope.$on('editor:ready', function () {
            VM_DATA = JSON.stringify(vm.data);
        });

        // Watch state change and handle unsaved changes
        $scope.$on('$stateChangeStart', function (event, toState, toParams, fromState, fromParams) {
            var isEditorUnchanged = (VM_DATA === JSON.stringify(vm.data));

            // User has made updates to the data being edited,
            // or the empty editor is now dirty
            if (!isEditorUnchanged) {
                event.preventDefault();

                var modalOptions = {
                    actionButtonText: 'Save',
                    closeButtonText: "Don't save",
                    headerText: 'Save',
                    bodyText: "You've made some changes. Do you want to save?"
                };

                modalService
                    .showModal({}, modalOptions)
                    .then(function () {
                        save();

                        goToLeavingState();
                    })
                    .catch(goToLeavingState);
            }

            function goToLeavingState() {
                $state
                    .go(toState.name, toParams, {
                        notify: false
                    })
                    .then(function () {
                        $rootScope.$broadcast('$stateChangeSuccess', toState, toParams, fromState, fromParams);
                    });
            }
        });

        // Search for categories as the user types
        $scope.$watch('vm.q', function (newVal) {
            if (!newVal || newVal.length <= 1) return;

            $timeout(function () {
                // If search string is still the same, retrieve data.
                if (newVal === vm.q) vm.search();
            }, 1000);
        });

        function setViewModelData(data) {
            vm.data.id = data.id;
            vm.data.title = data.title;
            vm.data.body = data.body;

            if (data.categories) {
                for (var i = 0; i < data.categories.length; i++) {
                    addCategory(data.categories[i]);
                }
            }
        }

        function addCategory(category) {
            // Only add category id to categoryIdList array if not yet existing
            if (vm.data.categoryIdList.indexOf(category.id) === -1) {
                vm.data.categoryIdList.push(category.id);
            }

            // Only add category object to categoriesSelected array if not yet existing
            var categoryDoesNotExist = true;
            for (var i = 0; i < vm.categoriesSelected.length; i++) {
                if (vm.categoriesSelected[i].id === category.id) {
                    categoryDoesNotExist = false;
                    break;
                }
            }
            if (categoryDoesNotExist) {
                vm.categoriesSelected.push(category);
            }
        }

        function removeCategory(categoryId) {
            // Remove category id from categoryIdList array
            var listIndex = vm.data.categoryIdList.indexOf(categoryId);
            if (listIndex > -1) {
                vm.data.categoryIdList.splice(listIndex, 1);
            }

            // Remove category object from categoriesSelected array
            for (var i = 0; i < vm.categoriesSelected.length; i++) {
                if (vm.categoriesSelected[i].id === categoryId) {
                    vm.categoriesSelected.splice(i, 1);
                }
            }
        }

        function search() {
            searchService
                .findCategories(vm.q)
                .then(function (res) {
                    vm.categoriesFromSearch = res.categories;
                })
                .catch(function (res) {
                    console.log('Error searching for categories: ', res);
                });
        }

        function save() {
            // On write mode
            if (WRITE_MODE) {
                saveDraft();
            }
            // On edit mode
            else if (EDIT_MODE) {
                // Editing a draft
                if ($stateParams.draft === 'true') {
                    saveDraft();
                }
                // Editing a public story
                else if ($stateParams.draft === 'false') {
                    savePublic();
                }
            }
        }

        function saveDraft() {
            articleService
                .saveDraft(vm.data)
                .then(function(res) {
                    $rootScope.$broadcast('message', {
                        message: res.message
                    });
                })
                .catch(function (res) {
                    console.log("Error saving draft: ", res);
                });
        }

        function savePublic() {
            articleService
                .edit(vm.data, $stateParams.articleSlug)
                .then(function(res) {
                    $rootScope.$broadcast('message', {
                        message: res.message
                    });
                })
                .catch(function (res) {
                    console.log('Error editing article: ', res);
                });
        }

        function submit() {
            // Editor is not empty, continue publishing
            if (vm.data.title.length > 0 || vm.data.body.length > 0 || vm.data.categoryIdList.length > 0) {

                // On write mode OR on edit mode editing a draft
                if ($state.current.name === 'app.write' || $stateParams.draft === 'true') {
                    articleService
                        .createPublic(vm.data)
                        .then(function(res) {
                            goToArticle(res.article);
                        })
                        .catch(function (res) {
                            console.log('Error creating article: ', res);
                        });
                }
                // On edit mode (editing a published story)
                else if ($state.current.name === 'app.edit' && $stateParams.draft === 'false') {
                    articleService
                        .edit(vm.data, $stateParams.articleSlug)
                        .then(function(res) {
                            goToArticle(res.article);

                            $rootScope.$broadcast('message', {
                                message: res.message
                            });
                        })
                        .catch(function (res) {
                            console.log('Error editing article: ', res);
                        });
                }

            }
            // Editor is empty, do not publish, show errors
            else {
                vm.errors = {
                    title: true,
                    body: true
                };

                // Wait a second and then reset the errors
                //
                // This removes the 'shake' class from the div's so that when the form is
                // submitted again the class can be re-added and the elements will shake again.
                $timeout(function () {
                    vm.errors = {};
                }, 1000);
            }
        }

        function goToArticle(article) {
            $state
                .go('app.article', {
                    username: article.author.username,
                    articleSlug: article.slug
                }, {
                    notify: false // Notify false to ignore $stateChangeStart event that watches editor
                })
                .then(function() {
                    $rootScope.$broadcast('$stateChangeSuccess');
                });
        }
    }

})();
(function() { 'use strict';

    angular
        .module('articles')
        .directive('topStories', topStories);

    /**
     * @returns {{restrict: string, scope: {}, templateUrl: string, link: link}}
     */
    function topStories() {
        var directive = {
            restrict: 'A',
            scope: {},
            templateUrl: 'app/articles/top-stories/top-stories.html',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            if (attrs.data) {
                var data = scope.$eval(attrs.data);
                scope.articles = data;
            }
        }
    }

})();
(function() { 'use strict';

    angular
        .module('me')
        .factory('meStoriesService', meStoriesService);

    /**
     * @returns {{removeFromCollection: removeFromCollection}}
     */
    function meStoriesService() {
        var service = {
            removeFromCollection: removeFromCollection
        };

        return service;

        function removeFromCollection(collection, slug) {
            for (var i = 0; i < collection.length; i++) {
                if (collection[i].slug == slug) {
                    collection.splice(i, 1);
                }
            }

            return collection;
        }
    }

})();
(function() { 'use strict';

    angular
        .module('config')
        .constant('config', {
            url: 'http://' + window.location.hostname + '/api/v1',
            version: '1.0.0'
        })
        .config(config)
        .factory('configService', configService);

    /**
     * @type {string[]}
     */
    config.$inject = ['$provide', 'cfpLoadingBarProvider'];

    /**
     * @type {string[]}
     */
    configService.$inject = ['$rootScope', '$document'];

    /**
     * @param $provide
     * @param cfpLoadingBarProvider
     */
    function config($provide) {
        // Decorating '$state' with 'toState', 'toParams', 'fromState' and 'fromParams' for ease of use
        // throughout the app without where listening for stateChange events is not possible/ideal.
        $provide.decorator('$state', ["$delegate", "$rootScope", function($delegate, $rootScope) {
            $rootScope.$on('$stateChangeStart', function (event, toState, toParams, fromState, fromParams) {
                $delegate.toState = toState;
                $delegate.toParams = toParams;
                $delegate.fromState = fromState;
                $delegate.fromParams = fromParams;
            });

            return $delegate;
        }]);
    }

    /**
     * @param $rootScope
     * @param $document
     * @returns {{initialize: initialize, prepareDocument: prepareDocument}}
     */
    function configService($rootScope, $document) {
        var service = {
            initialize: initialize,
            prepareDocument: prepareDocument
        };

        return service;

        function initialize() {
            service.prepareDocument();
        }

        function prepareDocument() {
            // Scroll to top on new state
            $rootScope.$on("$stateChangeSuccess", function () {
                $document[0].body.scrollTop = $document[0].documentElement.scrollTop = 0;
            });
        }
    }

})();
(function() { 'use strict';

    angular
        .module('directives')
        .directive('viewHead', viewHead);

    /**
     * @type {string[]}
     */
    viewHead.$inject = ['$document'];

    /**
     * @param $document
     * @returns {{restrict: string, link: link}}
     */
    function viewHead($document) {
        var head = angular.element($document[0].head),
            directive = {
                restrict: 'A',
                link: link
            };

        return directive;

        function link(scope, elem) {
            // Move the element into the head of the document.
            // Although the physical location of the document changes, the element remains
            // bound to the scope in which it was declared, so it can refer to variables from
            // the view scope if necessary.
            head.append(elem);

            // When the scope is destroyed, remove the element.
            // This is on the assumption that we're being used in some sort of view scope.
            // It doesn't make sense to use this directive outside of the view, and nor does it
            // make sense to use it inside other scope-creating directives like ng-repeat.
            scope.$on('$destroy', function () {
                elem.remove();
            });
        }
    }

})();
(function() { 'use strict';

    angular
        .module('filters')
        .filter('escapeHtml', escapeHtml);

    /**
     * @returns {filter}
     */
    function escapeHtml() {
        var entityMap = {
            "&": "&amp;",
            "<": "&lt;",
            ">": "&gt;",
            '"': '&quot;',
            "'": '&#39;',
            "/": '&#x2F;'
        };

        return filter;

        function filter(html) {
            return String(html).replace(/[&<>"'\/]/g, function (s) {
                return entityMap[s];
            });
        }
    }

})();
(function() { 'use strict';

    angular
        .module('filters')
        .filter('shorten', shorten);

    function shorten() {
        return filter;

        function filter(value, wordwise, max, tail) {
            if (!value) return '';

            max = parseInt(max);

            if (!max || value.length <= max) return value;

            value = value.substr(0, max);

            if (wordwise) {
                var lastplace = value.lastIndexOf(' ');

                if (lastplace != -1)
                    value = value.substr(0, lastplace);
            }

            return value + (tail || '&hellip;');
        }
    }

})();
(function() { 'use strict';

    angular
        .module('util')
        .factory('util', util);

    /**
     * @returns {{}}
     */
    function util() {
        var service = {};

        return service;
    }

})();
(function() { 'use strict';

    angular
        .module('services')
        .factory('apiInterceptor', apiInterceptor);

    /**
     * @type {string[]}
     */
    apiInterceptor.$inject = ['$q', '$injector'];

    /**
     * @param $q
     * @param $injector
     * @returns {{request: request, requestError: requestError, response: response, responseError: responseError}}
     */
    function apiInterceptor($q, $injector) {
        var service = {
            request: request,
            requestError: requestError,
            response: response,
            responseError: responseError
        };

        return service;

        // Called before a request is sent, capable of mutating the request object
        function request(config) {
            return config;
        }

        function requestError(config) {
            return config;
        }

        // Called when an $http request succeeds, is passed the results object
        function response(res) {
            return res;
        }

        // Called if an $http method fails
        function responseError(res) {
            if (res.status == 404) {
                $injector.get('$state').go('app.404', {
                    message: res.data.error.message
                });
            }

            return $q.reject(res);
        }
    }

})();
(function () { 'use strict';

    angular
        .module('services')
        .factory('apiService', apiService);

    /**
     * @type {string[]}
     */
    apiService.$inject = ['$q'];

    /**
     * @param $q
     * @returns {{handleSuccess: handleSuccess, handleError: handleError}}
     */
    function apiService($q) {
        var service = {
            handleSuccess: handleSuccess,
            handleError: handleError
        };

        return service;

        function handleSuccess(res) {
            if (typeof res.data === 'object')
                return res.data;

            handleError(res);
        }

        function handleError(res) {
            return $q.reject(res);
        }
    }

})();
(function() { 'use strict';

    angular
        .module('services')
        .factory('redirectService', redirectService);

    /**
     * @type {string[]}
     */
    redirectService.$inject = ['$rootScope', '$state'];

    /**
     * @param $rootScope
     * @param $state
     * @returns {{goDefaultChildState: goDefaultChildState}}
     */
    function redirectService($rootScope, $state) {
        var service = {
            goDefaultChildState: goDefaultChildState
        };

        return service;

        // This is used for states that have sub-menus. Each sub-menu
        // should have it's own state, and a default child state is set
        // in the state to be redirected to using this function.
        function goDefaultChildState() {
            $rootScope.$on('$stateChangeStart', function(event, toState, toParams) {
                if (toState.default) {
                    event.preventDefault();

                    $state.go(toState.default, toParams);
                }
            });
        }
    }

})();
(function() { 'use strict';

    angular
        .module('services')
        .factory('userService', userService);

    /**
     * @type {string[]}
     */
    userService.$inject = ['$rootScope'];

    /**
     * @param $rootScope
     * @returns {{initialize: initialize, setUser: setUser, removeUser: removeUser}}
     */
    function userService($rootScope) {
        var service = {
            initialize: initialize,
            setUser: setUser,
            removeUser: removeUser
        };

        return service;

        /**
         * Checks the authenticated of user on initial page load.
         */
        function initialize() {
            var user = localStorage.getItem('user');

            if (user !== null)
                activateUserInRootScope(user, true);
            else
                disableUserInRootScope();

        }

        /**
         * Set and authenticate user.
         *
         * @param user
         */
        function setUser(user) {
            setUserInLocalStorage(user);
            activateUserInRootScope(user);
        }

        /**
         * Remove and de-authenticate user.
         */
        function removeUser() {
            removeUserFromLocalStorage();
            disableUserInRootScope();
        }

        /**
         * Set user in local storage.
         *
         * @param user
         */
        function setUserInLocalStorage(user) {
            localStorage.setItem('user', JSON.stringify(user));
        }

        /**
         * Remove user from local storage.
         */
        function removeUserFromLocalStorage() {
            localStorage.removeItem('user');
        }

        /**
         * Set and authenticate user in $rootScope.
         *
         * @param user
         * @param shouldParse (Optional; set to 'true' if user is string that needs
         *                     to be parsed to JSON. Usually needed if user is coming
         *                     from local storage.)
         */
        function activateUserInRootScope(user, shouldParse) {
            $rootScope.$broadcast('authenticated');

            if (shouldParse)
                $rootScope.currentUser = JSON.parse(user);
            else
                $rootScope.currentUser = user;

        }

        /**
         * Remove and de-authenticate user from $rootScope.
         */
        function disableUserInRootScope() {
            $rootScope.$broadcast('unauthenticated');
            $rootScope.currentUser = null;
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.affix')
        .directive('uiAffix', uiAffix);

    /**
     * @type {string[]}
     */
    uiAffix.$inject = ['$timeout'];

    /**
     * @returns {{restrict: string, link: link}}
     */
    function uiAffix($timeout) {
        var directive = {
            restrict: 'A',
            link: link
        };

        return directive;

        function link(scope, elem) {
            var navbar = angular.element(document.querySelector('#navbar')),
                header = angular.element(document.querySelector('#header')),
                searchHeader = angular.element(document.querySelector('#search-header')),
                topHeight;

            $timeout(function () {
                topHeight = navbar[0].offsetTop + header[0].offsetHeight || searchHeader[0].offsetHeight;

                elem.affix({
                    offset: {
                        top: topHeight
                    }
                });
            }, false);
        }
    }

})();
(function () { 'use strict';

    angular
        .module('ui.alert')
        .directive('uiAlert', uiAlert);

    /**
     * @returns {{restrict: string, templateUrl: string, link: link}}
     */
    function uiAlert() {
        var directive = {
            restrict: 'A',
            templateUrl: 'app/ui/alert/alert.html',
            link: link
        };

        return directive;

        function link(scope) {
            scope.$on('input:success', function(event, data) {
                scope.error = false;
                scope.success = true;
                scope.message = data.message;
            });

            scope.$on('input:error', function (event, data) {
                scope.success = false;
                scope.error = true;
                scope.message = data.message;
            });
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.form-group-item')
        .controller('FormGroupItemController', FormGroupItemController)
        .directive('uiFormGroupItem', uiFormGroupItem);

    /**
     * @constructor
     */
    function FormGroupItemController(){}

    /**
     * @returns {{restrict: string, scope: {model: string, errors: string, submit: string}, bindToController: boolean, controller: string, templateUrl: string, link: link}}
     */
    function uiFormGroupItem() {
        var directive = {
            restrict: 'A',
            scope: {
                model: '=',
                errors: '=',
                submit: '='
            },
            bindToController: true,
            controller: 'FormGroupItemController as vm',
            templateUrl: 'app/ui/form-group-item/form-group-item.html',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            scope.input = attrs.input || false;
            scope.textarea = attrs.textarea || false;
            scope.type = attrs.type || 'text';
            scope.label = attrs.label;
            scope.id = attrs.id;
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.heading')
        .directive('uiHeading', uiHeading);

    /**
     * @returns {{restrict: string, templateUrl: string, link: link}}
     */
    function uiHeading() {
        var directive = {
            restrict: 'EA',
            scope: {},
            templateUrl: 'app/ui/heading/heading.html',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            if (attrs.title) {
                scope.title = attrs.title;
                scope.bold = attrs.bold || false;
            }
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.focus')
        .directive('uiFocus', uiFocus);

    /**
     * @returns {{restrict: string, link: link}}
     */
    function uiFocus() {
        var directive = {
            restrict: 'A',
            link: link
        };

        return directive;

        function link(scope, elem) {
            elem.focus();
        }
    }

})();
(function () {
    'use strict';

    angular
        .module('ui.header-canopy')
        .directive('uiHeaderCanopyCategory', uiHeaderCanopyCategory);

    /**
     * @returns {{restrict: string, templateUrl: string, link: link}}
     */
    function uiHeaderCanopyCategory() {
        var directive = {
            restrict: 'EA',
            templateUrl: 'app/ui/header-canopy/header-canopy-category.html',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            if (attrs.title && attrs.description) {
                scope.title = attrs.title;
                scope.description = attrs.description;
            } else {
                console.log('Missing title or description attribute in header-canopy-category directive!');
            }
        }
    }

})();
(function () { 'use strict';

    angular
        .module('ui.header-canopy')
        .directive('uiHeaderCanopyHome', uiHeaderCanopyHome);

    /**
     * @param $rootScope
     * @returns {{restrict: string, link: link}}
     */
    function uiHeaderCanopyHome() {
        var directive = {
            restrict: 'A',
            link: link
        };

        return directive;

        function link(scope, elem) {
            scope.close = function() {
                elem.hide();
            };
        }
    }

})();
(function () {
    'use strict';

    angular
        .module('ui.header-canopy')
        .directive('uiHeaderCanopyPlain', uiHeaderCanopyPlain);

    /**
     * @returns {{restrict: string, templateUrl: string, link: link}}
     */
    function uiHeaderCanopyPlain() {
        var directive = {
            restrict: 'EA',
            templateUrl: 'app/ui/header-canopy/header-canopy-plain.html',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            if (attrs.title) {
                scope.title = attrs.title;
            } else {
                console.log('Missing title or description attribute in header-canopy-plain directive!');
            }
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.header-canopy')
        .directive('uiHeaderCanopyProfile', uiHeaderCanopyProfile);

    /**
     * @returns {{restrict: string, templateUrl: string, link: link}}
     */
    function uiHeaderCanopyProfile() {
        var directive = {
            restrict: 'EA',
            templateUrl: 'app/ui/header-canopy/header-canopy-profile.html',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            if (attrs.user) {
                var user = scope.$eval(attrs.user);

                scope.name = user.name;
                scope.bio = user.bio;
                scope.profileImage = user.profileImage;
            } else {
                console.log('Missing user attribute in header-canopy-profile directive!');
            }
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.modal')
        .factory('modalService', modalService);

    /**
     * @type {string[]}
     */
    modalService.$inject = ['$uibModal'];

    /**
     * @param $uibModal
     * @returns {{showModal: showModal, show: show}}
     */
    function modalService($uibModal) {
        var modalDefaults = {
            backdrop: true,
            keyboard: true,
            animation: false,
            templateUrl: 'app/ui/modal/modal.html'
        }, modalOptions = {
            closeButtonText: 'Cancel',
            actionButtonText: 'Continue',
            headerText: 'Are you sure?',
            bodyText: 'This action may be irreversible.'
        }, service = {
            showModal: showModal,
            show: show
        };

        return service;

        function showModal(customModalDefaults, customModalOptions) {
            if (!customModalDefaults) customModalDefaults = {};

            customModalDefaults.backdrop = 'static';

            return service.show(customModalDefaults, customModalOptions);
        }

        function show(customModalDefaults, customModalOptions) {
            // Create temp objects to work with since we're in a singleton service
            var tempModalDefaults = {};
            var tempModalOptions = {};

            // Map angular-ui modal custom defaults to modal defaults defined in service
            angular.extend(tempModalDefaults, modalDefaults, customModalDefaults);

            // Map modal.html $scope custom properties to defaults define in service
            angular.extend(tempModalOptions, modalOptions, customModalOptions);

            if (!tempModalDefaults.controller) {
                tempModalDefaults.controller = tempModalDefaultsCtrl;
            }

            tempModalDefaultsCtrl.$inject = ['$scope', '$uibModalInstance'];

            function tempModalDefaultsCtrl($scope, $uibModalInstance) {
                $scope.modalOptions = tempModalOptions;

                $scope.modalOptions.ok = function (res) {
                    $uibModalInstance.close(res);
                };

                $scope.modalOptions.close = function (res) {
                    $uibModalInstance.dismiss('cancel');
                };
            }

            return $uibModal.open(tempModalDefaults).result;
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.message')
        .directive('uiMessage', uiMessage);

    /**
     * @type {string[]}
     */
    uiMessage.$inject = ['$timeout'];

    /**
     * @param $timeout
     * @param $window
     * @returns {{restrict: string, templateUrl: string, replace: boolean, link: link}}
     */
    function uiMessage($timeout) {
        var directive = {
            restrict: 'A',
            templateUrl: 'app/ui/message/message.html',
            replace: true,
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            scope.$on('message', function (event, data) {
                scope.message = data.message;
                slideDown();

                $timeout(function () {
                    slideUp();
                }, 5000);
            });

            function slideDown() {
                elem.animate({
                    top: '0px'
                }, 100);
            }

            function slideUp() {
                elem.animate({
                    top: '-500px'
                }, 100);
            }
        }
    }

})();
(function () { 'use strict';

    angular
        .module('ui.profile-card')
        .directive('uiProfileCardSm', uiProfileCardSm);

    /**
     * @returns {{restrict: string, templateUrl: string, link: link}}
     */
    function uiProfileCardSm() {
        var directive = {
            restrict: 'EA',
            templateUrl: 'app/ui/profile-card/profile-card-sm.html',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            if (attrs.user) {
                var user = scope.$eval(attrs.user);
                var articleDate = attrs.articleDate;
                var viewCount = attrs.viewCount;

                scope.profileImage = user.profileImage;
                scope.username = user.username;
                scope.name = user.name;
                scope.bio = user.bio;
                scope.date = articleDate;
                scope.viewCount = viewCount;
                scope.hoverTemplate = '<div class="profile-card-hover">' +
                                            '<div class="profile-card-hover--content">' +
                                                '<a href="/@' + scope.username + '">' +
                                                    '<h1>' + scope.name + '</h1>' +
                                                '</a>' +
                                                '<p>' + scope.bio + '</p>' +
                                            '</div>' +
                                            '<div class="profile-card-hover--image">' +
                                                '<a href="/@' + scope.username + '" title="View the profile of ' + scope.name + '">' +
                                                    '<img class="avatar md" src="' + scope.profileImage + '">' +
                                                '</a>' +
                                            '</div>' +
                                            '<div class="clearfix"></div>' +
                                            '<div class="profile-card-hover--footer">' +
                                                '<a class="btn btn-primary text-center" href="/@' + scope.username + '">Visit profile</a>' +
                                            '</div>' +
                                        '</div>';
            }
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.profile-card')
        .directive('uiProfileCard', uiProfileCard);

    /**
     * @returns {{restrict: string, templateUrl: string, link: link}}
     */
    function uiProfileCard() {
        var directive = {
            restrict: 'EA',
            templateUrl: 'app/ui/profile-card/profile-card.html',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            if (attrs.user) {
                var user = scope.$eval(attrs.user);

                scope.profileImage = user.profileImage;
                scope.username = user.username;
                scope.name = user.name;
                scope.bio = user.bio;
            }
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.navbar', [])
        .directive('uiNavScroll', uiNavScroll);

    /**
     * @type {string[]}
     */
    uiNavScroll.$inject = ['$window', '$timeout'];

    /**
     * @param $window
     * @param $timeout
     * @returns {{restrict: string, link: link}}
     */
    function uiNavScroll($window, $timeout) {
        var directive =  {
            restrict: 'A',
            link: link
        };

        return directive;

        function link(scope, element) {
            var windowEl = angular.element($window);
            var delta = 50;
            var lastScrollTop = 0;

            element.bind('mouseover', mouseover);

            windowEl.on('scroll', scroll);

            function mouseover() {
                element.removeClass('closed');

                return $timeout((function () {
                    return element.css({
                        overflow: 'visible'
                    });
                }), 150);
            }

            function scroll() {
                var st = windowEl.scrollTop();

                // Check if at top of page
                if (st === 0)
                    element.removeClass('shadow');
                else
                    element.addClass('shadow');

                if (Math.abs(lastScrollTop - st) <= delta)
                    return;

                // Check if scrolling down
                if (st > lastScrollTop)
                    element.addClass('closed');
                else
                    element.removeClass('closed');


                lastScrollTop = st;
            }
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.navbar')
        .controller('NavbarController', NavbarController);

    /**
     * @type {string[]}
     */
    NavbarController.$inject = ['$state', '$scope'];

    /**
     * @param $state
     * @param $scope
     * @constructor
     */
    function NavbarController($state, $scope) {
        var vm = this;
        vm.writing = false;
        vm.search = search;
        vm.q = '';

        function search() {
            $state.go('app.search.results', {q: vm.q});
        }

        $scope.$watch(function() {
            return $state.current.name;
        }, function() {
            vm.writing = $state.current.name == 'app.write' || $state.current.name == 'app.edit';

            if ($state.current.name === 'app.home') {
                vm.addBoxedLayout = true;
            } else {
                vm.addBoxedLayout = false;
            }
        });
    }

})();
(function() { 'use strict';

    angular
        .module('ui.navbar')
        .directive('uiNavbar', uiNavbar);

    /**
     * @returns {{restrict: string, templateUrl: string, controller: string}}
     */
    function uiNavbar() {
        var directive = {
            restrict: 'EA',
            templateUrl: 'app/ui/navbar/navbar.html',
            controller: 'NavbarController as vm'
        };

        return directive;
    }

})();
(function() { 'use strict';

    angular
        .module('ui.subview-menu')
        .controller('SubviewMenuController', SubviewMenuController);

    /**
     * @type {string[]}
     */
    SubviewMenuController.$inject = ['subviewMenuService', '$scope', '$stateParams', '$state'];

    /**
     * @param subviewMenuService
     * @param $scope
     * @param $stateParams
     * @param $state
     * @constructor
     */
    function SubviewMenuController(subviewMenuService, $scope, $stateParams, $state) {
        var vm = this;
        vm.menu = [];
        vm.go = go;

        // Watch the change of the parent state of the subviews  to
        // select the proper menu based on the $stateParams.menu value.
        $scope.$watch(function() {
            return $stateParams.menu;
        }, function() {
            vm.menu = subviewMenuService.getMenu($stateParams.menu);
        });

        // Watch the change of the subview state and highlight the tab
        // that has the state value of the current subview state.
        $scope.$watch(function() {
            return $state.current.name;
        }, function() {
            highlightSelectedTab();
        });

        function highlightSelectedTab() {
            for (var i = 0; i < vm.menu.length; i++) {
                if (vm.menu[i].state == $state.current.name)
                    vm.menu[i].selected = true;
                else
                    vm.menu[i].selected = false;
            }
        }

        function go(tab) {
            $state.go(tab.state);
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.subview-menu')
        .directive('uiSubviewMenu', uiSubviewMenu);

    /**
     * @returns {{restrict: string, templateUrl: string, controller: string}}
     */
    function uiSubviewMenu() {
        var directive =  {
            restrict: 'EA',
            templateUrl: 'app/ui/subview-menu/subview-menu.html',
            controller: 'SubviewMenuController as vm'
        };

        return directive;
    }

})();
(function () { 'use strict';

    angular
        .module('ui.subview-menu')
        .factory('subviewMenuService', subviewMenuService);

    /**
     * @returns {{getMenu: getMenu}}
     */
    function subviewMenuService() {
        var allMenus = {
                'settings': [
                    {'state': 'app.me.settings.account', 'label': 'Account', selected: false},
                    {'state': 'app.me.settings.password', 'label': 'Password', selected: false}
                ],
                'stories': [
                    {'state': 'app.me.stories.drafts', 'label': 'Drafts', selected: false},
                    {'state': 'app.me.stories.published', 'label': 'Published', selected: false},
                    {'state': 'app.me.stories.unpublished', 'label': 'Unpublished', selected: false}
                ]
            },
            service = {
                getMenu: getMenu
            };

        return service;

        function getMenu(currentMenu) {
            return allMenus[currentMenu];
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.scroll-to-top-when')
        .directive('uiScrollToTopWhen', uiScrollToTopWhen);

    /**
     * @type {string[]}
     */
    uiScrollToTopWhen.$inject = ['$timeout'];

    /**
     * @param $timeout
     * @returns {{restrict: string, link: link}}
     */
    function uiScrollToTopWhen($timeout) {
        var directive = {
            restrict: 'A',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            scope.$on(attrs.scrollToTopWhen, function() {
                $timeout(function () {
                    angular.element(elem)[0].scrollTop = 0;
                });
            });
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.widget')
        .controller('WidgetFooterController', WidgetFooterController);

    /**
     * @constructor
     */
    function WidgetFooterController() {}

})();
(function() { 'use strict';

    angular
        .module('ui.widget')
        .directive('uiWidgetFooter', uiWidgetFooter);

    /**
     * @returns {{restrict: string, scope: {submit: string}, bindToController: boolean, controller: string, templateUrl: string, link: link}}
     */
    function uiWidgetFooter() {
        var directive = {
            restrict: 'A',
            scope: {
                submit: '='
            },
            bindToController: true,
            controller: 'WidgetFooterController as vm',
            templateUrl: 'app/ui/widget/widget-footer.html',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            scope.text = attrs.text || null;
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.widget')
        .directive('uiWidgetHeader', uiWidgetHeader);

    /**
     * @returns {{restrict: string, templateUrl: string, link: link}}
     */
    function uiWidgetHeader() {
        var directive = {
            restrict: 'A',
            templateUrl: 'app/ui/widget/widget-header.html',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            scope.title = attrs.title || null;
            scope.description = attrs.description || null;
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.toggle-active')
        .directive('uiToggleActive', uiToggleActive);

    /**
     * @returns {{restrict: string, link: link}}
     */
    function uiToggleActive() {
        var directive = {
            restrict: 'A',
            link: link
        };

        return directive;

        function link(scope, elem) {
            elem.bind('click', function() {
                elem.toggleClass('active');
            });
        }
    }

})();
(function() { 'use strict';

    angular
        .module('ui.when-scrolled')
        .directive('uiWhenScrolled', uiWhenScrolled);

    uiWhenScrolled.$inject = ['$window', '$document'];

    /**
     * @returns {{restrict: string, link: link}}
     */
    function uiWhenScrolled($window, $document) {
        var directive = {
            restrict: 'A',
            link: link
        };

        return directive;

        function link(scope, elem, attrs) {
            var windowEl = angular.element($window),
                canLoadOnScroll = true;

            windowEl.on('scroll', function() {
                if (canLoadOnScroll) {
                    if ((windowEl.scrollTop() + windowEl.height()) >= ($document.height() / 2)) {
                        canLoadOnScroll = false;
                        scope.$apply(attrs.uiWhenScrolled);
                    }
                }
            });

            scope.$on('stories:loaded', function() {
                canLoadOnScroll = true;
            });
        }
    }

})();
(function () { 'use strict';

    angular
        .module('stories')
        .controller('DraftsController', DraftsController);

    /**
     * @type {string[]}
     */
    DraftsController.$inject = ['draftsResolver', 'meStoriesService', 'articleService', 'modalService', '$rootScope'];

    /**
     * @param draftsResolver
     * @param meStoriesService
     * @param articleService
     * @param modalService
     * @param $rootScope
     * @constructor
     */
    function DraftsController(draftsResolver, meStoriesService, articleService, modalService, $rootScope) {
        var vm = this;
        vm.drafts = draftsResolver.drafts;
        vm.message = draftsResolver.message || "You have no drafts.";
        vm.forceDelete = forceDelete;

        function forceDelete(slug) {
            var modalOptions = {
                actionButtonText: 'Delete',
                headerText: 'Delete',
                bodyText: 'Deleted drafts are gone forever. Are you sure?'
            };

            modalService
                .showModal({}, modalOptions)
                .then(function () {
                    articleService
                        .forceDelete(slug)
                        .then(function(res) {
                            meStoriesService.removeFromCollection(vm.drafts, slug);

                            $rootScope.$broadcast('message', {
                                message: res.message
                            });
                        })
                        .catch(function(res) {
                            console.log(res);
                        });
                });
        }
    }

})();
(function () { 'use strict';

    angular
        .module('stories')
        .controller('PublishedController', PublishedController);

    /**
     * @type {string[]}
     */
    PublishedController.$inject = ['publishedResolver', 'meStoriesService', 'articleService', 'modalService', '$rootScope'];

    /**
     * @param publishedResolver
     * @param meStoriesService
     * @param articleService
     * @param modalService
     * @param $rootScope
     * @constructor
     */
    function PublishedController(publishedResolver, meStoriesService, articleService, modalService, $rootScope) {
        var vm = this;
        vm.articles = publishedResolver.articles;
        vm.message = publishedResolver.message || "You haven't published any stories yet.";
        vm.unpublish = unpublish;

        function unpublish(slug) {
            vm.articleSlug = slug;

            var modalOptions = {
                actionButtonText: 'Unpublish',
                headerText: 'Unpublish',
                bodyText: 'Unpublished stories are hidden from the public.'
            };

            modalService
                .showModal({}, modalOptions)
                .then(function() {
                    articleService
                        .unpublish(slug)
                        .then(function(res) {
                            meStoriesService.removeFromCollection(vm.articles, slug);

                            $rootScope.$broadcast('message', {
                                message: res.message
                            });
                        })
                        .catch(function(res) {
                            console.log(res);
                        });
                });
        }
    }

})();
(function () {
    'use strict';

    angular
        .module('stories')
        .controller('UnpublishedController', UnpublishedController);

    /**
     * @type {string[]}
     */
    UnpublishedController.$inject = ['unpublishedResolver', 'meStoriesService', 'articleService', 'modalService', '$rootScope'];

    /**
     * @param unpublishedResolver
     * @param meStoriesService
     * @param articleService
     * @param modalService
     * @param $rootScope
     * @constructor
     */
    function UnpublishedController(unpublishedResolver, meStoriesService, articleService, modalService, $rootScope) {
        var vm = this;
        vm.articles = unpublishedResolver.articles;
        vm.message = unpublishedResolver.message || "You don't have any unpublished stories.";
        vm.publish = publish;
        vm.forceDelete = forceDelete;

        function publish(slug) {
            var modalOptions = {
                actionButtonText: 'Publish',
                headerText: 'Publish',
                bodyText: 'Published stories are viewable by the public.'
            };

            modalService
                .showModal({}, modalOptions)
                .then(function () {
                    articleService
                        .publish(slug)
                        .then(function(res) {
                            meStoriesService.removeFromCollection(vm.articles, slug);

                            $rootScope.$broadcast('message', {
                                message: res.message
                            });
                        })
                        .catch(function(res) {
                            console.log(res);
                        });
                });
        }

        function forceDelete(slug) {
            var modalOptions = {
                actionButtonText: 'Delete',
                headerText: 'Delete',
                bodyText: 'Deleted stories are gone forever. Are you sure?'
            };

            modalService
                .showModal({}, modalOptions)
                .then(function () {
                    articleService
                        .forceDelete(slug)
                        .then(function(res) {
                            meStoriesService.removeFromCollection(vm.articles, slug);

                            $rootScope.$broadcast('message', {
                                message: res.message
                            });
                        })
                        .catch(function(res) {
                            console.log(res);
                        });
                });
        }
    }

})();
(function () { 'use strict';

    angular
        .module('settings')
        .controller('SettingsPasswordController', SettingsPasswordController);

    /**
     * @type {string[]}
     */
    SettingsPasswordController.$inject = ['$rootScope', 'settingsPasswordService'];

    /**
     * @param $rootScope
     * @param settingsPasswordService
     * @constructor
     */
    function SettingsPasswordController($rootScope, settingsPasswordService) {
        var vm = this;
        vm.submit = submit;

        function submit() {
            settingsPasswordService.changePassword({
                username: $rootScope.currentUser.username,
                email: $rootScope.currentUser.email,
                password: vm.password,
                newPassword: vm.newPassword,
                newPasswordConfirmation: vm.newPasswordConfirmation
            }).then(success, error);
        }

        /**
         * Successfully updated password.
         *
         * @param res
         */
        function success(res) {
            vm.errors = [];

            $rootScope.$broadcast('input:success', {
                message: res.message
            });
        }

        /**
         * Error updating password.
         *
         * @param res
         */
        function error(res) {
            if (res.data && !res.data.error) { // Validation errors
                vm.errors = res.data;
                console.log(vm.errors);
            } else if (res.data.error) { // Incorrect password
                $rootScope.$broadcast('input:error', {
                    message: res.data.error.message
                });
            }
        }
    }

})();
(function () { 'use strict';

    angular
        .module('settings')
        .factory('settingsPasswordService', settingsPasswordService);

    /**
     * @type {string[]}
     */
    settingsPasswordService.$inject = ['$http', 'config', 'apiService'];

    /**
     * @param $http
     * @param config
     * @param apiService
     * @returns {{changePassword: changePassword}}
     */
    function settingsPasswordService($http, config, apiService) {
        var service = {
            changePassword: changePassword
        };

        return service;

        function changePassword(credentials) {
            return $http.put(config.url + '/settings/password', credentials)
                .then(apiService.handleSuccess, apiService.handleError);
        }
    }

})();
(function () { 'use strict';

    angular
        .module('settings')
        .controller('SettingsAccountController', SettingsAccountController);

    /**
     * @type {string[]}
     */
    SettingsAccountController.$inject = ['$rootScope', 'settingsAccountService', 'userService'];

    /**
     * @param $rootScope
     * @param settingsAccountService
     * @param userService
     * @constructor
     */
    function SettingsAccountController($rootScope, settingsAccountService, userService) {
        var vm = this;
        vm.updateUsername = updateUsername;
        vm.updateBio = updateBio;
        vm.username = $rootScope.currentUser.username;
        vm.bio = $rootScope.currentUser.bio;

        /**
         * Change users username.
         */
        function updateUsername() {
            settingsAccountService
                .updateUsername({username: vm.username})
                .then(success, error);
        }

        /**
         * Change users bio.
         */
        function updateBio() {
            settingsAccountService
                .updateBio({bio: vm.bio})
                .then(success, error);
        }

        /**
         * Successfully updated data.
         *
         * @param res
         */
        function success(res) {
            vm.errors = [];

            $rootScope.$broadcast('input:success', {
                message: res.message
            });

            userService.setUser(res.user);
        }

        /**
         * Error updating data.
         *
         * @param res
         */
        function error(res) {
            if (res.data && !res.data.error) { // Validation errors
                vm.errors = res.data;
            } else if (res.data.error) {
                $rootScope.$broadcast('input:error', {
                    message: res.data.error.message
                });
            }
        }
    }

})();
(function() { 'use strict';

    angular
        .module('settings')
        .factory('settingsAccountService', settingsAccountService);

    /**
     * @type {string[]}
     */
    settingsAccountService.$inject = ['$http', 'apiService', 'config'];

    /**
     * @param $http
     * @param apiService
     * @param config
     * @returns {{updateUsername: updateUsername, updateBio: updateBio}}
     */
    function settingsAccountService($http, apiService, config) {
        var service = {
            updateUsername: updateUsername,
            updateBio: updateBio
        };

        return service;

        /**
         * Update users username.
         *
         * @param data
         * @returns {*}
         */
        function updateUsername(data) {
            return $http.put(config.url + '/settings/account/username', data)
                .then(apiService.handleSuccess, apiService.handleError);
        }

        /**
         * Update users bio.
         *
         * @param data
         * @returns {*}
         */
        function updateBio(data) {
            return $http.put(config.url + '/settings/account/bio', data)
                .then(apiService.handleSuccess, apiService.handleError);
        }
    }

})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJhdXRoL2F1dGgubW9kdWxlLmpzIiwiNDA0LzQwNC5tb2R1bGUuanMiLCJhcnRpY2xlcy9hcnRpY2xlcy5tb2R1bGUuanMiLCJjYXRlZ29yeS9jYXRlZ29yeS5tb2R1bGUuanMiLCJwcm9maWxlL3Byb2ZpbGUubW9kdWxlLmpzIiwibWUvbWUubW9kdWxlLmpzIiwiaG9tZS9ob21lLm1vZHVsZS5qcyIsInNlYXJjaC9zZWFyY2gubW9kdWxlLmpzIiwidWkvdWkubW9kdWxlLmpzIiwibWUvc3Rvcmllcy9zdG9yaWVzLm1vZHVsZS5qcyIsIm1lL3NldHRpbmdzL3NldHRpbmdzLm1vZHVsZS5qcyIsInNoYXJlZC9jb25maWcvY29uZmlnLm1vZHVsZS5qcyIsInNoYXJlZC9hY2Nlc3MtY29udHJvbC9hY2Nlc3MtY29udHJvbC5tb2R1bGUuanMiLCJzaGFyZWQvZGlyZWN0aXZlcy9kaXJlY3RpdmVzLm1vZHVsZS5qcyIsInNoYXJlZC9kaXJlY3RpdmVzL3ZpZXctdGl0bGUubW9kdWxlLmpzIiwic2hhcmVkL2ZpbHRlcnMvZmlsdGVycy5tb2R1bGUuanMiLCJzaGFyZWQvdXRpbC91dGlsLm1vZHVsZS5qcyIsInNoYXJlZC9zZXJ2aWNlcy9zZXJ2aWNlcy5tb2R1bGUuanMiLCJ1aS9hZmZpeC9hZmZpeC5tb2R1bGUuanMiLCJ1aS9hbGVydC9hbGVydC5tb2R1bGUuanMiLCJ1aS9mb3JtLWdyb3VwLWl0ZW0vZm9ybS1ncm91cC1pdGVtLm1vZHVsZS5qcyIsInVpL2hlYWRpbmcvaGVhZGluZy5tb2R1bGUuanMiLCJ1aS9mb2N1cy9mb2N1cy5tb2R1bGUuanMiLCJ1aS9oZWFkZXItY2Fub3B5L2hlYWRlci1jYW5vcHkubW9kdWxlLmpzIiwidWkvbW9kYWwvbW9kYWwubW9kdWxlLmpzIiwidWkvbWVzc2FnZS9tZXNzYWdlLm1vZHVsZS5qcyIsInVpL3Byb2ZpbGUtY2FyZC9wcm9maWxlLWNhcmQubW9kdWxlLmpzIiwidWkvbmF2YmFyL25hdmJhci5tb2R1bGUuanMiLCJ1aS9zdWJ2aWV3LW1lbnUvc3Vidmlldy1tZW51Lm1vZHVsZS5qcyIsInVpL3Njcm9sbC10by10b3Atd2hlbi9zY3JvbGwtdG8tdG9wLXdoZW4ubW9kdWxlLmpzIiwidWkvd2lkZ2V0L3dpZGdldC5tb2R1bGUuanMiLCJ1aS90b2dnbGUtYWN0aXZlL3RvZ2dsZS1hY3RpdmUubW9kdWxlLmpzIiwidWkvd2hlbi1zY3JvbGxlZC93aGVuLXNjcm9sbGVkLm1vZHVsZS5qcyIsImF1dGgvYXV0aC5zZXJ2aWNlLmpzIiwiNDA0L25vdC1mb3VuZC5jb250cm9sbGVyLmpzIiwiYXJ0aWNsZXMvYXJ0aWNsZXMuZGlyZWN0aXZlLmpzIiwiYXJ0aWNsZXMvYXJ0aWNsZXMuc2VydmljZS5qcyIsImNhdGVnb3J5L2NvbnRlbnQuY29udHJvbGxlci5qcyIsImNhdGVnb3J5L2hlYWQuY29udHJvbGxlci5qcyIsImNhdGVnb3J5L2hlYWRlci5jb250cm9sbGVyLmpzIiwicHJvZmlsZS9jb250ZW50LmNvbnRyb2xsZXIuanMiLCJwcm9maWxlL2hlYWQuY29udHJvbGxlci5qcyIsInByb2ZpbGUvaGVhZGVyLmNvbnRyb2xsZXIuanMiLCJwcm9maWxlL3Byb2ZpbGUuc2VydmljZS5qcyIsImhvbWUvY29udGVudC5jb250cm9sbGVyLmpzIiwiaG9tZS9oZWFkZXIuY29udHJvbGxlci5qcyIsInNlYXJjaC9oZWFkZXIuY29udHJvbGxlci5qcyIsInNlYXJjaC9yZXN1bHRzLmNvbnRyb2xsZXIuanMiLCJzZWFyY2gvc2VhcmNoLnNlcnZpY2UuanMiLCJhdXRoL2xvZ2luL2xvZ2luLmNvbnRyb2xsZXIuanMiLCJhdXRoL3Bhc3N3b3JkLWZvcmdvdC9wYXNzd29yZC1mb3Jnb3QuY29udHJvbGxlci5qcyIsImF1dGgvcGFzc3dvcmQtcmVzZXQvcGFzc3dvcmQtcmVzZXQuY29udHJvbGxlci5qcyIsImF1dGgvc2lnbnVwL3NpZ251cC5jb250cm9sbGVyLmpzIiwiYXJ0aWNsZXMvaGVhcnRzL2hlYXJ0cy5kaXJlY3RpdmUuanMiLCJhcnRpY2xlcy9jYXRlZ29yaWVzL2NhdGVnb3JpZXMuZGlyZWN0aXZlLmpzIiwiYXJ0aWNsZXMvYXJ0aWNsZS9hcnRpY2xlLmNvbnRyb2xsZXIuanMiLCJhcnRpY2xlcy9hcnRpY2xlL2hlYWQuY29udHJvbGxlci5qcyIsImFydGljbGVzL3dyaXRlLW9yLWVkaXQvZWRpdG9yLmRpcmVjdGl2ZS5qcyIsImFydGljbGVzL3dyaXRlLW9yLWVkaXQvd3JpdGUtb3ItZWRpdC5jb250cm9sbGVyLmpzIiwiYXJ0aWNsZXMvdG9wLXN0b3JpZXMvdG9wLXN0b3JpZXMuZGlyZWN0aXZlLmpzIiwibWUvc3Rvcmllcy9zdG9yaWVzLnNlcnZpY2UuanMiLCJzaGFyZWQvY29uZmlnL2NvbmZpZy5qcyIsInNoYXJlZC9kaXJlY3RpdmVzL3ZpZXctaGVhZC5kaXJlY3RpdmUuanMiLCJzaGFyZWQvZmlsdGVycy9lc2NhcGUtaHRtbC5maWx0ZXIuanMiLCJzaGFyZWQvZmlsdGVycy9zaG9ydGVuLmZpbHRlci5qcyIsInNoYXJlZC91dGlsL3V0aWwuanMiLCJzaGFyZWQvc2VydmljZXMvYXBpLWludGVyY2VwdG9yLnNlcnZpY2UuanMiLCJzaGFyZWQvc2VydmljZXMvYXBpLnNlcnZpY2UuanMiLCJzaGFyZWQvc2VydmljZXMvcmVkaXJlY3Quc2VydmljZS5qcyIsInNoYXJlZC9zZXJ2aWNlcy91c2VyLnNlcnZpY2UuanMiLCJ1aS9hZmZpeC9hZmZpeC5kaXJlY3RpdmUuanMiLCJ1aS9hbGVydC9hbGVydC5kaXJlY3RpdmUuanMiLCJ1aS9mb3JtLWdyb3VwLWl0ZW0vZm9ybS1ncm91cC1pdGVtLmRpcmVjdGl2ZS5qcyIsInVpL2hlYWRpbmcvaGVhZGluZy5kaXJlY3RpdmUuanMiLCJ1aS9mb2N1cy9mb2N1cy5kaXJlY3RpdmUuanMiLCJ1aS9oZWFkZXItY2Fub3B5L2hlYWRlci1jYW5vcHktY2F0ZWdvcnkuZGlyZWN0aXZlLmpzIiwidWkvaGVhZGVyLWNhbm9weS9oZWFkZXItY2Fub3B5LWhvbWUuZGlyZWN0aXZlLmpzIiwidWkvaGVhZGVyLWNhbm9weS9oZWFkZXItY2Fub3B5LXBsYWluLmRpcmVjdGl2ZS5qcyIsInVpL2hlYWRlci1jYW5vcHkvaGVhZGVyLWNhbm9weS1wcm9maWxlLmRpcmVjdGl2ZS5qcyIsInVpL21vZGFsL21vZGFsLnNlcnZpY2UuanMiLCJ1aS9tZXNzYWdlL21lc3NhZ2UuZGlyZWN0aXZlLmpzIiwidWkvcHJvZmlsZS1jYXJkL3Byb2ZpbGUtY2FyZC1zbS5kaXJlY3RpdmUuanMiLCJ1aS9wcm9maWxlLWNhcmQvcHJvZmlsZS1jYXJkLmRpcmVjdGl2ZS5qcyIsInVpL25hdmJhci9uYXYtc2Nyb2xsLmRpcmVjdGl2ZS5qcyIsInVpL25hdmJhci9uYXZiYXIuY29udHJvbGxlci5qcyIsInVpL25hdmJhci9uYXZiYXIuZGlyZWN0aXZlLmpzIiwidWkvc3Vidmlldy1tZW51L3N1YnZpZXctbWVudS5jb250cm9sbGVyLmpzIiwidWkvc3Vidmlldy1tZW51L3N1YnZpZXctbWVudS5kaXJlY3RpdmUuanMiLCJ1aS9zdWJ2aWV3LW1lbnUvc3Vidmlldy1tZW51LnNlcnZpY2UuanMiLCJ1aS9zY3JvbGwtdG8tdG9wLXdoZW4vc2Nyb2xsLXRvLXRvcC13aGVuLmRpcmVjdGl2ZS5qcyIsInVpL3dpZGdldC93aWRnZXQtZm9vdGVyLmNvbnRyb2xsZXIuanMiLCJ1aS93aWRnZXQvd2lkZ2V0LWZvb3Rlci5kaXJlY3RpdmUuanMiLCJ1aS93aWRnZXQvd2lkZ2V0LWhlYWRlci5kaXJlY3RpdmUuanMiLCJ1aS90b2dnbGUtYWN0aXZlL3RvZ2dsZS1hY3RpdmUuZGlyZWN0aXZlLmpzIiwidWkvd2hlbi1zY3JvbGxlZC93aGVuLXNjcm9sbGVkLmRpcmVjdGl2ZS5qcyIsIm1lL3N0b3JpZXMvZHJhZnRzL2RyYWZ0cy5jb250cm9sbGVyLmpzIiwibWUvc3Rvcmllcy9wdWJsaXNoZWQvcHVibGlzaGVkLmNvbnRyb2xsZXIuanMiLCJtZS9zdG9yaWVzL3VucHVibGlzaGVkL3VucHVibGlzaGVkLmNvbnRyb2xsZXIuanMiLCJtZS9zZXR0aW5ncy9wYXNzd29yZC9wYXNzd29yZC5jb250cm9sbGVyLmpzIiwibWUvc2V0dGluZ3MvcGFzc3dvcmQvcGFzc3dvcmQuc2VydmljZS5qcyIsIm1lL3NldHRpbmdzL2FjY291bnQvYWNjb3VudC5jb250cm9sbGVyLmpzIiwibWUvc2V0dGluZ3MvYWNjb3VudC9hY2NvdW50LnNlcnZpY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsQ0FBQSxZQUFBLEVBQUE7O0lBRUE7U0FDQSxPQUFBLE9BQUE7Ozs7Ozs7Ozs7OztnQkFZQSxhQUFBLGNBQUEsY0FBQSxhQUFBLGNBQUE7Z0JBQ0Esa0JBQUE7Ozs7Ozs7Ozs7Ozs7O2dCQWNBLGNBQUEsV0FBQSxZQUFBLFVBQUEsa0JBQUE7OztnQkFHQTs7O2dCQUdBLFFBQUEsUUFBQSxXQUFBLFlBQUEsWUFBQSxNQUFBLFVBQUE7OztnQkFHQTs7O1NBR0EsT0FBQTtTQUNBLElBQUE7Ozs7O0lBS0EsT0FBQSxVQUFBLENBQUEsc0JBQUEsaUJBQUEscUJBQUE7Ozs7O0lBS0EsSUFBQSxVQUFBLENBQUEsaUJBQUE7Ozs7Ozs7Ozs7SUFVQSxTQUFBLE9BQUEsb0JBQUEsZUFBQSxtQkFBQSxnQkFBQTtRQUNBLGVBQUEsTUFBQSxPQUFBO1lBQ0EsYUFBQTs7O1FBR0Esa0JBQUEsVUFBQTtZQUNBLFNBQUE7WUFDQSxhQUFBOzs7UUFHQSxtQkFBQSxVQUFBLFNBQUEsV0FBQTtZQUNBLFVBQUEsSUFBQSxVQUFBLEdBQUE7OztRQUdBLGNBQUEsYUFBQSxLQUFBOzs7Ozs7Ozs7O0lBVUEsU0FBQSxJQUFBLGVBQUEsYUFBQTtRQUNBLGNBQUE7UUFDQSxZQUFBOzs7O0FDekZBLENBQUEsWUFBQSxFQUFBOztJQUVBO1NBQ0EsT0FBQSxRQUFBO1NBQ0EsT0FBQTs7Ozs7SUFLQSxjQUFBLFVBQUEsQ0FBQSxrQkFBQSxpQkFBQTs7Ozs7SUFLQSxlQUFBLFVBQUEsQ0FBQTs7Ozs7OztJQU9BLFNBQUEsY0FBQSxnQkFBQSxlQUFBLFFBQUE7OztRQUdBLGNBQUEsV0FBQSxPQUFBLE1BQUE7O1FBRUE7YUFDQSxNQUFBLGNBQUE7Z0JBQ0EsS0FBQTtnQkFDQSxNQUFBO29CQUNBLGFBQUE7d0JBQ0EsUUFBQSxDQUFBO3dCQUNBLFlBQUE7OztnQkFHQSxPQUFBO29CQUNBLFFBQUE7d0JBQ0EsYUFBQTs7b0JBRUEsZ0JBQUE7d0JBQ0EsYUFBQTt3QkFDQSxZQUFBOzs7O2FBSUEsTUFBQSxhQUFBO2dCQUNBLEtBQUE7Z0JBQ0EsTUFBQTtvQkFDQSxhQUFBO3dCQUNBLFFBQUEsQ0FBQTt3QkFDQSxZQUFBOzs7Z0JBR0EsT0FBQTtvQkFDQSxRQUFBO3dCQUNBLGFBQUE7O29CQUVBLGdCQUFBO3dCQUNBLGFBQUE7d0JBQ0EsWUFBQTs7OzthQUlBLE1BQUEsY0FBQTtnQkFDQSxLQUFBO2dCQUNBLE1BQUE7b0JBQ0EsYUFBQTt3QkFDQSxRQUFBLENBQUE7d0JBQ0EsWUFBQTs7O2dCQUdBLFNBQUE7b0JBQ0EsZ0JBQUE7OzthQUdBLE1BQUEsYUFBQTtnQkFDQSxLQUFBO2dCQUNBLE9BQUE7b0JBQ0EsUUFBQTt3QkFDQSxhQUFBOztvQkFFQSxnQkFBQTt3QkFDQSxhQUFBO3dCQUNBLFlBQUE7Ozs7YUFJQSxNQUFBLHNCQUFBO2dCQUNBLEtBQUE7Z0JBQ0EsTUFBQTtvQkFDQSxhQUFBO3dCQUNBLE1BQUEsQ0FBQTt3QkFDQSxZQUFBOzs7Z0JBR0EsT0FBQTtvQkFDQSxRQUFBO3dCQUNBLGFBQUE7O29CQUVBLGdCQUFBO3dCQUNBLGFBQUE7d0JBQ0EsWUFBQTs7Ozs7Ozs7OztJQVVBLFNBQUEsZUFBQSxhQUFBO1FBQ0EsT0FBQSxZQUFBOzs7O0FDaEhBLENBQUEsV0FBQSxFQUFBOztJQUVBO1NBQ0EsT0FBQSxPQUFBO1NBQ0EsT0FBQTs7Ozs7SUFLQSxPQUFBLFVBQUEsQ0FBQTs7Ozs7SUFLQSxTQUFBLE9BQUEsZ0JBQUE7UUFDQTthQUNBLE1BQUEsV0FBQTtnQkFDQSxPQUFBO29CQUNBLGdCQUFBO3dCQUNBLGFBQUE7d0JBQ0EsWUFBQTs7O2dCQUdBLFFBQUE7b0JBQ0EsU0FB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S0EsSUFBQSxZQUFBLGdCQUFBLFlBQUE7Z0JBQ0EsS0FBQTs7WUFFQSxNQUFBLE9BQUEsV0FBQTtnQkFDQSxPQUFBLEtBQUE7ZUFDQSxVQUFBLFVBQUE7Z0JBQ0EsV0FBQSxZQUFBLFFBQUE7OztZQUdBLE1BQUEsSUFBQSxZQUFBLFlBQUE7Z0JBQ0EsUUFBQTs7O2dCQUdBLFNBQUEsV0FBQTtvQkFDQSxJQUFBLENBQUEsT0FBQTs7d0JBRUEsT0FBQSxXQUFBOzs7Ozs7OztBQy9DQSxDQUFBLFdBQUEsRUFBQTs7SUFFQSxRQUFBLE9BQUEsV0FBQTs7O0FDRkEsQ0FBQSxXQUFBLEVBQUE7O0lBRUEsUUFBQSxPQUFBLFFBQUE7OztBQ0ZBLENBQUEsV0FBQSxFQUFBOztJQUVBLFFBQUEsT0FBQSxZQUFBOzs7QUNGQSxDQUFBLFlBQUEsQ0FBQTs7SUFFQSxRQUFBLE9BQUEsWUFBQTs7O0FDRkEsQ0FBQSxZQUFBLEVBQUE7O0lBRUEsUUFBQSxPQUFBLFlBQUE7OztBQ0ZBLENBQUEsV0FBQSxFQUFBOztJQUVBLFFBQUEsT0FBQSxzQkFBQTs7O0FDRkEsQ0FBQSxZQUFBLEVBQUE7O0lBRUEsUUFBQSxPQUFBLGNBQUE7OztBQ0ZBLENBQUEsV0FBQSxFQUFBOztJQUVBLFFBQUEsT0FBQSxZQUFBOzs7QUNGQSxDQUFBLFdBQUEsRUFBQTs7SUFFQSxRQUFBLE9BQUEsb0JBQUE7OztBQ0ZBLENBQUEsWUFBQSxFQUFBOztJQUVBLFFBQUEsT0FBQSxZQUFBOzs7QUNGQSxDQUFBLFdBQUEsRUFBQTs7SUFFQSxRQUFBLE9BQUEsY0FBQTs7O0FDRkEsQ0FBQSxXQUFBLEVBQUE7O0lBRUEsUUFBQSxPQUFBLG1CQUFBOzs7QUNGQSxDQUFBLFdBQUEsRUFBQTs7SUFFQSxRQUFBLE9BQUEsYUFBQTs7O0FDRkEsQ0FBQSxXQUFBLEVBQUE7O0lBRUEsUUFBQSxPQUFBLG1CQUFBOzs7QUNGQSxDQUFBLFlBQUEsRUFBQTs7SUFFQSxRQUFBLE9BQUEseUJBQUE7OztBQ0ZBLENBQUEsV0FBQSxFQUFBOztJQUVBLFFBQUEsT0FBQSxhQUFBOzs7QUNGQSxDQUFBLFlBQUEsRUFBQTs7SUFFQSxRQUFBLE9BQUEsb0JBQUE7OztBQ0ZBLENBQUEsV0FBQSxFQUFBOztJQUVBLFFBQUEsT0FBQSxvQkFBQTs7O0FDRkEsQ0FBQSxZQUFBLEVBQUE7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsUUFBQSxlQUFBOzs7OztJQUtBLFlBQUEsVUFBQSxDQUFBLFNBQUEsU0FBQSxVQUFBLGNBQUEsZUFBQTs7Ozs7Ozs7Ozs7SUFXQSxTQUFBLFlBQUEsT0FBQSxPQUFBLFFBQUEsWUFBQSxhQUFBLFFBQUE7UUFDQSxJQUFBLFVBQUE7WUFDQSxRQUFBO1lBQ0EsT0FBQTtZQUNBLFFBQUE7WUFDQSxlQUFBO1lBQ0EsZUFBQTtZQUNBLGFBQUE7OztRQUdBLE9BQUE7O1FBRUEsU0FBQSxPQUFBLGFBQUE7WUFDQSxPQUFBLE1BQUEsS0FBQSxPQUFBLE1BQUEsV0FBQTs7O1FBR0EsU0FBQSxNQUFBLGFBQUE7WUFDQSxPQUFBLE1BQUEsTUFBQSxhQUFBLEtBQUEsV0FBQTtnQkFDQSxPQUFBLE1BQUEsSUFBQSxPQUFBLE1BQUE7cUJBQ0EsS0FBQSxXQUFBLGVBQUEsV0FBQTs7OztRQUlBLFNBQUEsU0FBQTtZQUNBLE9BQUEsTUFBQSxLQUFBLE9BQUEsTUFBQSxXQUFBLEtBQUEsWUFBQTtnQkFDQSxPQUFBLE1BQUEsU0FBQSxLQUFBLFlBQUE7b0JBQ0EsWUFBQTtvQkFDQSxPQUFBLEdBQUE7Ozs7O1FBS0EsU0FBQSxjQUFBLE9BQUE7WUFDQSxPQUFBLE1BQUEsS0FBQSxPQUFBLE1BQUEsVUFBQTtpQkFDQSxLQUFBLFdBQUEsZUFBQSxXQUFBOzs7UUFHQSxTQUFBLGNBQUEsT0FBQSxhQUFBO1lBQ0EsT0FBQSxNQUFBLEtBQUEsT0FBQSxNQUFBLFlBQUEsT0FBQTtpQkFDQSxLQUFBLFdBQUEsZUFBQSxXQUFBOzs7UUFHQSxTQUFBLFlBQUEsT0FBQTtZQUNBLE9BQUEsTUFBQSxJQUFBLE9BQUEsTUFBQSxtQkFBQTs7Ozs7QUMvREEsQ0FBQSxXQUFBLEVBQUE7O0lBRUE7U0FDQSxPQUFB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LGVBQUEsV0FBQTs7O1FBR0EsU0FBQSxVQUFBLE1BQUE7WUFDQSxPQUFBLE1BQUEsSUFBQSxPQUFBLE1BQUEsd0JBQUE7aUJBQ0EsS0FBQSxXQUFBLGVBQUEsV0FBQTs7O1FBR0EsU0FBQSxLQUFBLE1BQUEsTUFBQTtZQUNBLE9BQUEsTUFBQSxJQUFBLE9BQUEsTUFBQSxlQUFBLE9BQUEsU0FBQTtpQkFDQSxLQUFBLFdBQUEsZUFBQSxXQUFBOzs7UUFHQSxTQUFBLFdBQUEsTUFBQTtZQUNBLE9BQUEsTUFBQSxLQUFBLE9BQUEsTUFBQSxlQUFBLE9BQUE7aUJBQ0EsS0FBQSxXQUFBLGVBQUEsV0FBQTs7O1FBR0EsU0FBQSxRQUFBLE1BQUE7WUFDQSxPQUFBLE1BQUEsSUFBQSxPQUFBLE1BQUEsZUFBQSxPQUFBO2lCQUNBLEtBQUEsV0FBQSxlQUFBLFdBQUE7OztRQUdBLFNBQUEsVUFBQSxNQUFBO1lBQ0EsT0FBQSxNQUFBLElBQUEsT0FBQSxNQUFBLGVBQUEsT0FBQTtpQkFDQSxLQUFBLFdBQUEsZUFBQSxXQUFBOzs7UUFHQSxTQUFBLFlBQUEsTUFBQTtZQUNBLE9BQUEsTUFBQSxJQUFBLE9BQUEsTUFBQSxlQUFBLE9BQUE7aUJBQ0EsS0FBQSxXQUFBLGVBQUEsV0FBQTs7O1FBR0EsU0FBQSxNQUFBLElBQUE7WUFDQSxPQUFBLE1BQUEsSUFBQSxPQUFBLE1BQUEscUJBQUEsSUFBQSxNQUFBLENBQUEsa0JBQUE7OztRQUdBLFNBQUEsUUFBQSxJQUFBO1lBQ0EsT0FBQSxNQUFBLElBQUEsT0FBQSxNQUFBLHVCQUFBLElBQUEsTUFBQSxDQUFBLGtCQUFBOzs7OztBQzlJQSxDQUFBLFlBQUEsRUFBQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxXQUFBLDZCQUFBOzs7OztJQUtBLDBCQUFBLFVBQUEsQ0FBQTs7Ozs7O0lBTUEsU0FBQSwwQkFBQSxrQkFBQTtRQUNBLElBQUEsS0FBQTtRQUNBLEdBQUEsV0FBQSxpQkFBQTs7OztBQ2pCQSxDQUFBLFlBQUEsRUFBQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxXQUFBLDBCQUFBOzs7OztJQUtBLHVCQUFBLFVBQUEsQ0FBQTs7Ozs7O0lBTUEsU0FBQSx1QkFBQSxrQkFBQTtRQUNBLElBQUEsS0FBQTtRQUNBLEdBQUEsV0FBQSxpQkFBQTs7OztBQ2pCQSxDQUFBLFdBQUEsRUFBQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxXQUFBLDRCQUFBOzs7OztJQUtBLHlCQUFBLFVBQUEsQ0FBQTs7Ozs7O0lBTUEsU0FBQSx5QkFBQSxrQkFBQTtRQUNBLElBQUEsS0FBQTtRQUNBLEdBQUEsV0FBQSxpQkFBQTs7OztBQ2pCQSxDQUFBLFdBQUEsRUFBQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxXQUFBLDRCQUFBOzs7OztJQUtBLHlCQUFBLFVBQUEsQ0FBQTs7Ozs7O0lBTUEsU0FBQSx5QkFBQSxpQkFBQTtRQUNBLElBQUEsS0FBQTtRQUNBLEdBQUEsV0FBQSxnQkFBQTtRQUNBLEdBQUEsT0FBQSxnQkFBQTtRQUNBLEdBQUEsYUFBQSxHQUFBLFNBQUEsU0FBQTs7OztBQ25CQSxDQUFBLFlBQUEsRUFBQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxXQUFBLHlCQUFBOzs7OztJQUtBLHNCQUFBLFVBQUEsQ0FBQTs7Ozs7O0lBTUEsU0FBQSxzQkFBQSxpQkFBQTtRQUNBLElBQUEsS0FBQTtRQUNBLEdBQUEsT0FBQSxnQkFBQTs7OztBQ2pCQSxDQUFBLFlBQUEsRUFBQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxXQUFBLDJCQUFBOzs7OztJQUtBLHdCQUFBLFVBQUEsQ0FBQTs7Ozs7O0lBTUEsU0FBQSx3QkFBQSxpQkFBQTtRQUNBLElBQUEsS0FBQTtRQUNBLEdBQUEsT0FBQSxnQkFBQTs7OztBQ2pCQSxDQUFBLFdBQUEsRUFBQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLGtCQUFBOzs7OztJQUtBLGVBQUEsVUFBQSxDQUFBLFNBQUEsY0FBQTs7Ozs7Ozs7SUFRQSxTQUFBLGVBQUEsT0FBQSxZQUFBLFFBQUE7UUFDQSxJQUFBLFVBQUE7WUFDQSxTQUFBOzs7UUFHQSxPQUFBOztRQUVBLFNBQUEsUUFBQSxV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QUEsSUFBQSxHQUFBO21CQUNBLElBQUEsSUFBQSxLQUFBLE9BQUE7Z0JBQ0EsR0FBQSxTQUFBLElBQUEsS0FBQSxNQUFBO2dCQUNBLFFBQUEsSUFBQSxHQUFBOzs7Ozs7QUNyREEsQ0FBQSxXQUFBLEVBQUE7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsVUFBQSxVQUFBOzs7OztJQUtBLE9BQUEsVUFBQSxDQUFBOzs7Ozs7SUFNQSxTQUFBLE9BQUEsZ0JBQUE7UUFDQSxJQUFBLFlBQUE7WUFDQSxVQUFBO1lBQ0EsT0FBQTtZQUNBLGFBQUE7WUFDQSxNQUFBOzs7UUFHQSxPQUFBOztRQUVBLFNBQUEsS0FBQSxPQUFBLE1BQUEsT0FBQTtZQUNBLElBQUEsT0FBQTtZQUNBLElBQUEsUUFBQTs7WUFFQSxJQUFBLE1BQUEsT0FBQTtnQkFDQSxNQUFBLGFBQUEsTUFBQTtnQkFDQSxNQUFBLFFBQUE7OztZQUdBLFNBQUEsUUFBQTtnQkFDQSxJQUFBLENBQUEsUUFBQSxRQUFBO29CQUNBLGVBQUEsTUFBQSxNQUFBLElBQUEsS0FBQTtxQkFDQSxJQUFBLFFBQUEsUUFBQTtvQkFDQSxlQUFBLFFBQUEsTUFBQSxJQUFBLEtBQUE7OztZQUdBLFNBQUEsVUFBQTtnQkFDQSxPQUFBO2dCQUNBLE1BQUEsZUFBQTtnQkFDQSxNQUFBO2dCQUNBOzs7WUFHQSxTQUFBLFlBQUE7Z0JBQ0EsT0FBQTtnQkFDQSxNQUFBLGVBQUE7Z0JBQ0EsTUFBQTtnQkFDQTs7Ozs7O0FDcERBLENBQUEsV0FBQSxFQUFBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFVBQUEsY0FBQTs7Ozs7SUFLQSxTQUFBLGFBQUE7UUFDQSxJQUFBLFlBQUE7WUFDQSxVQUFBO1lBQ0EsYUFBQTtZQUNBLE1BQUE7OztRQUdBLE9BQUE7O1FBRUEsU0FBQSxLQUFBLE9BQUEsTUFBQSxPQUFBO1lBQ0EsSUFBQSxNQUFBLE1BQUE7Z0JBQ0EsSUFBQSxPQUFBLE1BQUEsTUFBQSxNQUFBOztnQkFFQSxNQUFBLGFBQUE7Z0JBQ0EsTUFBQSxVQUFBLE1BQUEsV0FBQTs7Ozs7O0FDdkJB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O2dCQUNBO3FCQUNBLEdBQUEsUUFBQSxNQUFBLFVBQUE7d0JBQ0EsUUFBQTs7cUJBRUEsS0FBQSxZQUFBO3dCQUNBLFdBQUEsV0FBQSx1QkFBQSxTQUFBLFVBQUEsV0FBQTs7Ozs7O1FBTUEsT0FBQSxPQUFBLFFBQUEsVUFBQSxRQUFBO1lBQ0EsSUFBQSxDQUFBLFVBQUEsT0FBQSxVQUFBLEdBQUE7O1lBRUEsU0FBQSxZQUFBOztnQkFFQSxJQUFBLFdBQUEsR0FBQSxHQUFBLEdBQUE7ZUFDQTs7O1FBR0EsU0FBQSxpQkFBQSxNQUFBO1lBQ0EsR0FBQSxLQUFBLEtBQUEsS0FBQTtZQUNBLEdBQUEsS0FBQSxRQUFBLEtBQUE7WUFDQSxHQUFBLEtBQUEsT0FBQSxLQUFBOztZQUVBLElBQUEsS0FBQSxZQUFBO2dCQUNBLEtBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxLQUFBLFdBQUEsUUFBQSxLQUFBO29CQUNBLFlBQUEsS0FBQSxXQUFBOzs7OztRQUtBLFNBQUEsWUFBQSxVQUFBOztZQUVBLElBQUEsR0FBQSxLQUFBLGVBQUEsUUFBQSxTQUFBLFFBQUEsQ0FBQSxHQUFBO2dCQUNBLEdBQUEsS0FBQSxlQUFBLEtBQUEsU0FBQTs7OztZQUlBLElBQUEsdUJBQUE7WUFDQSxLQUFBLElBQUEsSUFBQSxHQUFBLElBQUEsR0FBQSxtQkFBQSxRQUFBLEtBQUE7Z0JBQ0EsSUFBQSxHQUFBLG1CQUFBLEdBQUEsT0FBQSxTQUFBLElBQUE7b0JBQ0EsdUJBQUE7b0JBQ0E7OztZQUdBLElBQUEsc0JBQUE7Z0JBQ0EsR0FBQSxtQkFBQSxLQUFBOzs7O1FBSUEsU0FBQSxlQUFBLFlBQUE7O1lBRUEsSUFBQSxZQUFBLEdBQUEsS0FBQSxlQUFBLFFBQUE7WUFDQSxJQUFBLFlBQUEsQ0FBQSxHQUFBO2dCQUNBLEdBQUEsS0FBQSxlQUFBLE9BQUEsV0FBQTs7OztZQUlBLEtBQUEsSUFBQSxJQUFBLEdBQUEsSUFBQSxHQUFBLG1CQUFBLFFBQUEsS0FBQTtnQkFDQSxJQUFBLEdBQUEsbUJBQUEsR0FBQSxPQUFBLFlBQUE7b0JBQ0Es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QUFBO1lBQ0EsS0FBQTtZQUNBLEtBQUE7WUFDQSxLQUFBOzs7UUFHQSxPQUFBOztRQUVBLFNBQUEsT0FBQSxNQUFBO1lBQ0EsT0FBQSxPQUFBLE1BQUEsUUFBQSxjQUFBLFVBQUEsR0FBQTtnQkFDQSxPQUFBLFVBQUE7Ozs7OztBQ3ZCQSxDQUFBLFdBQUEsRUFBQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxPQUFBLFdBQUE7O0lBRUEsU0FBQSxVQUFBO1FBQ0EsT0FBQTs7UUFFQSxTQUFBLE9BQUEsT0FBQSxVQUFBLEtBQUEsTUFBQTtZQUNBLElBQUEsQ0FBQSxPQUFBLE9BQUE7O1lBRUEsTUFBQSxTQUFBOztZQUVBLElBQUEsQ0FBQSxPQUFBLE1BQUEsVUFBQSxLQUFBLE9BQUE7O1lBRUEsUUFBQSxNQUFBLE9BQUEsR0FBQTs7WUFFQSxJQUFBLFVBQUE7Z0JBQ0EsSUFBQSxZQUFBLE1BQUEsWUFBQTs7Z0JBRUEsSUFBQSxhQUFBLENBQUE7b0JBQ0EsUUFBQSxNQUFBLE9BQUEsR0FBQTs7O1lBR0EsT0FBQSxTQUFBLFFBQUE7Ozs7O0FDekJBLENBQUEsV0FBQSxFQUFBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFFBQUEsUUFBQTs7Ozs7SUFLQSxTQUFBLE9BQUE7UUFDQSxJQUFBLFVBQUE7O1FBRUEsT0FBQTs7OztBQ1pBLENBQUEsV0FBQSxFQUFBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFFBQUEsa0JBQUE7Ozs7O0lBS0EsZUFBQSxVQUFBLENBQUEsTUFBQTs7Ozs7OztJQU9BLFNBQUEsZUFBQSxJQUFBLFdBQUE7UUFDQSxJQUFBLFVBQUE7WUFDQSxTQUFBO1lBQ0EsY0FBQTtZQUNBLFVBQUE7WUFDQSxlQUFBOzs7UUFHQSxPQUFBOzs7UUFHQSxTQUFBLFFBQUEsUUFBQTtZQUNBLE9BQUE7OztRQUdBLFNBQUEsYUFBQSxRQUFBO1lBQ0EsT0FBQTs7OztRQUlBLFNBQUEsU0FBQSxLQUFBO1lBQ0EsT0FBQTs7OztRQUlBLFNBQUEsY0FBQSxLQUFBO1lBQ0EsSUFBQSxJQUFBLFVBQUEsS0FBQTtnQkFDQSxVQUFBLElBQUEsVUFBQSxHQUFBLFdBQUE7b0JBQ0EsU0FBQSxJQUFBLEtBQUEsTUFBQTs7OztZQUlBLE9BQUEsR0FBQSxPQUFBOzs7OztBQ2hEQSxDQUFBLFlBQUEsRUFBQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLGNBQUE7Ozs7O0lBS0EsV0FBQSxVQUFBLENBQUE7Ozs7OztJQU1BLFNBQUEsV0FBQSxJQUFBO1FBQ0EsSUFBQSxVQUFBO1lBQ0EsZUFBQTtZQUNBLGFBQUE7OztRQUdBLE9BQUE7O1FBRUEsU0FBQSxjQUFBLEtBQUE7WUFDQSxJQUFBLE9BQUEsSUFBQSxTQUFBO2dCQUNBLE9BQUEsSUFBQTs7WUFFQSxZQUFBOzs7UUFHQSxTQUFBLFlBQUEsS0FBQTtZQUNBLE9BQUEsR0FBQSxPQUFBOzs7OztBQy9CQSxDQUFBLFdBQUEsRUFBQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLG1CQUFBOzs7OztJQUtBLGdCQUFBLFVBQUEsQ0FBQSxjQUFBOzs7Ozs7O0lBT0EsU0FBQSxnQkFBQSxZQUFBLFFBQUE7UUFDQSxJQUFBLFVBQUE7WUFDQSxxQkFBQTs7O1FBR0EsT0FBQTs7Ozs7UUFLQSxTQUFBLHNCQUFBO1lBQ0EsV0FBQSxJQUFBLHFCQUFBLFNBQUEsT0FBQSxTQUFBLFVBQUE7Z0JBQ0EsSUFBQSxRQUFBLFNBQUE7b0JBQ0EsTUFBQTs7b0JBRUEsT0FBQSxHQUFBLFFBQUEsU0FBQTs7Ozs7OztBQy9CQSxDQUFBLFdBQUEsRUFBQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLGVBQUE7Ozs7O0lBS0EsWUFBQSxVQUFBLENBQUE7Ozs7OztJQU1BLFNBQUEsWUFBQSxZQUFBO1FBQ0EsSUFBQSxVQUFBO1lBQ0EsWUFBQTtZQUNBLFNBQUE7WUFDQSxZQUFBOzs7UUFHQSxPQUFBOzs7OztRQUtBLFNBQUEsYUFBQTtZQUNBLElBQUEsT0FBQSxhQUFBLFFBQUE7O1lBRUEsSUFBQSxTQUFBO2dCQUNBLHdCQUFBLE1BQUE7O2dCQUVBOzs7Ozs7Ozs7UUFTQSxTQUFBLFFBQUEsTUFBQTtZQUNBLHNCQUFBO1lBQ0Esd0JBQUE7Ozs7OztRQU1BLFNBQUEsYUFBQTtZQUNBO1lBQ0E7Ozs7Ozs7O1FBUUEsU0FBQSxzQkFBQSxNQUFBO1lBQ0EsYUFBQSxRQUFBLFFBQUEsS0FBQSxVQUFBOzs7Ozs7UUFNQSxTQUFBLDZCQUFBO1lBQ0EsYUFBQSxXQUFBOzs7Ozs7Ozs7OztRQVdBLFNBQUEsd0JBQUEsTUFBQSxhQUFBO1lBQ0EsV0FBQSxXQUFBOztZQUVBLElBQUE7Z0JBQ0EsV0FBQSxjQUFBLEtBQUEsTUFBQTs7Z0JBRUEsV0FBQSxjQUFBOzs7Ozs7O1FBT0EsU0FBQSx5QkFBQTtZQUNBLFdBQUEsV0FBQTtZQUNBLFdBQUEsY0FBQTs7Ozs7QUM5RkEsQ0FBQSxXQUFBLEVBQUE7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsVUFBQSxXQUFBOzs7OztJQUtBLFFBQUEsVUFBQSxDQUFBOzs7OztJQUtBLFNBQUEsUUFBQSxVQUFBO1FBQ0EsSUFBQSxZQUFBO1lBQ0EsVUFBQTtZQUNBLE1BQUE7OztRQUdBLE9BQUE7O1FBRUEsU0FBQSxLQUFBLE9BQUEsTUFBQTtZQUNBLElBQUEsU0FBQSxRQUFBLFFBQUEsU0FBQSxjQUFBO2dCQUNBLFNBQUEsUUFBQSxRQUFBLFNBQUEsY0FBQTtnQkFDQSxlQUFBLFFBQUEsUUFBQSxTQUFBLGNBQUE7Z0JBQ0E7O1lBRUEsU0FBQSxZQUFBO2dCQUNBLFlBQUEsT0FBQSxHQUFBLFlBQUEsT0FBQSxHQUFBLGdCQUFBLGFBQUEsR0FBQTs7Z0JBRUEsS0FBQSxNQUFBO29CQUNBLFFBQUE7d0JBQ0EsS0FBQTs7O2VBR0E7Ozs7O0FDcENBLENBQUEsWUFBQSxFQUFBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFVBQUEsV0FBQTs7Ozs7SUFLQSxTQUFBLFVBQUE7UUFDQSxJQUFBLFlBQUE7WUFDQSxVQUFBO1lBQ0EsYUFBQTtZQUNBLE1BQUE7OztRQUdBLE9BQUE7O1FBRUEsU0FBQSxLQUFBLE9BQUE7WUFDQSxNQUFBLElBQUEsaUJBQUEsU0FBQSxPQUFBLE1BQUE7Z0JBQ0EsTUFBQSxRQUFBO2dCQUNBLE1BQUEsVUFBQTtnQkFDQSxNQUFBLFVBQUEsS0FBQTs7O1lBR0EsTUFBQSxJQUFBLGVBQUEsVUFBQSxPQUFBLE1BQUE7Z0JBQ0EsTUFBQSxVQUFBO2dCQUNBLE1BQUEsUUFBQTtnQkFDQSxNQUFBLFVBQUEsS0FBQTs7Ozs7O0FDNUJBLENBQUEsV0FBQSxFQUFBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFdBQUEsMkJBQUE7U0FDQSxVQUFBLG1CQUFBOzs7OztJQUtBLFNBQUEseUJBQUE7Ozs7O0lBS0EsU0FBQSxrQkFBQTtRQUNBLElBQUEsWUFBQTtZQUNBLFVBQUE7WUFDQSxPQUFBO2dCQUNBLE9BQUE7Z0JBQ0EsUUFBQTtnQkFDQSxRQUFBOztZQUVBLGtCQUFBO1lBQ0EsWUFBQTtZQUNBLGFBQUE7WUFDQSxNQUFBOzs7UUFHQSxPQUFBOztRQUVBLFNBQUEsS0FBQSxPQUFBLE1BQUEsT0FBQTtZQUNBLE1BQUEsUUFBQSxNQUFBLFNBQUE7WUFDQSxNQUFBLFdBQUEsTUFBQSxZQUFBO1lBQ0EsTUFBQSxPQUFBLE1BQUEsUUFBQTtZQUNBLE1BQUEsUUFBQSxNQUFBO1lBQ0EsTUFBQSxLQUFBLE1BQUE7Ozs7O0FDcENBLENBQUEsV0FBQSxFQUFBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFVBQUEsYUFBQTs7Ozs7SUFLQSxTQUFBLFlBQUE7UUFDQSxJQUFBLFlBQUE7WUFDQSxVQUFBO1lBQ0EsT0FBQTtZQUNBLGFBQUE7WUFDQSxNQUFBOzs7UUFHQSxPQUFBOztRQUVBLFNBQUEsS0FBQSxPQUFBLE1BQUEsT0FBQTtZQUNBLElBQUEsTUFBQSxPQUFBO2dCQUNBLE1BQUEsUUFBQSxNQUFBO2dCQUNBLE1BQUEsT0FBQSxNQUFBLFFBQUE7Ozs7OztBQ3RCQSxDQUFBLFdBQUEsRUFBQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxVQUFBLFdBQUE7Ozs7O0lBS0EsU0FBQSxVQUFBO1FBQ0EsSUFBQSxZQUFBO1lBQ0EsVUFBQTtZQUNBLE1BQUE7OztRQUdBLE9BQUE7O1FBRUEsU0FBQSxLQUFBLE9BQUEsTUFBQTtZQUNBLEtBQUE7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QSxXQUFBLEVBQUE7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsVUFBQSxpQkFBQTs7Ozs7SUFLQSxTQUFBLGdCQUFBO1FBQ0EsSUFBQSxZQUFBO1lBQ0EsVUFBQTtZQUNBLGFBQUE7WUFDQSxNQUFBOzs7UUFHQSxPQUFBOztRQUVBLFNBQUEsS0FBQSxPQUFBLE1BQUEsT0FBQTtZQUNBLElBQUEsTUFBQSxNQUFBO2dCQUNBLElBQUEsT0FBQSxNQUFBLE1BQUEsTUFBQTs7Z0JBRUEsTUFBQSxlQUFBLEtBQUE7Z0JBQ0EsTUFBQSxXQUFBLEtBQUE7Z0JBQ0EsTUFBQSxPQUFBLEtBQUE7Z0JBQ0EsTUFBQSxNQUFBLEtBQUE7Ozs7OztBQ3pCQSxDQUFBLFdBQUEsRUFBQTs7SUFFQTtTQUNBLE9BQUEsYUFBQTtTQUNBLFVBQUEsZUFBQTs7Ozs7SUFLQSxZQUFBLFVBQUEsQ0FBQSxXQUFBOzs7Ozs7O0lBT0EsU0FBQSxZQUFBLFNBQUEsVUFBQTtRQUNBLElBQUEsYUFBQTtZQUNBLFVBQUE7WUFDQSxNQUFBOzs7UUFHQSxPQUFBOztRQUVBLFNBQUEsS0FBQSxPQUFBLFNBQUE7WUFDQSxJQUFBLFdBQUEsUUFBQSxRQUFBO1lBQ0EsSUFBQSxRQUFBO1lBQ0EsSUFBQSxnQkFBQTs7WUFFQSxRQUFBLEtBQUEsYUFBQTs7WUFFQSxTQUFBLEdBQUEsVUFBQTs7WUFFQSxTQUFBLFlBQUE7Z0JBQ0EsUUFBQSxZQUFBOztnQkFFQSxPQUFBLFVBQUEsWUFBQTtvQkFDQSxPQUFBLFFBQUEsSUFBQTt3QkFDQSxVQUFBOztvQkFFQTs7O1lBR0EsU0FBQSxTQUFBO2dCQUNBLElBQUEsS0FBQSxTQUFBOzs7Z0JBR0EsSUFBQSxPQUFBO29CQUNBLFFBQUEsWUFBQTs7b0JBRUEsUUFBQSxTQUFBOztnQkFFQSxJQUFBLEtBQUEsSUFBQSxnQkFBQSxPQUFBO29CQUNBOzs7Z0JBR0EsSUFBQSxLQUFBO29CQUNBLFFBQUEsU0FBQTs7b0JBRUEsUUFBQSxZQUFBOzs7Z0JBR0EsZ0JBQUE7Ozs7OztBQzlEQSxDQUFBLFdBQUEsRUFBQTs7SUFFQTtT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QSxNQUFBO1lBQ0EsT0FBQSxNQUFBLElBQUEsT0FBQSxNQUFBLDhCQUFBO2lCQUNBLEtBQUEsV0FBQSxlQUFBLFdBQUE7Ozs7Ozs7OztRQVNBLFNBQUEsVUFBQSxNQUFBO1lBQ0EsT0FBQSxNQUFBLElBQUEsT0FBQSxNQUFBLHlCQUFBO2lCQUNBLEtBQUEsV0FBQSxlQUFBLFdBQUE7Ozs7S0FJQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAnLCBbXG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgfCBFeHRlcm5hbCBNb2R1bGVzXG4gICAgICAgICAgICAgfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgfFxuICAgICAgICAgICAgIHwgVGhlc2UgYXJlIHRoZSBtb2R1bGVzIGNyZWF0ZWQgYnkgdGhlIEFuZ3VsYXJKUyB0ZWFtLCBvcGVuIHNvdXJjZVxuICAgICAgICAgICAgIHwgcHJvamVjdHMgb3IgdGhpcmQgcGFydHkgbW9kdWxlcy5cbiAgICAgICAgICAgICB8XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICduZ0FuaW1hdGUnLCAnbmdTYW5pdGl6ZScsICdwZXJtaXNzaW9uJywgJ3VpLnJvdXRlcicsICdzYXRlbGxpemVyJywgJ2FuZ3VsYXItbG9hZGluZy1iYXInLFxuICAgICAgICAgICAgICAgICc3MjBrYi50b29sdGlwcycsICd1aS5ib290c3RyYXAnLFxuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgIHwgSW50ZXJuYWwgTW9kdWxlc1xuICAgICAgICAgICAgIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgIHxcbiAgICAgICAgICAgICB8IFRoZXNlIGFyZSB0aGUgbW9kdWxlcyB0aGF0IGFyZSBtZWFudCB0byBiZSBzaGFyZWQgdGhyb3VnaG91dCB0aGVcbiAgICAgICAgICAgICB8IGFwcCwgZWl0aGVyIGFzIHNvbWUga2luZCBvZiBjb25maWcsIGRhdGEsIHJldXNhYmxlIGNvbXBvbmVudCxcbiAgICAgICAgICAgICB8IHZpZXcgb3IgcGFydGlhbCwgZXRjLlxuICAgICAgICAgICAgIHxcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgLy8gU2hhcmVkXG4gICAgICAgICAgICAgICAgJ2RpcmVjdGl2ZXMnLCAnZmlsdGVycycsICdzZXJ2aWNlcycsICdjb25maWcnLCAnYWNjZXNzLWNvbnRyb2wnLCAndXRpbCcsXG5cbiAgICAgICAgICAgICAgICAvLyAkdGVtcGxhdGVDYWNoZVxuICAgICAgICAgICAgICAgICd2aWV3c0FuZFBhcnRpYWxzJyxcblxuICAgICAgICAgICAgICAgIC8vIE90aGVyXG4gICAgICAgICAgICAgICAgJ2F1dGgnLCAnaG9tZScsICdwcm9maWxlJywgJ2FydGljbGVzJywgJ2NhdGVnb3J5JywgJ3VpJywgJ3NlYXJjaCcsICdtZScsXG5cbiAgICAgICAgICAgICAgICAvLyBFcnJvcnNcbiAgICAgICAgICAgICAgICAnNDA0J1xuXG4gICAgICAgIF0pXG4gICAgICAgIC5jb25maWcoY29uZmlnKVxuICAgICAgICAucnVuKHJ1bik7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgY29uZmlnLiRpbmplY3QgPSBbJyR1cmxSb3V0ZXJQcm92aWRlcicsICckaHR0cFByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgJyRzdGF0ZVByb3ZpZGVyJ107XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgcnVuLiRpbmplY3QgPSBbJ2NvbmZpZ1NlcnZpY2UnLCAndXNlclNlcnZpY2UnXTtcblxuICAgIC8qKlxuICAgICAqIENvbmZpZ3VyZSBhcHAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gJHVybFJvdXRlclByb3ZpZGVyXG4gICAgICogQHBhcmFtICRodHRwUHJvdmlkZXJcbiAgICAgKiBAcGFyYW0gJGxvY2F0aW9uUHJvdmlkZXJcbiAgICAgKiBAcGFyYW0gJHN0YXRlUHJvdmlkZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb25maWcoJHVybFJvdXRlclByb3ZpZGVyLCAkaHR0cFByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlciwgJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2FwcCcsIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2FwcC5odG1sJ1xuICAgICAgICB9KTtcblxuICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUoe1xuICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgIHJlcXVpcmVCYXNlOiBmYWxzZVxuICAgICAgICB9KTtcblxuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKGZ1bmN0aW9uKCRpbmplY3Rvcikge1xuICAgICAgICAgICAgJGluamVjdG9yLmdldCgnJHN0YXRlJykuZ28oJ2FwcC40MDQnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnYXBpSW50ZXJjZXB0b3InKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiAgSW5pdGlhbGl6ZSBnbG9iYWwgY29uZmlndXJhdGlvbi5cbiAgICAgKiAgSW5pdGlhbGl6ZSB1c2VyIGlmIGxvZ2dlZCBpbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb25maWdTZXJ2aWNlXG4gICAgICogQHBhcmFtIHVzZXJTZXJ2aWNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gcnVuKGNvbmZpZ1NlcnZpY2UsIHVzZXJTZXJ2aWNlKSB7XG4gICAgICAgIGNvbmZpZ1NlcnZpY2UuaW5pdGlhbGl6ZSgpO1xuICAgICAgICB1c2VyU2VydmljZS5pbml0aWFsaXplKCk7XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXV0aCcsIFtdKVxuICAgICAgICAuY29uZmlnKGNvbmZpZ3VyYXRpb24pO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIGNvbmZpZ3VyYXRpb24uJGluamVjdCA9IFsnJHN0YXRlUHJvdmlkZXInLCAnJGF1dGhQcm92aWRlcicsICdjb25maWcnXTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBsb2dvdXRSZXNvbHZlci4kaW5qZWN0ID0gWydhdXRoU2VydmljZSddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICRzdGF0ZVByb3ZpZGVyXG4gICAgICogQHBhcmFtICRhdXRoUHJvdmlkZXJcbiAgICAgKiBAcGFyYW0gY29uZmlnXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29uZmlndXJhdGlvbigkc3RhdGVQcm92aWRlciwgJGF1dGhQcm92aWRlciwgY29uZmlnKSB7XG4gICAgICAgIC8vIFNhdGVsbGl6ZXIgY29uZmlndXJhdGlvbiB0aGF0IHNwZWNpZmllcyB3aGljaCBBUElcbiAgICAgICAgLy8gcm91dGUgdGhlIEpXVCBzaG91bGQgYmUgcmV0cmlldmVkIGZyb21cbiAgICAgICAgJGF1dGhQcm92aWRlci5sb2dpblVybCA9IGNvbmZpZy51cmwgKyAnL2F1dGhlbnRpY2F0ZSc7XG5cbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnYXBwLnNpZ251cCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvc2lnbnVwJyxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IFsnaXNBdXRoZW50aWNhdGVkJ10sXG4gICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdFRvOiAnYXBwLmhvbWUnXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICdoZWFkJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvYXV0aC9zaWdudXAvaGVhZC5odG1sJ1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnd2lkZS1jb250ZW50Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvYXV0aC9zaWdudXAvc2lnbnVwLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1NpZ251cENvbnRyb2xsZXIgYXMgdm0nXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdhcHAubG9naW4nLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xvZ2luJyxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IFsnaXNBdXRoZW50aWNhdGVkJ10sXG4gICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdFRvOiAnYXBwLmhvbWUnXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICdoZWFkJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvYXV0aC9sb2dpbi9oZWFkLmh0bWwnXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICd3aWRlLWNvbnRlbnQnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9hdXRoL2xvZ2luL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0xvZ2luQ29udHJvbGxlciBhcyB2bSdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC5sb2dvdXQnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2xvZ291dCcsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBwZXJtaXNzaW9uczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OiBbJ2lzQW5vbnltb3VzJ10sXG4gICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdFRvOiAnYXBwLmxvZ2luJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ291dFJlc29sdmVyOiBsb2dvdXRSZXNvbHZlclxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC5yZXNldCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvcmVzZXQnLFxuICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICdoZWFkJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvYXV0aC9wYXNzd29yZC1mb3Jnb3QvaGVhZC5odG1sJ1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnd2lkZS1jb250ZW50Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvYXV0aC9wYXNzd29yZC1mb3Jnb3QvcGFzc3dvcmQtZm9yZ290Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bhc3N3b3JkRm9yZ290Q29udHJvbGxlciBhcyB2bSdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC5yZXNldC1wYXNzd29yZCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvcmVzZXQvOnRva2VuJyxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbmx5OiBbJ2lzVG9rZW5WYWxpZCddLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3RUbzogJ2FwcC5yZXNldCdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgJ2hlYWQnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9hdXRoL3Bhc3N3b3JkLXJlc2V0L2hlYWQuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ3dpZGUtY29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2F1dGgvcGFzc3dvcmQtcmVzZXQvcGFzc3dvcmQtcmVzZXQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnUGFzc3dvcmRSZXNldENvbnRyb2xsZXIgYXMgdm0nXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gYXV0aFNlcnZpY2VcbiAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsb2dvdXRSZXNvbHZlcihhdXRoU2VydmljZSkge1xuICAgICAgICByZXR1cm4gYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCc0MDQnLCBbXSlcbiAgICAgICAgLmNvbmZpZyhjb25maWcpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIGNvbmZpZy4kaW5qZWN0ID0gWyckc3RhdGVQcm92aWRlciddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICRzdGF0ZVByb3ZpZGVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29uZmlnKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC40MDQnLCB7XG4gICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgJ3dpZGUtY29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwLzQwNC80MDQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTm90Rm91bmRDb250cm9sbGVyIGFzIHZtJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbnVsbFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FydGljbGVzJywgW10pXG4gICAgICAgIC5jb25maWcoY29uZmlnKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBjb25maWcuJGluamVjdCA9IFsnJHN0YXRlUHJvdmlkZXInXTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBhcnRpY2xlUmVzb2x2ZXIuJGluamVjdCA9IFsnJHN0YXRlUGFyYW1zJywgJ2FydGljbGVTZXJ2aWNlJ107XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgd3JpdGVPckVkaXRSZXNvbHZlci4kaW5qZWN0ID0gWyckc3RhdGUnLCAnYXJ0aWNsZVNlcnZpY2UnXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkc3RhdGVQcm92aWRlclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbmZpZygkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdhcHAuYXJ0aWNsZScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvQDp1c2VybmFtZS86YXJ0aWNsZVNsdWcnLFxuICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICdoZWFkJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvYXJ0aWNsZXMvYXJ0aWNsZS9oZWFkLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0FydGljbGVIZWFkQ29udHJvbGxlciBhcyB2bSdcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ2FydGljbGUtY29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2FydGljbGVzL2FydGljbGUvYXJ0aWNsZS5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBcnRpY2xlQ29udHJvbGxlciBhcyB2bSdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgICAgICBhcnRpY2xlUmVzb2x2ZXI6IGFydGljbGVSZXNvbHZlclxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC53cml0ZScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvd3JpdGUnLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgcGVybWlzc2lvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ubHk6IFsnaXNBdXRoZW50aWNhdGVkJ10sXG4gICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdFRvOiAnYXBwLmhvbWUnXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICdoZWFkJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvYXJ0aWNsZXMvd3JpdGUtb3ItZWRpdC9oZWFkLmh0bWwnXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICd3aWRlLWNvbnRlbnQnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9hcnRpY2xlcy93cml0ZS1vci1lZGl0L3dyaXRlLW9yLWVkaXQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnV3JpdGVPckVkaXRDb250cm9sbGVyIGFzIHZtJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlT3JFZGl0UmVzb2x2ZXI6IHdyaXRlT3JFZGl0UmVzb2x2ZXJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdhcHAuZWRpdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvQDp1c2VybmFtZS86YXJ0aWNsZVNsdWcvZWRpdD9kcmFmdCcsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBwZXJtaXNzaW9uczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgb25seTogWydpc0F1dGhlbnRpY2F0ZWQnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0VG86ICdhcHAuaG9tZSdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgJ2hlYWQnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9hcnRpY2xlcy93cml0ZS1vci1lZGl0L2hlYWQuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ3dpZGUtY29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2FydGljbGVzL3dyaXRlLW9yLWVkaXQvd3JpdGUtb3ItZWRpdC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdXcml0ZU9yRWRpdENvbnRyb2xsZXIgYXMgdm0nXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgYm9keTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcmllczogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgZHJhZnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnZmFsc2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3F1YXNoOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVPckVkaXRSZXNvbHZlcjogd3JpdGVPckVkaXRSZXNvbHZlclxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkc3RhdGVQYXJhbXNcbiAgICAgKiBAcGFyYW0gYXJ0aWNsZVNlcnZpY2VcbiAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhcnRpY2xlUmVzb2x2ZXIoJHN0YXRlUGFyYW1zLCBhcnRpY2xlU2VydmljZSkge1xuICAgICAgICByZXR1cm4gYXJ0aWNsZVNlcnZpY2UuZ2V0UHVibGljKCRzdGF0ZVBhcmFtcy5hcnRpY2xlU2x1Zyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICRzdGF0ZVxuICAgICAqIEBwYXJhbSBhcnRpY2xlU2VydmljZVxuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHdyaXRlT3JFZGl0UmVzb2x2ZXIoJHN0YXRlLCBhcnRpY2xlU2VydmljZSkge1xuICAgICAgICAvLyBGZXRjaCBhIGRyYWZ0XG4gICAgICAgIGlmICgkc3RhdGUudG9QYXJhbXMuZHJhZnQgPT09ICd0cnVlJykge1xuICAgICAgICAgICAgcmV0dXJuIGFydGljbGVTZXJ2aWNlLmdldERyYWZ0KCRzdGF0ZS50b1BhcmFtcy5hcnRpY2xlU2x1Zyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRmV0Y2ggYSBwdWJsaWMgc3RvcnlcbiAgICAgICAgZWxzZSBpZiAoJHN0YXRlLnRvUGFyYW1zLmRyYWZ0ID09PSAnZmFsc2UnKSB7XG4gICAgICAgICAgICByZXR1cm4gYXJ0aWNsZVNlcnZpY2UuZ2V0UHVibGljKCRzdGF0ZS50b1BhcmFtcy5hcnRpY2xlU2x1Zyk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2NhdGVnb3J5JywgW10pXG4gICAgICAgIC5jb25maWcoY29uZmlnKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBjb25maWcuJGluamVjdCA9IFsnJHN0YXRlUHJvdmlkZXInXTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBjYXRlZ29yeVJlc29sdmVyLiRpbmplY3QgPSBbJyRzdGF0ZVBhcmFtcycsICdhcnRpY2xlU2VydmljZSddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICRzdGF0ZVByb3ZpZGVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29uZmlnKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC5jYXRlZ29yeScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvY2F0ZWdvcnkvOmNhdGVnb3J5U2x1ZycsXG4gICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgJ2hlYWQnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9jYXRlZ29yeS9oZWFkLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0NhdGVnb3J5SGVhZENvbnRyb2xsZXIgYXMgdm0nXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdoZWFkZXInOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9jYXRlZ29yeS9oZWFkZXIuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQ2F0ZWdvcnlIZWFkZXJDb250cm9sbGVyIGFzIHZtJ1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnd2lkZS1jb250ZW50Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvY2F0ZWdvcnkvY29udGVudC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDYXRlZ29yeUNvbnRlbnRDb250cm9sbGVyIGFzIHZtJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5UmVzb2x2ZXI6IGNhdGVnb3J5UmVzb2x2ZXJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYXRlZ29yeVJlc29sdmVyKCRzdGF0ZVBhcmFtcywgYXJ0aWNsZVNlcnZpY2UpIHtcbiAgICAgICAgcmV0dXJuIGFydGljbGVTZXJ2aWNlLmdldEFsbEZvckNhdGVnb3J5KCRzdGF0ZVBhcmFtcy5jYXRlZ29yeVNsdWcpO1xuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgncHJvZmlsZScsIFtdKVxuICAgICAgICAuY29uZmlnKGNvbmZpZyk7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgY29uZmlnLiRpbmplY3QgPSBbJyRzdGF0ZVByb3ZpZGVyJ107XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgcHJvZmlsZVJlc29sdmVyLiRpbmplY3QgPSBbJyRzdGF0ZVBhcmFtcycsICdwcm9maWxlU2VydmljZSddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICRzdGF0ZVByb3ZpZGVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29uZmlnKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC5wcm9maWxlJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9AOnVzZXJuYW1lJyxcbiAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAnaGVhZCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3Byb2ZpbGUvaGVhZC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlSGVhZENvbnRyb2xsZXIgYXMgdm0nXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdoZWFkZXInOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9wcm9maWxlL2hlYWRlci5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlSGVhZGVyQ29udHJvbGxlciBhcyB2bSdcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ3dpZGUtY29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3Byb2ZpbGUvY29udGVudC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ29udGVudENvbnRyb2xsZXIgYXMgdm0nXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgcHJvZmlsZVJlc29sdmVyOiBwcm9maWxlUmVzb2x2ZXJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gJHN0YXRlUGFyYW1zXG4gICAgICogQHBhcmFtIHByb2ZpbGVTZXJ2aWNlXG4gICAgICogQHJldHVybnMgeyp9XG4gICAgICovXG4gICAgZnVuY3Rpb24gcHJvZmlsZVJlc29sdmVyKCRzdGF0ZVBhcmFtcywgcHJvZmlsZVNlcnZpY2UpIHtcbiAgICAgICAgcmV0dXJuIHByb2ZpbGVTZXJ2aWNlLmdldFVzZXIoJHN0YXRlUGFyYW1zLnVzZXJuYW1lKTtcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ21lJywgWydzdG9yaWVzJywgJ3NldHRpbmdzJ10pXHJcbiAgICAgICAgLmNvbmZpZyhjb25maWcpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxyXG4gICAgICovXHJcbiAgICBjb25maWcuJGluamVjdCA9IFsnJHN0YXRlUHJvdmlkZXInXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSAkc3RhdGVQcm92aWRlclxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjb25maWcoJHN0YXRlUHJvdmlkZXIpIHtcclxuICAgICAgICAkc3RhdGVQcm92aWRlclxyXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC5tZScsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9tZScsXHJcbiAgICAgICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBwZXJtaXNzaW9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbmx5OiBbJ2lzQXV0aGVudGljYXRlZCddLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdFRvOiAnYXBwLmhvbWUnXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2hvbWUnLCBbXSlcbiAgICAgICAgLmNvbmZpZyhjb25maWcpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIGNvbmZpZy4kaW5qZWN0ID0gWyckc3RhdGVQcm92aWRlciddO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIGFydGljbGVzUmVzb2x2ZXIuJGluamVjdCA9IFsnYXJ0aWNsZVNlcnZpY2UnXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkc3RhdGVQcm92aWRlclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbmZpZygkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdhcHAuaG9tZScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAnaGVhZCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2hvbWUvaGVhZC5odG1sJ1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnaGVhZGVyJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvaG9tZS9oZWFkZXIuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUhlYWRlckNvbnRyb2xsZXIgYXMgdm0nXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdjb250ZW50Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvaG9tZS9jb250ZW50Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDb250ZW50Q29udHJvbGxlciBhcyB2bSdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgICAgICBhcnRpY2xlc1Jlc29sdmVyOiBhcnRpY2xlc1Jlc29sdmVyXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIGFydGljbGVTZXJ2aWNlXG4gICAgICogQHJldHVybnMgeyp9XG4gICAgICovXG4gICAgZnVuY3Rpb24gYXJ0aWNsZXNSZXNvbHZlcihhcnRpY2xlU2VydmljZSkge1xuICAgICAgICByZXR1cm4gYXJ0aWNsZVNlcnZpY2UuZ2V0KCk7XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdzZWFyY2gnLCBbXSlcbiAgICAgICAgLmNvbmZpZyhjb25maWcpXG4gICAgICAgIC5ydW4ocnVuKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBjb25maWcuJGluamVjdCA9IFsnJHN0YXRlUHJvdmlkZXInXTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBydW4uJGluamVjdCA9IFsnJHJvb3RTY29wZScsICckc3RhdGUnXTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBzZWFyY2hSZXNvbHZlci4kaW5qZWN0ID0gWyckc3RhdGVQYXJhbXMnLCAnc2VhcmNoU2VydmljZSddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICRzdGF0ZVByb3ZpZGVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29uZmlnKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC5zZWFyY2gnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3NlYXJjaD9xJyxcbiAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAnc2VhcmNoLWhlYWRlcic6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3NlYXJjaC9oZWFkZXIuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnU2VhcmNoSGVhZGVyQ29udHJvbGxlciBhcyB2bSdcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ3dpZGUtY29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3NlYXJjaC9jb250ZW50Lmh0bWwnXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdhcHAuc2VhcmNoLnJlc3VsdHMnLCB7XG4gICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgJ3Jlc3VsdHNAYXBwLnNlYXJjaCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3NlYXJjaC9yZXN1bHRzLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1NlYXJjaFJlc3VsdHNDb250cm9sbGVyIGFzIHZtJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaFJlc29sdmVyOiBzZWFyY2hSZXNvbHZlclxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkcm9vdFNjb3BlXG4gICAgICogQHBhcmFtICRzdGF0ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJ1bigkcm9vdFNjb3BlLCAkc3RhdGUpIHtcbiAgICAgICAgLy8gSWYgJy9zZWFyY2gnIGlzIGxvYWRlZCB2aWEgcmVmcmVzaCBvciBkaXJlY3QgYWNjZXNzIGZyb20gYWRkcmVzcyBiYXIgYW5kXG4gICAgICAgIC8vIGl0IGNvbnRhaW5zIGEgcXVlcnkgc3RyaW5nLCBnbyB0byB0aGUgcmVzdWx0cyBzdGF0ZSB3aXRoIHRoZSBxdWVyeSBzdHJpbmcuXG4gICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcykge1xuICAgICAgICAgICAgaWYgKHRvU3RhdGUubmFtZSA9PSAnYXBwLnNlYXJjaCcgJiYgdG9QYXJhbXMucSkge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2FwcC5zZWFyY2gucmVzdWx0cycsIHtcbiAgICAgICAgICAgICAgICAgICAgcTogdG9QYXJhbXMucVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gJHN0YXRlUGFyYW1zXG4gICAgICogQHBhcmFtIHNlYXJjaFNlcnZpY2VcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZXwqfHtzcmN9fHtvcHRpb25zfX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzZWFyY2hSZXNvbHZlcigkc3RhdGVQYXJhbXMsIHNlYXJjaFNlcnZpY2UpIHtcbiAgICAgICAgcmV0dXJuIHNlYXJjaFNlcnZpY2UuYWxsKCRzdGF0ZVBhcmFtcy5xKTtcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgndWknLCBbXG4gICAgICAgICd1aS5mb3JtLWdyb3VwLWl0ZW0nLFxuICAgICAgICAndWkuZm9jdXMnLFxuICAgICAgICAndWkuYWZmaXgnLFxuICAgICAgICAndWkuaGVhZGluZycsXG4gICAgICAgICd1aS5tb2RhbCcsXG4gICAgICAgICd1aS5zY3JvbGwtdG8tdG9wLXdoZW4nLFxuICAgICAgICAndWkudG9nZ2xlLWFjdGl2ZScsXG4gICAgICAgICd1aS53aWRnZXQnLFxuICAgICAgICAndWkucHJvZmlsZS1jYXJkJyxcbiAgICAgICAgJ3VpLnN1YnZpZXctbWVudScsXG4gICAgICAgICd1aS5uYXZiYXInLFxuICAgICAgICAndWkuaGVhZGVyLWNhbm9weScsXG4gICAgICAgICd1aS5hbGVydCcsXG4gICAgICAgICd1aS5tZXNzYWdlJyxcbiAgICAgICAgJ3VpLndoZW4tc2Nyb2xsZWQnXG4gICAgXSk7XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdzdG9yaWVzJywgW10pXHJcbiAgICAgICAgLmNvbmZpZyhjb25maWcpXHJcbiAgICAgICAgLnJ1bihydW4pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxyXG4gICAgICovXHJcbiAgICBjb25maWcuJGluamVjdCA9IFsnJHN0YXRlUHJvdmlkZXInXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cclxuICAgICAqL1xyXG4gICAgcnVuLiRpbmplY3QgPSBbJ3JlZGlyZWN0U2VydmljZSddO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxyXG4gICAgICovXHJcbiAgICBkcmFmdHNSZXNvbHZlci4kaW5qZWN0ID0gWydhcnRpY2xlU2VydmljZSddO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxyXG4gICAgICovXHJcbiAgICBwdWJsaXNoZWRSZXNvbHZlci4kaW5qZWN0ID0gWydhcnRpY2xlU2VydmljZSddO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxyXG4gICAgICovXHJcbiAgICB1bnB1Ymxpc2hlZFJlc29sdmVyLiRpbmplY3QgPSBbJ2FydGljbGVTZXJ2aWNlJ107XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gJHN0YXRlUHJvdmlkZXJcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gY29uZmlnKCRzdGF0ZVByb3ZpZGVyKSB7XHJcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcclxuICAgICAgICAgICAgLnN0YXRlKCdhcHAubWUuc3RvcmllcycsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9zdG9yaWVzJyxcclxuICAgICAgICAgICAgICAgIHZpZXdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ2hlYWRAYXBwJzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9tZS9zdG9yaWVzL2hlYWQuaHRtbCdcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICd3aWRlLWNvbnRlbnRAYXBwJzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9tZS9zdG9yaWVzL3N0b3JpZXMuaHRtbCdcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDogJ2FwcC5tZS5zdG9yaWVzLmRyYWZ0cycsXHJcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgICAgICBtZW51OiAnc3RvcmllcydcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdhcHAubWUuc3Rvcmllcy5kcmFmdHMnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvZHJhZnRzJyxcclxuICAgICAgICAgICAgICAgIHZpZXdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ0BhcHAubWUuc3Rvcmllcyc6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbWUvc3Rvcmllcy9kcmFmdHMvZHJhZnRzLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRHJhZnRzQ29udHJvbGxlciBhcyB2bSdcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGRyYWZ0c1Jlc29sdmVyOiBkcmFmdHNSZXNvbHZlclxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC5tZS5zdG9yaWVzLnB1Ymxpc2hlZCcsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9wdWJsaXNoZWQnLFxyXG4gICAgICAgICAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICAgICAgICAgICAnQGFwcC5tZS5zdG9yaWVzJzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9tZS9zdG9yaWVzL3B1Ymxpc2hlZC9wdWJsaXNoZWQuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQdWJsaXNoZWRDb250cm9sbGVyIGFzIHZtJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHVibGlzaGVkUmVzb2x2ZXI6IHB1Ymxpc2hlZFJlc29sdmVyXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnYXBwLm1lLnN0b3JpZXMudW5wdWJsaXNoZWQnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvdW5wdWJsaXNoZWQnLFxyXG4gICAgICAgICAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICAgICAgICAgICAnQGFwcC5tZS5zdG9yaWVzJzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9tZS9zdG9yaWVzL3VucHVibGlzaGVkL3VucHVibGlzaGVkLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVW5wdWJsaXNoZWRDb250cm9sbGVyIGFzIHZtJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdW5wdWJsaXNoZWRSZXNvbHZlcjogdW5wdWJsaXNoZWRSZXNvbHZlclxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSByZWRpcmVjdFNlcnZpY2VcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gcnVuKHJlZGlyZWN0U2VydmljZSkge1xyXG4gICAgICAgIHJlZGlyZWN0U2VydmljZS5nb0RlZmF1bHRDaGlsZFN0YXRlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gYXJ0aWNsZVNlcnZpY2VcclxuICAgICAqIEByZXR1cm5zIHsqfVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBkcmFmdHNSZXNvbHZlcihhcnRpY2xlU2VydmljZSkge1xyXG4gICAgICAgIHJldHVybiBhcnRpY2xlU2VydmljZS5nZXRVc2VyRHJhZnRzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gYXJ0aWNsZVNlcnZpY2VcclxuICAgICAqIEByZXR1cm5zIHsqfVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBwdWJsaXNoZWRSZXNvbHZlcihhcnRpY2xlU2VydmljZSkge1xyXG4gICAgICAgIHJldHVybiBhcnRpY2xlU2VydmljZS5nZXRVc2VyUHVibGlzaGVkKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gYXJ0aWNsZVNlcnZpY2VcclxuICAgICAqIEByZXR1cm5zIHsqfVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiB1bnB1Ymxpc2hlZFJlc29sdmVyKGFydGljbGVTZXJ2aWNlKSB7XHJcbiAgICAgICAgcmV0dXJuIGFydGljbGVTZXJ2aWNlLmdldFVzZXJVbnB1Ymxpc2hlZCgpO1xyXG4gICAgfVxyXG5cclxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnc2V0dGluZ3MnLCBbXSlcbiAgICAgICAgLmNvbmZpZyhjb25maWcpXG4gICAgICAgIC5ydW4ocnVuKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBjb25maWcuJGluamVjdCA9IFsnJHN0YXRlUHJvdmlkZXInXTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBydW4uJGluamVjdCA9IFsncmVkaXJlY3RTZXJ2aWNlJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gJHN0YXRlUHJvdmlkZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb25maWcoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnYXBwLm1lLnNldHRpbmdzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9zZXR0aW5ncycsXG4gICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgJ2hlYWRAYXBwJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbWUvc2V0dGluZ3MvaGVhZC5odG1sJ1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnd2lkZS1jb250ZW50QGFwcCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL21lL3NldHRpbmdzL3NldHRpbmdzLmh0bWwnXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6ICdhcHAubWUuc2V0dGluZ3MuYWNjb3VudCcsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIG1lbnU6ICdzZXR0aW5ncydcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdhcHAubWUuc2V0dGluZ3MuYWNjb3VudCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvYWNjb3VudCcsXG4gICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0BhcHAubWUuc2V0dGluZ3MnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9tZS9zZXR0aW5ncy9hY2NvdW50L2FjY291bnQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnU2V0dGluZ3NBY2NvdW50Q29udHJvbGxlciBhcyB2bSdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC5tZS5zZXR0aW5ncy5wYXNzd29yZCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvcGFzc3dvcmQnLFxuICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICdAYXBwLm1lLnNldHRpbmdzJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbWUvc2V0dGluZ3MvcGFzc3dvcmQvcGFzc3dvcmQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnU2V0dGluZ3NQYXNzd29yZENvbnRyb2xsZXIgYXMgdm0nXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gcmVkaXJlY3RTZXJ2aWNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gcnVuKHJlZGlyZWN0U2VydmljZSkge1xuICAgICAgICByZWRpcmVjdFNlcnZpY2UuZ29EZWZhdWx0Q2hpbGRTdGF0ZSgpO1xuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnY29uZmlnJywgW10pXG4gICAgICAgIC5jb25maWcoY29uZmlnKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBjb25maWcuJGluamVjdCA9IFsndG9vbHRpcHNDb25mUHJvdmlkZXInLCAnY2ZwTG9hZGluZ0JhclByb3ZpZGVyJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gdG9vbHRpcHNDb25mUHJvdmlkZXJcbiAgICAgKiBAcGFyYW0gY2ZwTG9hZGluZ0JhclByb3ZpZGVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29uZmlnKHRvb2x0aXBzQ29uZlByb3ZpZGVyLCBjZnBMb2FkaW5nQmFyUHJvdmlkZXIpIHtcbiAgICAgICAgdG9vbHRpcHNDb25mUHJvdmlkZXIuY29uZmlndXJlKHtcbiAgICAgICAgICAgICdzbWFydCc6IHRydWUsXG4gICAgICAgICAgICAndG9vbHRpcC1oaWRlLXRyaWdnZXInOiAnbW91c2VsZWF2ZScsXG4gICAgICAgICAgICAnc3BlZWQnOiAnZmFzdCdcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2ZwTG9hZGluZ0JhclByb3ZpZGVyLmluY2x1ZGVTcGlubmVyID0gZmFsc2U7XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhY2Nlc3MtY29udHJvbCcsIFtdKVxuICAgICAgICAucnVuKHJ1bik7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgcnVuLiRpbmplY3QgPSBbJyRhdXRoJywgJyRxJywgJ2F1dGhTZXJ2aWNlJywgJ1Blcm1pc3Npb25TdG9yZScsICdSb2xlU3RvcmUnLCAnYXJ0aWNsZVNlcnZpY2UnXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkYXV0aFxuICAgICAqIEBwYXJhbSAkcVxuICAgICAqIEBwYXJhbSBhdXRoU2VydmljZVxuICAgICAqIEBwYXJhbSBQZXJtaXNzaW9uU3RvcmVcbiAgICAgKiBAcGFyYW0gUm9sZVN0b3JlXG4gICAgICogQHBhcmFtIGFydGljbGVTZXJ2aWNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gcnVuKCRhdXRoLCAkcSwgYXV0aFNlcnZpY2UsIFBlcm1pc3Npb25TdG9yZSwgUm9sZVN0b3JlLCBhcnRpY2xlU2VydmljZSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogU2V0IHBlcm1pc3Npb25zLlxuICAgICAgICAgKi9cbiAgICAgICAgaW5pdGlhbGl6ZVBlcm1pc3Npb25zKCk7XG4gICAgICAgIGluaXRpYWxpemVSb2xlcygpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZWZpbmUgYWxsIHBlcm1pc3Npb25zIGZvciBhcHAuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplUGVybWlzc2lvbnMoKSB7XG4gICAgICAgICAgICBQZXJtaXNzaW9uU3RvcmUuZGVmaW5lUGVybWlzc2lvbignaXNBbm9ueW1vdXMnLCBpc0Fub255bW91cyk7XG4gICAgICAgICAgICBQZXJtaXNzaW9uU3RvcmUuZGVmaW5lUGVybWlzc2lvbignaXNBdXRoZW50aWNhdGVkJywgaXNBdXRoZW50aWNhdGVkKTtcbiAgICAgICAgICAgIFBlcm1pc3Npb25TdG9yZS5kZWZpbmVQZXJtaXNzaW9uKCdpc1Rva2VuVmFsaWQnLCBpc1Rva2VuVmFsaWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERlZmluZSBhbGwgcm9sZXMgZm9yIHRoZSBhcHAuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplUm9sZXMoKSB7XG4gICAgICAgICAgICBSb2xlU3RvcmUuZGVmaW5lUm9sZSgnaXNFZGl0YWJsZUJ5VXNlcicsIFtdLCBpc0VkaXRhYmxlQnlVc2VyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDaGVjayBpZiB1c2VyIGlzIGFub255bW91cy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBpc0Fub255bW91cygpIHtcbiAgICAgICAgICAgIHJldHVybiAhJGF1dGguaXNBdXRoZW50aWNhdGVkKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2hlY2sgaWYgdXNlciBpcyBhdXRoZW50aWNhdGVkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGlzQXV0aGVudGljYXRlZCgpIHtcbiAgICAgICAgICAgIHJldHVybiAkYXV0aC5pc0F1dGhlbnRpY2F0ZWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBWZXJpZnkgdG9rZW4gaW4gc2VydmVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gc3RhdGVQYXJhbXNcbiAgICAgICAgICogQHJldHVybnMgeyp9XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBpc1Rva2VuVmFsaWQoc3RhdGVQYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgIGF1dGhTZXJ2aWNlXG4gICAgICAgICAgICAgICAgLnZlcmlmeVRva2VuKHN0YXRlUGFyYW1zLnRva2VuKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCgpOyAvLyBFcnJvciB3aXRoIHJlcXVlc3RcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVmVyaWZ5IHRoZSBhdXRoZW50aWNhdGVkIHVzZXIgd2l0aCB0aGUgYXJ0aWNsZVxuICAgICAgICAgKiB0aGV5IGFyZSB0cnlpbmcgdG8gZWRpdC4gT25seSB0aGUgb3duZXIgY2FuIGFjY2Vzc1xuICAgICAgICAgKiB0aGUgZWRpdCBwYWdlIG9mIGEgZ2l2ZW4gYXJ0aWNsZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHN0YXRlUGFyYW1zXG4gICAgICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gaXNFZGl0YWJsZUJ5VXNlcihzdGF0ZVBhcmFtcykge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgYXJ0aWNsZVNlcnZpY2VcbiAgICAgICAgICAgICAgICAudmVyaWZ5RWRpdChzdGF0ZVBhcmFtcy5hcnRpY2xlU2x1ZylcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnZGlyZWN0aXZlcycsIFtdKTtcblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnZGlyZWN0aXZlcycpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3ZpZXdUaXRsZScsIHZpZXdUaXRsZSk7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgdmlld1RpdGxlLiRpbmplY3QgPSBbJyRyb290U2NvcGUnLCAnJHRpbWVvdXQnXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkcm9vdFNjb3BlXG4gICAgICogQHBhcmFtICR0aW1lb3V0XG4gICAgICogQHJldHVybnMge3tyZXN0cmljdDogc3RyaW5nLCBsaW5rOiBsaW5rfX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB2aWV3VGl0bGUoJHJvb3RTY29wZSwgJHRpbWVvdXQpIHtcbiAgICAgICAgdmFyIHRpdGxlLFxuICAgICAgICAgICAgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgICAgIGxpbms6IGxpbmtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgICAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtKSB7XG4gICAgICAgICAgICB2YXIgdGFnTmFtZSA9IGVsZW1bMF0udGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgICAgICAvLyBJZiB3ZSd2ZSBiZWVuIGluc2VydGVkIGFzIGFuIGVsZW1lbnQgdGhlbiB3ZSBkZXRhY2ggZnJvbSB0aGUgRE9NIGJlY2F1c2UgdGhlIGNhbGxlclxuICAgICAgICAgICAgLy8gZG9lc24ndCB3YW50IHVzIHRvIGhhdmUgYW55IHZpc3VhbCBpbXBhY3QgaW4gdGhlIGRvY3VtZW50LlxuICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSdyZSBwaWdneS1iYWNraW5nIG9uIGFuIGV4aXN0aW5nIGVsZW1lbnQgc28gd2UnbGwganVzdCBsZWF2ZSBpdCBhbG9uZS5cbiAgICAgICAgICAgIGlmICh0YWdOYW1lID09PSAndmlldy10aXRsZScgfHwgdGFnTmFtZSA9PT0gJ3ZpZXdUaXRsZScpXG4gICAgICAgICAgICAgICAgZWxlbS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgc2NvcGUuJHdhdGNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtLnRleHQoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChuZXdUaXRsZSkge1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUudmlld1RpdGxlID0gdGl0bGUgPSBuZXdUaXRsZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRpdGxlID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICAgICAgLy8gV2FpdCB1bnRpbCBuZXh0IGRpZ2VzdCBjeWNsZSBkbyBkZWxldGUgdmlld1RpdGxlXG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vIG90aGVyIHZpZXctdGl0bGUgaGFzIHJlYXNzaWduZWQgdGl0bGUuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgJHJvb3RTY29wZS52aWV3VGl0bGU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2ZpbHRlcnMnLCBbXSk7XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ3V0aWwnLCBbXSk7XHJcblxyXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3NlcnZpY2VzJywgW10pO1xuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7J3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCd1aS5hZmZpeCcsIFtdKTtcclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCd1aS5hbGVydCcsIFtdKTtcclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgndWkuZm9ybS1ncm91cC1pdGVtJywgW10pO1xuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgndWkuaGVhZGluZycsIFtdKTtcclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ3VpLmZvY3VzJywgW10pO1xyXG5cclxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCd1aS5oZWFkZXItY2Fub3B5JywgW10pO1xuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgndWkubW9kYWwnLCBbXSk7XHJcblxyXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCd1aS5tZXNzYWdlJywgW10pO1xyXG5cclxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCd1aS5wcm9maWxlLWNhcmQnLCBbXSk7XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgndWkubmF2YmFyJywgW10pO1xuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3VpLnN1YnZpZXctbWVudScsIFtdKTtcblxufSkoKTsiLCIoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ3VpLnNjcm9sbC10by10b3Atd2hlbicsIFtdKTtcclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgndWkud2lkZ2V0JywgW10pO1xuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgndWkudG9nZ2xlLWFjdGl2ZScsIFtdKTtcclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ3VpLndoZW4tc2Nyb2xsZWQnLCBbXSk7XHJcblxyXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXV0aCcpXG4gICAgICAgIC5mYWN0b3J5KCdhdXRoU2VydmljZScsIGF1dGhTZXJ2aWNlKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBhdXRoU2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsICckYXV0aCcsICckc3RhdGUnLCAnYXBpU2VydmljZScsICd1c2VyU2VydmljZScsICdjb25maWcnXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkaHR0cFxuICAgICAqIEBwYXJhbSAkYXV0aFxuICAgICAqIEBwYXJhbSAkc3RhdGVcbiAgICAgKiBAcGFyYW0gYXBpU2VydmljZVxuICAgICAqIEBwYXJhbSB1c2VyU2VydmljZVxuICAgICAqIEBwYXJhbSBjb25maWdcbiAgICAgKiBAcmV0dXJucyB7e3NpZ251cDogc2lnbnVwLCBsb2dpbjogbG9naW4sIGxvZ291dDogbG9nb3V0LCBzZW5kUmVzZXRMaW5rOiBzZW5kUmVzZXRMaW5rLCByZXNldFBhc3N3b3JkOiByZXNldFBhc3N3b3JkLCB2ZXJpZnlUb2tlbjogdmVyaWZ5VG9rZW59fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGF1dGhTZXJ2aWNlKCRodHRwLCAkYXV0aCwgJHN0YXRlLCBhcGlTZXJ2aWNlLCB1c2VyU2VydmljZSwgY29uZmlnKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgc2lnbnVwOiBzaWdudXAsXG4gICAgICAgICAgICBsb2dpbjogbG9naW4sXG4gICAgICAgICAgICBsb2dvdXQ6IGxvZ291dCxcbiAgICAgICAgICAgIHNlbmRSZXNldExpbms6IHNlbmRSZXNldExpbmssXG4gICAgICAgICAgICByZXNldFBhc3N3b3JkOiByZXNldFBhc3N3b3JkLFxuICAgICAgICAgICAgdmVyaWZ5VG9rZW46IHZlcmlmeVRva2VuXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgZnVuY3Rpb24gc2lnbnVwKGNyZWRlbnRpYWxzKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChjb25maWcudXJsICsgJy9zaWdudXAnLCBjcmVkZW50aWFscyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBsb2dpbihjcmVkZW50aWFscykge1xuICAgICAgICAgICAgcmV0dXJuICRhdXRoLmxvZ2luKGNyZWRlbnRpYWxzKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoY29uZmlnLnVybCArICcvYXV0aGVudGljYXRlL3VzZXInKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihhcGlTZXJ2aWNlLmhhbmRsZVN1Y2Nlc3MsIGFwaVNlcnZpY2UuaGFuZGxlRXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBsb2dvdXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChjb25maWcudXJsICsgJy9sb2dvdXQnKS50aGVuKGZ1bmN0aW9uICgpIHsgLy8gSW52YWxpZGF0ZSB0b2tlbiBpbiBzZXJ2ZXJcbiAgICAgICAgICAgICAgICByZXR1cm4gJGF1dGgubG9nb3V0KCkudGhlbihmdW5jdGlvbiAoKSB7IC8vIFJlbW92ZSB0b2tlbiBmcm9tIGxvY2FsIHN0b3JhZ2VcbiAgICAgICAgICAgICAgICAgICAgdXNlclNlcnZpY2UucmVtb3ZlVXNlcigpOyAvLyBSZW1vdmUgdXNlciBmcm9tIGxvY2FsIHN0b3JhZ2VcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdhcHAuaG9tZScpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZW5kUmVzZXRMaW5rKGVtYWlsKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChjb25maWcudXJsICsgJy9yZXNldCcsIGVtYWlsKVxuICAgICAgICAgICAgICAgIC50aGVuKGFwaVNlcnZpY2UuaGFuZGxlU3VjY2VzcywgYXBpU2VydmljZS5oYW5kbGVFcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZXNldFBhc3N3b3JkKHRva2VuLCBjcmVkZW50aWFscykge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoY29uZmlnLnVybCArICcvcmVzZXQvJyArIHRva2VuLCBjcmVkZW50aWFscylcbiAgICAgICAgICAgICAgICAudGhlbihhcGlTZXJ2aWNlLmhhbmRsZVN1Y2Nlc3MsIGFwaVNlcnZpY2UuaGFuZGxlRXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdmVyaWZ5VG9rZW4odG9rZW4pIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoY29uZmlnLnVybCArICcvcmVzZXQvdmVyaWZ5LycgKyB0b2tlbik7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJzQwNCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdOb3RGb3VuZENvbnRyb2xsZXInLCBOb3RGb3VuZENvbnRyb2xsZXIpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIE5vdEZvdW5kQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc3RhdGVQYXJhbXMnLCAnJHN0YXRlJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gJHN0YXRlUGFyYW1zXG4gICAgICogQHBhcmFtICRzdGF0ZVxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIE5vdEZvdW5kQ29udHJvbGxlcigkc3RhdGVQYXJhbXMsICRzdGF0ZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5tZXNzYWdlID0gJHN0YXRlUGFyYW1zLm1lc3NhZ2U7XG4gICAgICAgIHZtLnNlYXJjaCA9IHNlYXJjaDtcbiAgICAgICAgdm0ucSA9ICcnO1xuXG4gICAgICAgIGZ1bmN0aW9uIHNlYXJjaCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnYXBwLnNlYXJjaC5yZXN1bHRzJywge3E6IHZtLnF9KTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXJ0aWNsZXMnKVxuICAgICAgICAuZGlyZWN0aXZlKCdhcnRpY2xlcycsIGFydGljbGVzKTtcblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgc2NvcGU6IHt9LCB0ZW1wbGF0ZVVybDogc3RyaW5nLCBsaW5rOiBsaW5rfX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhcnRpY2xlcygpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQUUnLFxuICAgICAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvYXJ0aWNsZXMvYXJ0aWNsZXMuaHRtbCcsXG4gICAgICAgICAgICBsaW5rOiBsaW5rXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgICAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtLCBhdHRycykge1xuICAgICAgICAgICAgLy8gU2V0IHRoZSBmaXJzdCBpbnRlcnZhbCBvZiBzdG9yaWVzIGxvYWRlZCBmcm9tIHJlc29sdmVyXG4gICAgICAgICAgICBzY29wZS5hcnRpY2xlcyA9IHNjb3BlLiRldmFsKGF0dHJzLmRhdGEpIHx8IG51bGw7XG5cbiAgICAgICAgICAgIHNjb3BlLiRvbignc3Rvcmllczpsb2FkZWQnLCBmdW5jdGlvbihldmVudCwgc3Rvcmllcykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3Rvcmllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS5hcnRpY2xlcy5wdXNoKHN0b3JpZXNbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcnRpY2xlcycpXG4gICAgICAgIC5mYWN0b3J5KCdhcnRpY2xlU2VydmljZScsIGFydGljbGVTZXJ2aWNlKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBhcnRpY2xlU2VydmljZS4kaW5qZWN0ID0gWyckcm9vdFNjb3BlJywgJyRodHRwJywgJ2NvbmZpZycsICdhcGlTZXJ2aWNlJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gJHJvb3RTY29wZVxuICAgICAqIEBwYXJhbSAkaHR0cFxuICAgICAqIEBwYXJhbSBjb25maWdcbiAgICAgKiBAcGFyYW0gYXBpU2VydmljZVxuICAgICAqIEByZXR1cm5zIHt7bG9hZFN0b3JpZXM6IGxvYWRTdG9yaWVzLCBnZXQ6IGdldCwgZ2V0VG9wU3RvcmllczogZ2V0VG9wU3RvcmllcywgZ2V0QWxsRm9yQ2F0ZWdvcnk6IGdldEFsbEZvckNhdGVnb3J5LCBnZXRVc2VyRHJhZnRzOiBnZXRVc2VyRHJhZnRzLCBnZXRVc2VyUHVibGlzaGVkOiBnZXRVc2VyUHVibGlzaGVkLCBnZXRVc2VyVW5wdWJsaXNoZWQ6IGdldFVzZXJVbnB1Ymxpc2hlZCwgZ2V0UHVibGljOiBnZXRQdWJsaWMsIGdldERyYWZ0OiBnZXREcmFmdCwgY3JlYXRlUHVibGljOiBjcmVhdGVQdWJsaWMsIHNhdmVEcmFmdDogc2F2ZURyYWZ0LCBlZGl0OiBlZGl0LCB2ZXJpZnlFZGl0OiB2ZXJpZnlFZGl0LCBwdWJsaXNoOiBwdWJsaXNoLCB1bnB1Ymxpc2g6IHVucHVibGlzaCwgZm9yY2VEZWxldGU6IGZvcmNlRGVsZXRlLCBoZWFydDogaGVhcnQsIHVuaGVhcnQ6IHVuaGVhcnR9fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFydGljbGVTZXJ2aWNlKCRyb290U2NvcGUsICRodHRwLCBjb25maWcsIGFwaVNlcnZpY2UpIHtcbiAgICAgICAgdmFyIGxvYWRTdG9yaWVzVXJsID0gJy9hcnRpY2xlcz9wYWdlPTInLFxuICAgICAgICAgICAgaGFzTW9yZVN0b3JpZXNUb0xvYWQgPSB0cnVlLFxuICAgICAgICAgICAgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGxvYWRTdG9yaWVzOiBsb2FkU3RvcmllcyxcbiAgICAgICAgICAgIGdldDogZ2V0LFxuICAgICAgICAgICAgZ2V0VG9wU3RvcmllczogZ2V0VG9wU3RvcmllcyxcbiAgICAgICAgICAgIGdldEFsbEZvckNhdGVnb3J5OiBnZXRBbGxGb3JDYXRlZ29yeSxcbiAgICAgICAgICAgIGdldFVzZXJEcmFmdHM6IGdldFVzZXJEcmFmdHMsXG4gICAgICAgICAgICBnZXRVc2VyUHVibGlzaGVkOiBnZXRVc2VyUHVibGlzaGVkLFxuICAgICAgICAgICAgZ2V0VXNlclVucHVibGlzaGVkOiBnZXRVc2VyVW5wdWJsaXNoZWQsXG4gICAgICAgICAgICBnZXRQdWJsaWM6IGdldFB1YmxpYyxcbiAgICAgICAgICAgIGdldERyYWZ0OiBnZXREcmFmdCxcbiAgICAgICAgICAgIGNyZWF0ZVB1YmxpYzogY3JlYXRlUHVibGljLFxuICAgICAgICAgICAgc2F2ZURyYWZ0OiBzYXZlRHJhZnQsXG4gICAgICAgICAgICBlZGl0OiBlZGl0LFxuICAgICAgICAgICAgdmVyaWZ5RWRpdDogdmVyaWZ5RWRpdCxcbiAgICAgICAgICAgIHB1Ymxpc2g6IHB1Ymxpc2gsXG4gICAgICAgICAgICB1bnB1Ymxpc2g6IHVucHVibGlzaCxcbiAgICAgICAgICAgIGZvcmNlRGVsZXRlOiBmb3JjZURlbGV0ZSxcbiAgICAgICAgICAgIGhlYXJ0OiBoZWFydCxcbiAgICAgICAgICAgIHVuaGVhcnQ6IHVuaGVhcnRcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICBmdW5jdGlvbiBsb2FkU3RvcmllcygpIHtcbiAgICAgICAgICAgIGlmIChoYXNNb3JlU3Rvcmllc1RvTG9hZCkge1xuICAgICAgICAgICAgICAgIHNlcnZpY2VcbiAgICAgICAgICAgICAgICAgICAgLmdldChsb2FkU3Rvcmllc1VybClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5oYXNPd25Qcm9wZXJ0eSgnbWVzc2FnZScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzTW9yZVN0b3JpZXNUb0xvYWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFN0b3JpZXNVcmwgPSByZXMubmV4dFBhZ2VVcmw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdzdG9yaWVzOmxvYWRlZCcsIHJlcy5hcnRpY2xlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3IgbG9hZGluZyBtb3JlIHN0b3JpZXM6ICcsIHJlcyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0KHVybCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcudXJsICsgKHVybCB8fCAnL2FydGljbGVzJykpXG4gICAgICAgICAgICAgICAgLnRoZW4oYXBpU2VydmljZS5oYW5kbGVTdWNjZXNzLCBhcGlTZXJ2aWNlLmhhbmRsZUVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFRvcFN0b3JpZXMoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KGNvbmZpZy51cmwgKyAnL3RvcC1zdG9yaWVzJylcbiAgICAgICAgICAgICAgICAudGhlbihhcGlTZXJ2aWNlLmhhbmRsZVN1Y2Nlc3MsIGFwaVNlcnZpY2UuaGFuZGxlRXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0QWxsRm9yQ2F0ZWdvcnkoc2x1Zykge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcudXJsICsgJy9jYXRlZ29yeS8nICsgc2x1ZylcbiAgICAgICAgICAgICAgICAudGhlbihhcGlTZXJ2aWNlLmhhbmRsZVN1Y2Nlc3MsIGFwaVNlcnZpY2UuaGFuZGxlRXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0VXNlckRyYWZ0cygpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoY29uZmlnLnVybCArICcvYXJ0aWNsZXMvZHJhZnQnKVxuICAgICAgICAgICAgICAgIC50aGVuKGFwaVNlcnZpY2UuaGFuZGxlU3VjY2VzcywgYXBpU2VydmljZS5oYW5kbGVFcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRVc2VyUHVibGlzaGVkKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcudXJsICsgJy9hcnRpY2xlcy9wdWJsaXNoZWQnKVxuICAgICAgICAgICAgICAgIC50aGVuKGFwaVNlcnZpY2UuaGFuZGxlU3VjY2VzcywgYXBpU2VydmljZS5oYW5kbGVFcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRVc2VyVW5wdWJsaXNoZWQoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KGNvbmZpZy51cmwgKyAnL2FydGljbGVzL3VucHVibGlzaGVkJylcbiAgICAgICAgICAgICAgICAudGhlbihhcGlTZXJ2aWNlLmhhbmRsZVN1Y2Nlc3MsIGFwaVNlcnZpY2UuaGFuZGxlRXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0UHVibGljKHNsdWcpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoY29uZmlnLnVybCArICcvYXJ0aWNsZXMvJyArIHNsdWcpXG4gICAgICAgICAgICAgICAgLnRoZW4oYXBpU2VydmljZS5oYW5kbGVTdWNjZXNzLCBhcGlTZXJ2aWNlLmhhbmRsZUVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldERyYWZ0KHNsdWcpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoY29uZmlnLnVybCArICcvYXJ0aWNsZXMvJyArIHNsdWcgKyAnL2RyYWZ0JylcbiAgICAgICAgICAgICAgICAudGhlbihhcGlTZXJ2aWNlLmhhbmRsZVN1Y2Nlc3MsIGFwaVNlcnZpY2UuaGFuZGxlRXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlUHVibGljKGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KGNvbmZpZy51cmwgKyAnL2FydGljbGVzL2NyZWF0ZS9wdWJsaWMnLCBkYXRhKVxuICAgICAgICAgICAgICAgIC50aGVuKGFwaVNlcnZpY2UuaGFuZGxlU3VjY2VzcywgYXBpU2VydmljZS5oYW5kbGVFcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzYXZlRHJhZnQoZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dChjb25maWcudXJsICsgJy9hcnRpY2xlcy9zYXZlL2RyYWZ0JywgZGF0YSlcbiAgICAgICAgICAgICAgICAudGhlbihhcGlTZXJ2aWNlLmhhbmRsZVN1Y2Nlc3MsIGFwaVNlcnZpY2UuaGFuZGxlRXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZWRpdChkYXRhLCBzbHVnKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucHV0KGNvbmZpZy51cmwgKyAnL2FydGljbGVzLycgKyBzbHVnICsgJy9lZGl0JywgZGF0YSlcbiAgICAgICAgICAgICAgICAudGhlbihhcGlTZXJ2aWNlLmhhbmRsZVN1Y2Nlc3MsIGFwaVNlcnZpY2UuaGFuZGxlRXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdmVyaWZ5RWRpdChzbHVnKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChjb25maWcudXJsICsgJy9hcnRpY2xlcy8nICsgc2x1ZyArICcvZWRpdC92ZXJpZnknKVxuICAgICAgICAgICAgICAgIC50aGVuKGFwaVNlcnZpY2UuaGFuZGxlU3VjY2VzcywgYXBpU2VydmljZS5oYW5kbGVFcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBwdWJsaXNoKHNsdWcpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wdXQoY29uZmlnLnVybCArICcvYXJ0aWNsZXMvJyArIHNsdWcgKyAnL3B1Ymxpc2gnKVxuICAgICAgICAgICAgICAgIC50aGVuKGFwaVNlcnZpY2UuaGFuZGxlU3VjY2VzcywgYXBpU2VydmljZS5oYW5kbGVFcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1bnB1Ymxpc2goc2x1Zykge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dChjb25maWcudXJsICsgJy9hcnRpY2xlcy8nICsgc2x1ZyArICcvdW5wdWJsaXNoJylcbiAgICAgICAgICAgICAgICAudGhlbihhcGlTZXJ2aWNlLmhhbmRsZVN1Y2Nlc3MsIGFwaVNlcnZpY2UuaGFuZGxlRXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZm9yY2VEZWxldGUoc2x1Zykge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dChjb25maWcudXJsICsgJy9hcnRpY2xlcy8nICsgc2x1ZyArICcvZGVsZXRlJylcbiAgICAgICAgICAgICAgICAudGhlbihhcGlTZXJ2aWNlLmhhbmRsZVN1Y2Nlc3MsIGFwaVNlcnZpY2UuaGFuZGxlRXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaGVhcnQoaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wdXQoY29uZmlnLnVybCArICcvYXJ0aWNsZXMvaGVhcnQvJyArIGlkLCBudWxsLCB7aWdub3JlTG9hZGluZ0JhcjogdHJ1ZX0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdW5oZWFydChpZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dChjb25maWcudXJsICsgJy9hcnRpY2xlcy91bmhlYXJ0LycgKyBpZCwgbnVsbCwge2lnbm9yZUxvYWRpbmdCYXI6IHRydWV9KTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2NhdGVnb3J5JylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0NhdGVnb3J5Q29udGVudENvbnRyb2xsZXInLCBDYXRlZ29yeUNvbnRlbnRDb250cm9sbGVyKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBDYXRlZ29yeUNvbnRlbnRDb250cm9sbGVyLiRpbmplY3QgPSBbJ2NhdGVnb3J5UmVzb2x2ZXInXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSBjYXRlZ29yeVJlc29sdmVyXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgZnVuY3Rpb24gQ2F0ZWdvcnlDb250ZW50Q29udHJvbGxlcihjYXRlZ29yeVJlc29sdmVyKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmFydGljbGVzID0gY2F0ZWdvcnlSZXNvbHZlci5hcnRpY2xlcztcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdjYXRlZ29yeScpXG4gICAgICAgIC5jb250cm9sbGVyKCdDYXRlZ29yeUhlYWRDb250cm9sbGVyJywgQ2F0ZWdvcnlIZWFkQ29udHJvbGxlcik7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgQ2F0ZWdvcnlIZWFkQ29udHJvbGxlci4kaW5qZWN0ID0gWydjYXRlZ29yeVJlc29sdmVyJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gY2F0ZWdvcnlSZXNvbHZlclxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIENhdGVnb3J5SGVhZENvbnRyb2xsZXIoY2F0ZWdvcnlSZXNvbHZlcikge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5jYXRlZ29yeSA9IGNhdGVnb3J5UmVzb2x2ZXIuY2F0ZWdvcnk7XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdjYXRlZ29yeScpXG4gICAgICAgIC5jb250cm9sbGVyKCdDYXRlZ29yeUhlYWRlckNvbnRyb2xsZXInLCBDYXRlZ29yeUhlYWRlckNvbnRyb2xsZXIpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIENhdGVnb3J5SGVhZGVyQ29udHJvbGxlci4kaW5qZWN0ID0gWydjYXRlZ29yeVJlc29sdmVyJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gY2F0ZWdvcnlSZXNvbHZlclxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIENhdGVnb3J5SGVhZGVyQ29udHJvbGxlcihjYXRlZ29yeVJlc29sdmVyKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmNhdGVnb3J5ID0gY2F0ZWdvcnlSZXNvbHZlci5jYXRlZ29yeTtcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3Byb2ZpbGUnKVxuICAgICAgICAuY29udHJvbGxlcignUHJvZmlsZUNvbnRlbnRDb250cm9sbGVyJywgUHJvZmlsZUNvbnRlbnRDb250cm9sbGVyKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBQcm9maWxlQ29udGVudENvbnRyb2xsZXIuJGluamVjdCA9IFsncHJvZmlsZVJlc29sdmVyJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gcHJvZmlsZVJlc29sdmVyXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgZnVuY3Rpb24gUHJvZmlsZUNvbnRlbnRDb250cm9sbGVyKHByb2ZpbGVSZXNvbHZlcikge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5hcnRpY2xlcyA9IHByb2ZpbGVSZXNvbHZlci5hcnRpY2xlcztcbiAgICAgICAgdm0udXNlciA9IHByb2ZpbGVSZXNvbHZlci51c2VyO1xuICAgICAgICB2bS5oYXNDb250ZW50ID0gdm0uYXJ0aWNsZXMubGVuZ3RoID4gMDtcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdwcm9maWxlJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1Byb2ZpbGVIZWFkQ29udHJvbGxlcicsIFByb2ZpbGVIZWFkQ29udHJvbGxlcik7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgUHJvZmlsZUhlYWRDb250cm9sbGVyLiRpbmplY3QgPSBbJ3Byb2ZpbGVSZXNvbHZlciddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHByb2ZpbGVSZXNvbHZlclxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFByb2ZpbGVIZWFkQ29udHJvbGxlcihwcm9maWxlUmVzb2x2ZXIpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0udXNlciA9IHByb2ZpbGVSZXNvbHZlci51c2VyO1xuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3Byb2ZpbGUnKVxuICAgICAgICAuY29udHJvbGxlcignUHJvZmlsZUhlYWRlckNvbnRyb2xsZXInLCBQcm9maWxlSGVhZGVyQ29udHJvbGxlcik7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgUHJvZmlsZUhlYWRlckNvbnRyb2xsZXIuJGluamVjdCA9IFsncHJvZmlsZVJlc29sdmVyJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gcHJvZmlsZVJlc29sdmVyXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgZnVuY3Rpb24gUHJvZmlsZUhlYWRlckNvbnRyb2xsZXIocHJvZmlsZVJlc29sdmVyKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLnVzZXIgPSBwcm9maWxlUmVzb2x2ZXIudXNlcjtcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3Byb2ZpbGUnKVxuICAgICAgICAuZmFjdG9yeSgncHJvZmlsZVNlcnZpY2UnLCBwcm9maWxlU2VydmljZSk7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgcHJvZmlsZVNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCAnYXBpU2VydmljZScsICdjb25maWcnXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkaHR0cFxuICAgICAqIEBwYXJhbSBhcGlTZXJ2aWNlXG4gICAgICogQHBhcmFtIGNvbmZpZ1xuICAgICAqIEByZXR1cm5zIHt7Z2V0VXNlcjogZ2V0VXNlcn19XG4gICAgICovXG4gICAgZnVuY3Rpb24gcHJvZmlsZVNlcnZpY2UoJGh0dHAsIGFwaVNlcnZpY2UsIGNvbmZpZykge1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGdldFVzZXI6IGdldFVzZXJcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICBmdW5jdGlvbiBnZXRVc2VyKHVzZXJuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KGNvbmZpZy51cmwgKyAnL3Byb2ZpbGUvdXNlci8nICsgdXNlcm5hbWUpXG4gICAgICAgICAgICAgICAgLnRoZW4oYXBpU2VydmljZS5oYW5kbGVTdWNjZXNzLCBhcGlTZXJ2aWNlLmhhbmRsZUVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnaG9tZScpXG4gICAgICAgIC5jb250cm9sbGVyKCdIb21lQ29udGVudENvbnRyb2xsZXInLCBIb21lQ29udGVudENvbnRyb2xsZXIpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIEhvbWVDb250ZW50Q29udHJvbGxlci4kaW5qZWN0ID0gWydhcnRpY2xlc1Jlc29sdmVyJywgJ2FydGljbGVTZXJ2aWNlJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gYXJ0aWNsZXNSZXNvbHZlclxuICAgICAqIEBwYXJhbSBhcnRpY2xlU2VydmljZVxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEhvbWVDb250ZW50Q29udHJvbGxlcihhcnRpY2xlc1Jlc29sdmVyLCBhcnRpY2xlU2VydmljZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5hcnRpY2xlcyA9IGFydGljbGVzUmVzb2x2ZXIuYXJ0aWNsZXM7XG4gICAgICAgIHZtLnRvcEFydGljbGVzID0gW107XG4gICAgICAgIHZtLmNhdGVnb3JpZXMgPSBbXTtcbiAgICAgICAgdm0ubG9hZFN0b3JpZXMgPSBhcnRpY2xlU2VydmljZS5sb2FkU3RvcmllcztcblxuICAgICAgICBnZXRUb3BTdG9yaWVzKCk7XG4gICAgICAgIGFkZEZlYXR1cmVkQ2F0ZWdvcmllcygpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldFRvcFN0b3JpZXMoKSB7XG4gICAgICAgICAgICBhcnRpY2xlU2VydmljZVxuICAgICAgICAgICAgICAgIC5nZXRUb3BTdG9yaWVzKClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdm0udG9wQXJ0aWNsZXMgPSByZXMuYXJ0aWNsZXM7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBmZXRjaGluZyB0b3Agc3RvcmllczogJywgcmVzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGFkZEZlYXR1cmVkQ2F0ZWdvcmllcygpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0uYXJ0aWNsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHZtLmFydGljbGVzW2ldLmNhdGVnb3JpZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFhbHJlYWR5RXhpc3RzKHZtLmFydGljbGVzW2ldLmNhdGVnb3JpZXNbal0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2bS5jYXRlZ29yaWVzLnB1c2godm0uYXJ0aWNsZXNbaV0uY2F0ZWdvcmllc1tqXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBhbHJlYWR5RXhpc3RzKHZhbCkge1xuICAgICAgICAgICAgcmV0dXJuIHZtLmNhdGVnb3JpZXMuc29tZShmdW5jdGlvbiAoYXJyVmFsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5pcyhKU09OLnN0cmluZ2lmeSh2YWwpLCBKU09OLnN0cmluZ2lmeShhcnJWYWwpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpO1xuXG4iLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnaG9tZScpXG4gICAgICAgIC5jb250cm9sbGVyKCdIb21lSGVhZGVyQ29udHJvbGxlcicsIEhvbWVIZWFkZXJDb250cm9sbGVyKTtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEhvbWVIZWFkZXJDb250cm9sbGVyKCkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3NlYXJjaCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdTZWFyY2hIZWFkZXJDb250cm9sbGVyJywgU2VhcmNoSGVhZGVyQ29udHJvbGxlcik7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgU2VhcmNoSGVhZGVyQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc3RhdGUnXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkc3RhdGVcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBTZWFyY2hIZWFkZXJDb250cm9sbGVyKCRzdGF0ZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5zZWFyY2ggPSBzZWFyY2g7XG4gICAgICAgIHZtLnEgPSAnJztcblxuICAgICAgICBmdW5jdGlvbiBzZWFyY2goKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2FwcC5zZWFyY2gucmVzdWx0cycsIHtcbiAgICAgICAgICAgICAgICBxOiB2bS5xXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnc2VhcmNoJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1NlYXJjaFJlc3VsdHNDb250cm9sbGVyJywgU2VhcmNoUmVzdWx0c0NvbnRyb2xsZXIpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIFNlYXJjaFJlc3VsdHNDb250cm9sbGVyLiRpbmplY3QgPSBbJ3NlYXJjaFJlc29sdmVyJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gc2VhcmNoUmVzb2x2ZXJcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBTZWFyY2hSZXN1bHRzQ29udHJvbGxlcihzZWFyY2hSZXNvbHZlcikge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5hcnRpY2xlcyA9IHNlYXJjaFJlc29sdmVyLmFydGljbGVzO1xuICAgICAgICB2bS5jYXRlZ29yaWVzID0gc2VhcmNoUmVzb2x2ZXIuY2F0ZWdvcmllcztcbiAgICAgICAgdm0udXNlcnMgPSBzZWFyY2hSZXNvbHZlci51c2VycztcbiAgICAgICAgdm0ucmVzdWx0cyA9ICh2bS5hcnRpY2xlcy5sZW5ndGggPiAwIHx8IHZtLmNhdGVnb3JpZXMubGVuZ3RoID4gMCB8fCB2bS51c2Vycy5sZW5ndGggPiAwKTtcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3NlYXJjaCcpXG4gICAgICAgIC5mYWN0b3J5KCdzZWFyY2hTZXJ2aWNlJywgc2VhcmNoU2VydmljZSk7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgc2VhcmNoU2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsICdhcGlTZXJ2aWNlJywgJ2NvbmZpZyddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICRodHRwXG4gICAgICogQHBhcmFtIGFwaVNlcnZpY2VcbiAgICAgKiBAcGFyYW0gY29uZmlnXG4gICAgICogQHJldHVybnMge3thbGw6IGFsbCwgZmluZENhdGVnb3JpZXM6IGZpbmRDYXRlZ29yaWVzfX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzZWFyY2hTZXJ2aWNlKCRodHRwLCBhcGlTZXJ2aWNlLCBjb25maWcpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBhbGw6IGFsbCxcbiAgICAgICAgICAgIGZpbmRDYXRlZ29yaWVzOiBmaW5kQ2F0ZWdvcmllc1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGFsbChxKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KGNvbmZpZy51cmwgKyAnL3NlYXJjaD9xPScgKyBxKVxuICAgICAgICAgICAgICAgIC50aGVuKGFwaVNlcnZpY2UuaGFuZGxlU3VjY2VzcywgYXBpU2VydmljZS5oYW5kbGVFcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBmaW5kQ2F0ZWdvcmllcyhxKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KGNvbmZpZy51cmwgKyAnL3NlYXJjaC9jYXRlZ29yaWVzP3E9JyArIHEpXG4gICAgICAgICAgICAgICAgLnRoZW4oYXBpU2VydmljZS5oYW5kbGVTdWNjZXNzLCBhcGlTZXJ2aWNlLmhhbmRsZUVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXV0aCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdMb2dpbkNvbnRyb2xsZXInLCBMb2dpbkNvbnRyb2xsZXIpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIExvZ2luQ29udHJvbGxlci4kaW5qZWN0ID0gWyckcm9vdFNjb3BlJywgJyRzdGF0ZScsICd1c2VyU2VydmljZScsICdhdXRoU2VydmljZSddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICRyb290U2NvcGVcbiAgICAgKiBAcGFyYW0gJHN0YXRlXG4gICAgICogQHBhcmFtIHVzZXJTZXJ2aWNlXG4gICAgICogQHBhcmFtIGF1dGhTZXJ2aWNlXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgZnVuY3Rpb24gTG9naW5Db250cm9sbGVyKCRyb290U2NvcGUsICRzdGF0ZSwgdXNlclNlcnZpY2UsIGF1dGhTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmxvZ2luID0gbG9naW47XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIExvZyBpbiB3aXRoIGdpdmVuIGNyZWRlbnRpYWxzLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gY3JlZGVudGlhbHMge2VtYWlsLCBwYXNzd29yZH1cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGxvZ2luKGNyZWRlbnRpYWxzKSB7XG4gICAgICAgICAgICBhdXRoU2VydmljZVxuICAgICAgICAgICAgICAgIC5sb2dpbihjcmVkZW50aWFscylcbiAgICAgICAgICAgICAgICAudGhlbihzdWNjZXNzLCBlcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVXNlciBzdWNjZXNzZnVsbHkgbG9nZ2VkIGluIG9uIHNlcnZlcjsgc2V0IHVzZXIgYW5kIGdvXG4gICAgICAgICAqIHRvIGhvbWUgc3RhdGUuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSByZXNcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MocmVzKSB7XG4gICAgICAgICAgICB1c2VyU2VydmljZS5zZXRVc2VyKHJlcy51c2VyKTtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnYXBwLmhvbWUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVc2VyIG5vdCBsb2dnZWQgaW4gb24gc2VydmVyLiBFaXRoZXIgdmFsaWRhdGlvbiBlcnJvcnNcbiAgICAgICAgICogb2NjdXJyZWQsIG9yIHNvbWV0aGluZyB3ZW50IHdyb25nLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gcmVzXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBlcnJvcihyZXMpIHtcbiAgICAgICAgICAgIGlmIChyZXMuZGF0YSAmJiAhcmVzLmRhdGEuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB2bS5lcnJvcnMgPSByZXMuZGF0YTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh2bS5lcnJvcnMpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMuZGF0YS5lcnJvcikge1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnaW5wdXQ6ZXJyb3InLCB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5kYXRhLmVycm9yLm1lc3NhZ2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXV0aCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdQYXNzd29yZEZvcmdvdENvbnRyb2xsZXInLCBQYXNzd29yZEZvcmdvdENvbnRyb2xsZXIpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIFBhc3N3b3JkRm9yZ290Q29udHJvbGxlci4kaW5qZWN0ID0gWyckcm9vdFNjb3BlJywgJ2F1dGhTZXJ2aWNlJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gJHJvb3RTY29wZVxuICAgICAqIEBwYXJhbSBhdXRoU2VydmljZVxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFBhc3N3b3JkRm9yZ290Q29udHJvbGxlcigkcm9vdFNjb3BlLCBhdXRoU2VydmljZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5zZW5kUmVzZXRMaW5rID0gc2VuZFJlc2V0TGluaztcblxuICAgICAgICAvKipcbiAgICAgICAgICogU2VuZCBwYXNzd29yZCByZXNldCBsaW5rIHRvIHVzZXJzIGVtYWlsLlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2VuZFJlc2V0TGluaygpIHtcbiAgICAgICAgICAgIGF1dGhTZXJ2aWNlXG4gICAgICAgICAgICAgICAgLnNlbmRSZXNldExpbmsoe2VtYWlsOiB2bS5lbWFpbH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oc3VjY2VzcywgZXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFBhc3N3b3JkIHJlc2V0IGxpbmsgc3VjY2Vzc2Z1bGx5IHNlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSByZXNcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MocmVzKSB7XG4gICAgICAgICAgICB2bS5lcnJvcnMgPSBbXTtcblxuICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdpbnB1dDpzdWNjZXNzJywge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5tZXNzYWdlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFcnJvciBzZW5kaW5nIHBhc3N3b3JkIHJlc2V0IGxpbmsuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSByZXNcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yKHJlcykge1xuICAgICAgICAgICAgaWYgKHJlcy5kYXRhICYmICFyZXMuZGF0YS5lcnJvcikgeyAvLyBWYWxpZGF0aW9uIGVycm9yc1xuICAgICAgICAgICAgICAgIHZtLmVycm9ycyA9IHJlcy5kYXRhO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHZtLmVycm9yKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEuZXJyb3IpIHsgLy8gQ2FuJ3QgZmluZCBhY2NvdW50IHdpdGggZW1haWxcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2lucHV0OmVycm9yJywge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiByZXMuZGF0YS5lcnJvci5tZXNzYWdlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhdXRoJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1Bhc3N3b3JkUmVzZXRDb250cm9sbGVyJywgUGFzc3dvcmRSZXNldENvbnRyb2xsZXIpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIFBhc3N3b3JkUmVzZXRDb250cm9sbGVyLiRpbmplY3QgPSBbJyRyb290U2NvcGUnLCAnJHN0YXRlUGFyYW1zJywgJ2F1dGhTZXJ2aWNlJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gJHJvb3RTY29wZVxuICAgICAqIEBwYXJhbSAkc3RhdGVQYXJhbXNcbiAgICAgKiBAcGFyYW0gYXV0aFNlcnZpY2VcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBQYXNzd29yZFJlc2V0Q29udHJvbGxlcigkcm9vdFNjb3BlLCAkc3RhdGVQYXJhbXMsIGF1dGhTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLnJlc2V0UGFzc3dvcmQgPSByZXNldFBhc3N3b3JkO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXNldCB1c2VycyBwYXNzd29yZC5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0UGFzc3dvcmQoKSB7XG4gICAgICAgICAgICBhdXRoU2VydmljZVxuICAgICAgICAgICAgICAgIC5yZXNldFBhc3N3b3JkKCRzdGF0ZVBhcmFtcy50b2tlbiwge1xuICAgICAgICAgICAgICAgICAgICB0b2tlbjogJHN0YXRlUGFyYW1zLnRva2VuLFxuICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogdm0ucGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkQ29uZmlybWF0aW9uOiB2bS5wYXNzd29yZENvbmZpcm1hdGlvblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oc3VjY2VzcywgZXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFBhc3N3b3JkIHdhcyBzdWNjZXNzZnVsbHkgcmVzZXQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSByZXNcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MocmVzKSB7XG4gICAgICAgICAgICB2bS5lcnJvcnMgPSBbXTtcblxuICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdpbnB1dDpzdWNjZXNzJywge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5tZXNzYWdlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBQYXNzd29yZCBjb3VsZCBub3QgYmUgcmVzZXQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSByZXNcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yKHJlcykge1xuICAgICAgICAgICAgaWYgKHJlcy5kYXRhICYmICFyZXMuZGF0YS5lcnJvcikgeyAvLyBWYWxpZGF0aW9uIGVycm9yc1xuICAgICAgICAgICAgICAgIHZtLmVycm9ycyA9IHJlcy5kYXRhO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMuZGF0YS5wYXNzd29yZCkgeyAvLyBPdGhlciB2YWxpZGF0aW9uIGVycm9yc1xuICAgICAgICAgICAgICAgIHZtLmVycm9ycyA9IHJlcy5kYXRhLnBhc3N3b3JkO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHZtLmVycm9ycyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlcy5kYXRhLmVycm9yKSB7IC8vIE90aGVyIHNlcnZlciBlcnJvcnNcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2lucHV0OmVycm9yJywge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiByZXMuZGF0YS5lcnJvci5tZXNzYWdlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2F1dGgnKVxuICAgICAgICAuY29udHJvbGxlcignU2lnbnVwQ29udHJvbGxlcicsIFNpZ251cENvbnRyb2xsZXIpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIFNpZ251cENvbnRyb2xsZXIuJGluamVjdCA9IFsnJGNvbnRyb2xsZXInLCAnYXV0aFNlcnZpY2UnXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkY29udHJvbGxlclxuICAgICAqIEBwYXJhbSBhdXRoU2VydmljZVxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNpZ251cENvbnRyb2xsZXIoJGNvbnRyb2xsZXIsIGF1dGhTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLnNpZ251cCA9IHNpZ251cDtcblxuICAgICAgICBmdW5jdGlvbiBzaWdudXAoKSB7XG4gICAgICAgICAgICBhdXRoU2VydmljZVxuICAgICAgICAgICAgICAgIC5zaWdudXAoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiB2bS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBlbWFpbDogdm0uZW1haWwsXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB2bS5wYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmRDb25maXJtYXRpb246IHZtLnBhc3N3b3JkQ29uZmlybWF0aW9uXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudGhlbihzdWNjZXNzLCBlcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVXNlciBzdWNjZXNzZnVsbHkgcmVnaXN0ZXJlZCwgbm93IGxvZyBpbi5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MoKSB7XG4gICAgICAgICAgICAkY29udHJvbGxlcignTG9naW5Db250cm9sbGVyJylcbiAgICAgICAgICAgICAgICAubG9naW4oe1xuICAgICAgICAgICAgICAgICAgICBlbWFpbDogdm0uZW1haWwsXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB2bS5wYXNzd29yZFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEVycm9yIHJlZ2lzdGVyaW5nIHVzZXIuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSByZXNcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yKHJlcykge1xuICAgICAgICAgICAgaWYgKHJlcy5kYXRhICYmICFyZXMuZGF0YS5lcnJvcikgeyAvLyBWYWxpZGF0aW9uIGVycm9yc1xuICAgICAgICAgICAgICAgIHZtLmVycm9ycyA9IHJlcy5kYXRhO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHZtLmVycm9ycyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlcy5kYXRhLmVycm9yKSB7IC8vIE90aGVyIHNlcnZlciBlcnJvclxuICAgICAgICAgICAgICAgIHZtLmVycm9ycyA9IHJlcy5kYXRhLmVycm9yLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codm0uZXJyb3JzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndWknKVxuICAgICAgICAuZGlyZWN0aXZlKCdoZWFydHMnLCBoZWFydHMpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIGhlYXJ0cy4kaW5qZWN0ID0gWydhcnRpY2xlU2VydmljZSddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIGFydGljbGVTZXJ2aWNlXG4gICAgICogQHJldHVybnMge3tyZXN0cmljdDogc3RyaW5nLCBzY29wZToge30sIHRlbXBsYXRlVXJsOiBzdHJpbmcsIGxpbms6IGxpbmt9fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGhlYXJ0cyhhcnRpY2xlU2VydmljZSkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgICAgICAgICBzY29wZToge30sXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9hcnRpY2xlcy9oZWFydHMvaGVhcnRzLmh0bWwnLFxuICAgICAgICAgICAgbGluazogbGlua1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICAgICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbSwgYXR0cnMpIHtcbiAgICAgICAgICAgIHZhciBmbGFnID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgbGltaXQgPSAwO1xuXG4gICAgICAgICAgICBpZiAoYXR0cnMuY291bnQpIHtcbiAgICAgICAgICAgICAgICBzY29wZS5oZWFydENvdW50ID0gYXR0cnMuY291bnQ7XG4gICAgICAgICAgICAgICAgc2NvcGUuaGVhcnQgPSBoZWFydDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gaGVhcnQoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFmbGFnICYmIGxpbWl0IDwgNSlcbiAgICAgICAgICAgICAgICAgICAgYXJ0aWNsZVNlcnZpY2UuaGVhcnQoYXR0cnMuaWQpLnRoZW4oZG9IZWFydCk7XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZmxhZyAmJiBsaW1pdCA8IDUpXG4gICAgICAgICAgICAgICAgICAgIGFydGljbGVTZXJ2aWNlLnVuaGVhcnQoYXR0cnMuaWQpLnRoZW4odW5kb0hlYXJ0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZG9IZWFydCgpIHtcbiAgICAgICAgICAgICAgICBmbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBzY29wZS5oZWFydFN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNjb3BlLmhlYXJ0Q291bnQrKztcbiAgICAgICAgICAgICAgICBsaW1pdCsrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB1bmRvSGVhcnQoKSB7XG4gICAgICAgICAgICAgICAgZmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHNjb3BlLmhlYXJ0U3VjY2VzcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHNjb3BlLmhlYXJ0Q291bnQtLTtcbiAgICAgICAgICAgICAgICBsaW1pdCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcnRpY2xlcycpXG4gICAgICAgIC5kaXJlY3RpdmUoJ2NhdGVnb3JpZXMnLCBjYXRlZ29yaWVzKTtcblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgdGVtcGxhdGVVcmw6IHN0cmluZywgbGluazogbGlua319XG4gICAgICovXG4gICAgZnVuY3Rpb24gY2F0ZWdvcmllcygpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvYXJ0aWNsZXMvY2F0ZWdvcmllcy9jYXRlZ29yaWVzLmh0bWwnLFxuICAgICAgICAgICAgbGluazogbGlua1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICAgICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbSwgYXR0cnMpIHtcbiAgICAgICAgICAgIGlmIChhdHRycy5kYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBzY29wZS4kZXZhbChhdHRycy5kYXRhKTtcblxuICAgICAgICAgICAgICAgIHNjb3BlLmNhdGVnb3JpZXMgPSBkYXRhO1xuICAgICAgICAgICAgICAgIHNjb3BlLmludmVyc2UgPSBhdHRycy5pbnZlcnNlIHx8IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXJ0aWNsZXMnKVxuICAgICAgICAuY29udHJvbGxlcignQXJ0aWNsZUNvbnRyb2xsZXInLCBBcnRpY2xlQ29udHJvbGxlcik7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgQXJ0aWNsZUNvbnRyb2xsZXIuJGluamVjdCA9IFsnYXJ0aWNsZVJlc29sdmVyJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gYXJ0aWNsZVJlc29sdmVyXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgZnVuY3Rpb24gQXJ0aWNsZUNvbnRyb2xsZXIoYXJ0aWNsZVJlc29sdmVyKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmFydGljbGUgPSBhcnRpY2xlUmVzb2x2ZXIuYXJ0aWNsZTtcbiAgICAgICAgdm0uYXV0aG9yID0gYXJ0aWNsZVJlc29sdmVyLmF1dGhvcjtcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcnRpY2xlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdBcnRpY2xlSGVhZENvbnRyb2xsZXInLCBBcnRpY2xlSGVhZENvbnRyb2xsZXIpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIEFydGljbGVIZWFkQ29udHJvbGxlci4kaW5qZWN0ID0gWydhcnRpY2xlUmVzb2x2ZXInXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSBhcnRpY2xlUmVzb2x2ZXJcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBBcnRpY2xlSGVhZENvbnRyb2xsZXIoYXJ0aWNsZVJlc29sdmVyKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmFydGljbGUgPSBhcnRpY2xlUmVzb2x2ZXIuYXJ0aWNsZTtcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FydGljbGVzJylcclxuICAgICAgICAuZGlyZWN0aXZlKCdlZGl0b3InLCBlZGl0b3IpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxyXG4gICAgICovXHJcbiAgICBlZGl0b3IuJGluamVjdCA9IFsnJHJvb3RTY29wZSddO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtICRyb290U2NvcGVcclxuICAgICAqIEByZXR1cm5zIHt7cmVxdWlyZTogc3RyaW5nLCByZXN0cmljdDogc3RyaW5nLCBsaW5rOiBsaW5rfX1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZWRpdG9yKCRyb290U2NvcGUpIHtcclxuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xyXG4gICAgICAgICAgICByZXF1aXJlOiAnP25nTW9kZWwnLFxyXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgICAgICBsaW5rOiBsaW5rXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbSwgYXR0cnMsIG5nTW9kZWwpIHtcclxuICAgICAgICAgICAgdmFyIGNrID0gQ0tFRElUT1IucmVwbGFjZShlbGVtWzBdLCB7XHJcbiAgICAgICAgICAgICAgICBsYW5ndWFnZTogJ2VuJyxcclxuICAgICAgICAgICAgICAgIGV4dHJhUGx1Z2luczogJ2NvbmZpZ2hlbHBlcixhdXRvZ3JvdycsXHJcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogJ1NoYXJlIHlvdXIgc3RvcnkuLi4nXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFuZ01vZGVsKSB0aHJvdyAnbmctbW9kZWwgaXMgbWlzc2luZyEnO1xyXG5cclxuICAgICAgICAgICAgY2sub24oJ2luc3RhbmNlUmVhZHknLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNrLnNldERhdGEobmdNb2RlbC4kdmlld1ZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2VkaXRvcjpyZWFkeScpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNrLm9uKCdjaGFuZ2UnLCB1cGRhdGVNb2RlbCk7XHJcbiAgICAgICAgICAgIGNrLm9uKCdrZXknLCB1cGRhdGVNb2RlbCk7XHJcbiAgICAgICAgICAgIGNrLm9uKCdkYXRhUmVhZHknLCB1cGRhdGVNb2RlbCk7XHJcblxyXG4gICAgICAgICAgICBuZ01vZGVsLiRyZW5kZXIgPSBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgY2suc2V0RGF0YShuZ01vZGVsLiR2aWV3VmFsdWUpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlTW9kZWwoKSB7XHJcbiAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0Vmlld1ZhbHVlKGNrLmdldERhdGEoKSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcnRpY2xlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdXcml0ZU9yRWRpdENvbnRyb2xsZXInLCBXcml0ZU9yRWRpdENvbnRyb2xsZXIpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIFdyaXRlT3JFZGl0Q29udHJvbGxlci4kaW5qZWN0ID0gWyckd2luZG93JywgJyRyb290U2NvcGUnLCAnJHNjb3BlJywgJyRzdGF0ZVBhcmFtcycsICckc3RhdGUnLCAnJHRpbWVvdXQnLCAnd3JpdGVPckVkaXRSZXNvbHZlcicsICdhcnRpY2xlU2VydmljZScsICdzZWFyY2hTZXJ2aWNlJywgJ21vZGFsU2VydmljZSddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICR3aW5kb3dcbiAgICAgKiBAcGFyYW0gJHJvb3RTY29wZVxuICAgICAqIEBwYXJhbSAkc2NvcGVcbiAgICAgKiBAcGFyYW0gJHN0YXRlUGFyYW1zXG4gICAgICogQHBhcmFtICRzdGF0ZVxuICAgICAqIEBwYXJhbSAkdGltZW91dFxuICAgICAqIEBwYXJhbSB3cml0ZU9yRWRpdFJlc29sdmVyXG4gICAgICogQHBhcmFtIGFydGljbGVTZXJ2aWNlXG4gICAgICogQHBhcmFtIHNlYXJjaFNlcnZpY2VcbiAgICAgKiBAcGFyYW0gbW9kYWxTZXJ2aWNlXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgZnVuY3Rpb24gV3JpdGVPckVkaXRDb250cm9sbGVyKCR3aW5kb3csICRyb290U2NvcGUsICRzY29wZSwgJHN0YXRlUGFyYW1zLCAkc3RhdGUsICR0aW1lb3V0LCB3cml0ZU9yRWRpdFJlc29sdmVyLCBhcnRpY2xlU2VydmljZSwgc2VhcmNoU2VydmljZSwgbW9kYWxTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXMsXG4gICAgICAgICAgICBWTV9EQVRBID0geyAvLyBDb25zdGFudCByZXByZXNlbnRpbmcgdGhlIGluaXRpYWwgdW50b3VjaGVkIGVkaXRvciBkYXRhIChmb3IgY29tcGFyaXNvbiBwdXJwb3NlcylcbiAgICAgICAgICAgICAgICBpZDogJycsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICcnLFxuICAgICAgICAgICAgICAgIGJvZHk6ICcnLFxuICAgICAgICAgICAgICAgIGNhdGVnb3J5SWRMaXN0OiBbXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIEVESVRfTU9ERSA9IGZhbHNlLFxuICAgICAgICAgICAgV1JJVEVfTU9ERSA9IGZhbHNlO1xuICAgICAgICB2bS5xID0gJyc7XG4gICAgICAgIHZtLmNhdGVnb3JpZXNTZWxlY3RlZCA9IFtdOyAvLyBMaXN0IG9mIGNhdGVnb3JpZXMgc2VsZWN0ZWQgYnkgdXNlciwgb3IgcGFzc2VkIGluIGZyb20gZWRpdCBtb2RlXG4gICAgICAgIHZtLmNhdGVnb3JpZXNGcm9tU2VhcmNoID0gW107IC8vIExpc3Qgb2YgY2F0ZWdvcmllcyByZXR1cm5lZCBmcm9tIHNlcnZlciBkdXJpbmcgc2VhcmNoXG4gICAgICAgIHZtLmRhdGEgPSB7XG4gICAgICAgICAgICBpZDogJycsXG4gICAgICAgICAgICB0aXRsZTogJycsXG4gICAgICAgICAgICBib2R5OiAnJyxcbiAgICAgICAgICAgIGNhdGVnb3J5SWRMaXN0OiBbXSAvLyBMaXN0IG9mIGNhdGVnb3J5IElEJ3MgdG8gc2VuZCB0byBzZXJ2ZXIgb24gc3VibWl0XG4gICAgICAgIH07XG4gICAgICAgIHZtLnN1Ym1pdCA9IHN1Ym1pdDtcbiAgICAgICAgdm0uc2VhcmNoID0gc2VhcmNoO1xuICAgICAgICB2bS5hZGRDYXRlZ29yeSA9IGFkZENhdGVnb3J5O1xuICAgICAgICB2bS5yZW1vdmVDYXRlZ29yeSA9IHJlbW92ZUNhdGVnb3J5O1xuXG4gICAgICAgIHN3aXRjaCAoJHN0YXRlLmN1cnJlbnQubmFtZSkge1xuICAgICAgICAgICAgY2FzZSAnYXBwLndyaXRlJzpcbiAgICAgICAgICAgICAgICBpbml0aWFsaXplV3JpdGVNb2RlKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdhcHAuZWRpdCc6XG4gICAgICAgICAgICAgICAgaW5pdGlhbGl6ZUVkaXRNb2RlKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplV3JpdGVNb2RlKCkge1xuICAgICAgICAgICAgV1JJVEVfTU9ERSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplRWRpdE1vZGUoKSB7XG4gICAgICAgICAgICBFRElUX01PREUgPSB0cnVlO1xuXG4gICAgICAgICAgICBzZXRWaWV3TW9kZWxEYXRhKHdyaXRlT3JFZGl0UmVzb2x2ZXIuYXJ0aWNsZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTYXZlIGlmIHVzZXIgY2xvc2VzIGJyb3dzZXIvbmF2aWdhdGVzIGF3YXkgZnJvbSBhcHBcbiAgICAgICAgJHdpbmRvdy5vbmJlZm9yZXVubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNhdmUoKTtcblxuICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8vIFByZXZlbnRzIGFsZXJ0IGJveCBpbiBicm93c2VyIGZyb20gc2hvd2luZ1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIENyZWF0ZSBhIGNvbnN0YW50IHN0cmluZyB2YWx1ZSBvZiB0aGUgdm0uZGF0YSBmb3IgY29tcGFyaXNvbiBsYXRlci5cbiAgICAgICAgJHNjb3BlLiRvbignZWRpdG9yOnJlYWR5JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgVk1fREFUQSA9IEpTT04uc3RyaW5naWZ5KHZtLmRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBXYXRjaCBzdGF0ZSBjaGFuZ2UgYW5kIGhhbmRsZSB1bnNhdmVkIGNoYW5nZXNcbiAgICAgICAgJHNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBpc0VkaXRvclVuY2hhbmdlZCA9IChWTV9EQVRBID09PSBKU09OLnN0cmluZ2lmeSh2bS5kYXRhKSk7XG5cbiAgICAgICAgICAgIC8vIFVzZXIgaGFzIG1hZGUgdXBkYXRlcyB0byB0aGUgZGF0YSBiZWluZyBlZGl0ZWQsXG4gICAgICAgICAgICAvLyBvciB0aGUgZW1wdHkgZWRpdG9yIGlzIG5vdyBkaXJ0eVxuICAgICAgICAgICAgaWYgKCFpc0VkaXRvclVuY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbW9kYWxPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25CdXR0b25UZXh0OiAnU2F2ZScsXG4gICAgICAgICAgICAgICAgICAgIGNsb3NlQnV0dG9uVGV4dDogXCJEb24ndCBzYXZlXCIsXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlclRleHQ6ICdTYXZlJyxcbiAgICAgICAgICAgICAgICAgICAgYm9keVRleHQ6IFwiWW91J3ZlIG1hZGUgc29tZSBjaGFuZ2VzLiBEbyB5b3Ugd2FudCB0byBzYXZlP1wiXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIG1vZGFsU2VydmljZVxuICAgICAgICAgICAgICAgICAgICAuc2hvd01vZGFsKHt9LCBtb2RhbE9wdGlvbnMpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhdmUoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZ29Ub0xlYXZpbmdTdGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZ29Ub0xlYXZpbmdTdGF0ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdvVG9MZWF2aW5nU3RhdGUoKSB7XG4gICAgICAgICAgICAgICAgJHN0YXRlXG4gICAgICAgICAgICAgICAgICAgIC5nbyh0b1N0YXRlLm5hbWUsIHRvUGFyYW1zLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub3RpZnk6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnJHN0YXRlQ2hhbmdlU3VjY2VzcycsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU2VhcmNoIGZvciBjYXRlZ29yaWVzIGFzIHRoZSB1c2VyIHR5cGVzXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ3ZtLnEnLCBmdW5jdGlvbiAobmV3VmFsKSB7XG4gICAgICAgICAgICBpZiAoIW5ld1ZhbCB8fCBuZXdWYWwubGVuZ3RoIDw9IDEpIHJldHVybjtcblxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vIElmIHNlYXJjaCBzdHJpbmcgaXMgc3RpbGwgdGhlIHNhbWUsIHJldHJpZXZlIGRhdGEuXG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbCA9PT0gdm0ucSkgdm0uc2VhcmNoKCk7XG4gICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Vmlld01vZGVsRGF0YShkYXRhKSB7XG4gICAgICAgICAgICB2bS5kYXRhLmlkID0gZGF0YS5pZDtcbiAgICAgICAgICAgIHZtLmRhdGEudGl0bGUgPSBkYXRhLnRpdGxlO1xuICAgICAgICAgICAgdm0uZGF0YS5ib2R5ID0gZGF0YS5ib2R5O1xuXG4gICAgICAgICAgICBpZiAoZGF0YS5jYXRlZ29yaWVzKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmNhdGVnb3JpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkQ2F0ZWdvcnkoZGF0YS5jYXRlZ29yaWVzW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBhZGRDYXRlZ29yeShjYXRlZ29yeSkge1xuICAgICAgICAgICAgLy8gT25seSBhZGQgY2F0ZWdvcnkgaWQgdG8gY2F0ZWdvcnlJZExpc3QgYXJyYXkgaWYgbm90IHlldCBleGlzdGluZ1xuICAgICAgICAgICAgaWYgKHZtLmRhdGEuY2F0ZWdvcnlJZExpc3QuaW5kZXhPZihjYXRlZ29yeS5pZCkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdm0uZGF0YS5jYXRlZ29yeUlkTGlzdC5wdXNoKGNhdGVnb3J5LmlkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gT25seSBhZGQgY2F0ZWdvcnkgb2JqZWN0IHRvIGNhdGVnb3JpZXNTZWxlY3RlZCBhcnJheSBpZiBub3QgeWV0IGV4aXN0aW5nXG4gICAgICAgICAgICB2YXIgY2F0ZWdvcnlEb2VzTm90RXhpc3QgPSB0cnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2bS5jYXRlZ29yaWVzU2VsZWN0ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodm0uY2F0ZWdvcmllc1NlbGVjdGVkW2ldLmlkID09PSBjYXRlZ29yeS5pZCkge1xuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeURvZXNOb3RFeGlzdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2F0ZWdvcnlEb2VzTm90RXhpc3QpIHtcbiAgICAgICAgICAgICAgICB2bS5jYXRlZ29yaWVzU2VsZWN0ZWQucHVzaChjYXRlZ29yeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVDYXRlZ29yeShjYXRlZ29yeUlkKSB7XG4gICAgICAgICAgICAvLyBSZW1vdmUgY2F0ZWdvcnkgaWQgZnJvbSBjYXRlZ29yeUlkTGlzdCBhcnJheVxuICAgICAgICAgICAgdmFyIGxpc3RJbmRleCA9IHZtLmRhdGEuY2F0ZWdvcnlJZExpc3QuaW5kZXhPZihjYXRlZ29yeUlkKTtcbiAgICAgICAgICAgIGlmIChsaXN0SW5kZXggPiAtMSkge1xuICAgICAgICAgICAgICAgIHZtLmRhdGEuY2F0ZWdvcnlJZExpc3Quc3BsaWNlKGxpc3RJbmRleCwgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFJlbW92ZSBjYXRlZ29yeSBvYmplY3QgZnJvbSBjYXRlZ29yaWVzU2VsZWN0ZWQgYXJyYXlcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0uY2F0ZWdvcmllc1NlbGVjdGVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZtLmNhdGVnb3JpZXNTZWxlY3RlZFtpXS5pZCA9PT0gY2F0ZWdvcnlJZCkge1xuICAgICAgICAgICAgICAgICAgICB2bS5jYXRlZ29yaWVzU2VsZWN0ZWQuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNlYXJjaCgpIHtcbiAgICAgICAgICAgIHNlYXJjaFNlcnZpY2VcbiAgICAgICAgICAgICAgICAuZmluZENhdGVnb3JpZXModm0ucSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZtLmNhdGVnb3JpZXNGcm9tU2VhcmNoID0gcmVzLmNhdGVnb3JpZXM7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3Igc2VhcmNoaW5nIGZvciBjYXRlZ29yaWVzOiAnLCByZXMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZSgpIHtcbiAgICAgICAgICAgIC8vIE9uIHdyaXRlIG1vZGVcbiAgICAgICAgICAgIGlmIChXUklURV9NT0RFKSB7XG4gICAgICAgICAgICAgICAgc2F2ZURyYWZ0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBPbiBlZGl0IG1vZGVcbiAgICAgICAgICAgIGVsc2UgaWYgKEVESVRfTU9ERSkge1xuICAgICAgICAgICAgICAgIC8vIEVkaXRpbmcgYSBkcmFmdFxuICAgICAgICAgICAgICAgIGlmICgkc3RhdGVQYXJhbXMuZHJhZnQgPT09ICd0cnVlJykge1xuICAgICAgICAgICAgICAgICAgICBzYXZlRHJhZnQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRWRpdGluZyBhIHB1YmxpYyBzdG9yeVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCRzdGF0ZVBhcmFtcy5kcmFmdCA9PT0gJ2ZhbHNlJykge1xuICAgICAgICAgICAgICAgICAgICBzYXZlUHVibGljKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZURyYWZ0KCkge1xuICAgICAgICAgICAgYXJ0aWNsZVNlcnZpY2VcbiAgICAgICAgICAgICAgICAuc2F2ZURyYWZ0KHZtLmRhdGEpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbWVzc2FnZScsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5tZXNzYWdlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciBzYXZpbmcgZHJhZnQ6IFwiLCByZXMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZVB1YmxpYygpIHtcbiAgICAgICAgICAgIGFydGljbGVTZXJ2aWNlXG4gICAgICAgICAgICAgICAgLmVkaXQodm0uZGF0YSwgJHN0YXRlUGFyYW1zLmFydGljbGVTbHVnKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ21lc3NhZ2UnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiByZXMubWVzc2FnZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBlZGl0aW5nIGFydGljbGU6ICcsIHJlcyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzdWJtaXQoKSB7XG4gICAgICAgICAgICAvLyBFZGl0b3IgaXMgbm90IGVtcHR5LCBjb250aW51ZSBwdWJsaXNoaW5nXG4gICAgICAgICAgICBpZiAodm0uZGF0YS50aXRsZS5sZW5ndGggPiAwIHx8IHZtLmRhdGEuYm9keS5sZW5ndGggPiAwIHx8IHZtLmRhdGEuY2F0ZWdvcnlJZExpc3QubGVuZ3RoID4gMCkge1xuXG4gICAgICAgICAgICAgICAgLy8gT24gd3JpdGUgbW9kZSBPUiBvbiBlZGl0IG1vZGUgZWRpdGluZyBhIGRyYWZ0XG4gICAgICAgICAgICAgICAgaWYgKCRzdGF0ZS5jdXJyZW50Lm5hbWUgPT09ICdhcHAud3JpdGUnIHx8ICRzdGF0ZVBhcmFtcy5kcmFmdCA9PT0gJ3RydWUnKSB7XG4gICAgICAgICAgICAgICAgICAgIGFydGljbGVTZXJ2aWNlXG4gICAgICAgICAgICAgICAgICAgICAgICAuY3JlYXRlUHVibGljKHZtLmRhdGEpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb1RvQXJ0aWNsZShyZXMuYXJ0aWNsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3IgY3JlYXRpbmcgYXJ0aWNsZTogJywgcmVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBPbiBlZGl0IG1vZGUgKGVkaXRpbmcgYSBwdWJsaXNoZWQgc3RvcnkpXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoJHN0YXRlLmN1cnJlbnQubmFtZSA9PT0gJ2FwcC5lZGl0JyAmJiAkc3RhdGVQYXJhbXMuZHJhZnQgPT09ICdmYWxzZScpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJ0aWNsZVNlcnZpY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lZGl0KHZtLmRhdGEsICRzdGF0ZVBhcmFtcy5hcnRpY2xlU2x1ZylcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvVG9BcnRpY2xlKHJlcy5hcnRpY2xlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbWVzc2FnZScsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogcmVzLm1lc3NhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBlZGl0aW5nIGFydGljbGU6ICcsIHJlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEVkaXRvciBpcyBlbXB0eSwgZG8gbm90IHB1Ymxpc2gsIHNob3cgZXJyb3JzXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2bS5lcnJvcnMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBib2R5OiB0cnVlXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8vIFdhaXQgYSBzZWNvbmQgYW5kIHRoZW4gcmVzZXQgdGhlIGVycm9yc1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgLy8gVGhpcyByZW1vdmVzIHRoZSAnc2hha2UnIGNsYXNzIGZyb20gdGhlIGRpdidzIHNvIHRoYXQgd2hlbiB0aGUgZm9ybSBpc1xuICAgICAgICAgICAgICAgIC8vIHN1Ym1pdHRlZCBhZ2FpbiB0aGUgY2xhc3MgY2FuIGJlIHJlLWFkZGVkIGFuZCB0aGUgZWxlbWVudHMgd2lsbCBzaGFrZSBhZ2Fpbi5cbiAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZtLmVycm9ycyA9IHt9O1xuICAgICAgICAgICAgICAgIH0sIDEwMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ29Ub0FydGljbGUoYXJ0aWNsZSkge1xuICAgICAgICAgICAgJHN0YXRlXG4gICAgICAgICAgICAgICAgLmdvKCdhcHAuYXJ0aWNsZScsIHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IGFydGljbGUuYXV0aG9yLnVzZXJuYW1lLFxuICAgICAgICAgICAgICAgICAgICBhcnRpY2xlU2x1ZzogYXJ0aWNsZS5zbHVnXG4gICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICBub3RpZnk6IGZhbHNlIC8vIE5vdGlmeSBmYWxzZSB0byBpZ25vcmUgJHN0YXRlQ2hhbmdlU3RhcnQgZXZlbnQgdGhhdCB3YXRjaGVzIGVkaXRvclxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnJHN0YXRlQ2hhbmdlU3VjY2VzcycpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcnRpY2xlcycpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3RvcFN0b3JpZXMnLCB0b3BTdG9yaWVzKTtcblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgc2NvcGU6IHt9LCB0ZW1wbGF0ZVVybDogc3RyaW5nLCBsaW5rOiBsaW5rfX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0b3BTdG9yaWVzKCkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2FydGljbGVzL3RvcC1zdG9yaWVzL3RvcC1zdG9yaWVzLmh0bWwnLFxuICAgICAgICAgICAgbGluazogbGlua1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICAgICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbSwgYXR0cnMpIHtcbiAgICAgICAgICAgIGlmIChhdHRycy5kYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBzY29wZS4kZXZhbChhdHRycy5kYXRhKTtcbiAgICAgICAgICAgICAgICBzY29wZS5hcnRpY2xlcyA9IGRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ21lJylcclxuICAgICAgICAuZmFjdG9yeSgnbWVTdG9yaWVzU2VydmljZScsIG1lU3Rvcmllc1NlcnZpY2UpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHJldHVybnMge3tyZW1vdmVGcm9tQ29sbGVjdGlvbjogcmVtb3ZlRnJvbUNvbGxlY3Rpb259fVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBtZVN0b3JpZXNTZXJ2aWNlKCkge1xyXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xyXG4gICAgICAgICAgICByZW1vdmVGcm9tQ29sbGVjdGlvbjogcmVtb3ZlRnJvbUNvbGxlY3Rpb25cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlRnJvbUNvbGxlY3Rpb24oY29sbGVjdGlvbiwgc2x1Zykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbGxlY3Rpb24ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb2xsZWN0aW9uW2ldLnNsdWcgPT0gc2x1Zykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24uc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY29sbGVjdGlvbjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdjb25maWcnKVxuICAgICAgICAuY29uc3RhbnQoJ2NvbmZpZycsIHtcbiAgICAgICAgICAgIHVybDogJ2h0dHA6Ly8nICsgd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lICsgJy9hcGkvdjEnLFxuICAgICAgICAgICAgdmVyc2lvbjogJzEuMC4wJ1xuICAgICAgICB9KVxuICAgICAgICAuY29uZmlnKGNvbmZpZylcbiAgICAgICAgLmZhY3RvcnkoJ2NvbmZpZ1NlcnZpY2UnLCBjb25maWdTZXJ2aWNlKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBjb25maWcuJGluamVjdCA9IFsnJHByb3ZpZGUnLCAnY2ZwTG9hZGluZ0JhclByb3ZpZGVyJ107XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgY29uZmlnU2VydmljZS4kaW5qZWN0ID0gWyckcm9vdFNjb3BlJywgJyRkb2N1bWVudCddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICRwcm92aWRlXG4gICAgICogQHBhcmFtIGNmcExvYWRpbmdCYXJQcm92aWRlclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbmZpZygkcHJvdmlkZSkge1xuICAgICAgICAvLyBEZWNvcmF0aW5nICckc3RhdGUnIHdpdGggJ3RvU3RhdGUnLCAndG9QYXJhbXMnLCAnZnJvbVN0YXRlJyBhbmQgJ2Zyb21QYXJhbXMnIGZvciBlYXNlIG9mIHVzZVxuICAgICAgICAvLyB0aHJvdWdob3V0IHRoZSBhcHAgd2l0aG91dCB3aGVyZSBsaXN0ZW5pbmcgZm9yIHN0YXRlQ2hhbmdlIGV2ZW50cyBpcyBub3QgcG9zc2libGUvaWRlYWwuXG4gICAgICAgICRwcm92aWRlLmRlY29yYXRvcignJHN0YXRlJywgZnVuY3Rpb24oJGRlbGVnYXRlLCAkcm9vdFNjb3BlKSB7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAkZGVsZWdhdGUudG9TdGF0ZSA9IHRvU3RhdGU7XG4gICAgICAgICAgICAgICAgJGRlbGVnYXRlLnRvUGFyYW1zID0gdG9QYXJhbXM7XG4gICAgICAgICAgICAgICAgJGRlbGVnYXRlLmZyb21TdGF0ZSA9IGZyb21TdGF0ZTtcbiAgICAgICAgICAgICAgICAkZGVsZWdhdGUuZnJvbVBhcmFtcyA9IGZyb21QYXJhbXM7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuICRkZWxlZ2F0ZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICRyb290U2NvcGVcbiAgICAgKiBAcGFyYW0gJGRvY3VtZW50XG4gICAgICogQHJldHVybnMge3tpbml0aWFsaXplOiBpbml0aWFsaXplLCBwcmVwYXJlRG9jdW1lbnQ6IHByZXBhcmVEb2N1bWVudH19XG4gICAgICovXG4gICAgZnVuY3Rpb24gY29uZmlnU2VydmljZSgkcm9vdFNjb3BlLCAkZG9jdW1lbnQpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBpbml0aWFsaXplOiBpbml0aWFsaXplLFxuICAgICAgICAgICAgcHJlcGFyZURvY3VtZW50OiBwcmVwYXJlRG9jdW1lbnRcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplKCkge1xuICAgICAgICAgICAgc2VydmljZS5wcmVwYXJlRG9jdW1lbnQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHByZXBhcmVEb2N1bWVudCgpIHtcbiAgICAgICAgICAgIC8vIFNjcm9sbCB0byB0b3Agb24gbmV3IHN0YXRlXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRvbihcIiRzdGF0ZUNoYW5nZVN1Y2Nlc3NcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRkb2N1bWVudFswXS5ib2R5LnNjcm9sbFRvcCA9ICRkb2N1bWVudFswXS5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wID0gMDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdkaXJlY3RpdmVzJylcbiAgICAgICAgLmRpcmVjdGl2ZSgndmlld0hlYWQnLCB2aWV3SGVhZCk7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgdmlld0hlYWQuJGluamVjdCA9IFsnJGRvY3VtZW50J107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gJGRvY3VtZW50XG4gICAgICogQHJldHVybnMge3tyZXN0cmljdDogc3RyaW5nLCBsaW5rOiBsaW5rfX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB2aWV3SGVhZCgkZG9jdW1lbnQpIHtcbiAgICAgICAgdmFyIGhlYWQgPSBhbmd1bGFyLmVsZW1lbnQoJGRvY3VtZW50WzBdLmhlYWQpLFxuICAgICAgICAgICAgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICAgICAgbGluazogbGlua1xuICAgICAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW0pIHtcbiAgICAgICAgICAgIC8vIE1vdmUgdGhlIGVsZW1lbnQgaW50byB0aGUgaGVhZCBvZiB0aGUgZG9jdW1lbnQuXG4gICAgICAgICAgICAvLyBBbHRob3VnaCB0aGUgcGh5c2ljYWwgbG9jYXRpb24gb2YgdGhlIGRvY3VtZW50IGNoYW5nZXMsIHRoZSBlbGVtZW50IHJlbWFpbnNcbiAgICAgICAgICAgIC8vIGJvdW5kIHRvIHRoZSBzY29wZSBpbiB3aGljaCBpdCB3YXMgZGVjbGFyZWQsIHNvIGl0IGNhbiByZWZlciB0byB2YXJpYWJsZXMgZnJvbVxuICAgICAgICAgICAgLy8gdGhlIHZpZXcgc2NvcGUgaWYgbmVjZXNzYXJ5LlxuICAgICAgICAgICAgaGVhZC5hcHBlbmQoZWxlbSk7XG5cbiAgICAgICAgICAgIC8vIFdoZW4gdGhlIHNjb3BlIGlzIGRlc3Ryb3llZCwgcmVtb3ZlIHRoZSBlbGVtZW50LlxuICAgICAgICAgICAgLy8gVGhpcyBpcyBvbiB0aGUgYXNzdW1wdGlvbiB0aGF0IHdlJ3JlIGJlaW5nIHVzZWQgaW4gc29tZSBzb3J0IG9mIHZpZXcgc2NvcGUuXG4gICAgICAgICAgICAvLyBJdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgdG8gdXNlIHRoaXMgZGlyZWN0aXZlIG91dHNpZGUgb2YgdGhlIHZpZXcsIGFuZCBub3IgZG9lcyBpdFxuICAgICAgICAgICAgLy8gbWFrZSBzZW5zZSB0byB1c2UgaXQgaW5zaWRlIG90aGVyIHNjb3BlLWNyZWF0aW5nIGRpcmVjdGl2ZXMgbGlrZSBuZy1yZXBlYXQuXG4gICAgICAgICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGVsZW0ucmVtb3ZlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnZmlsdGVycycpXG4gICAgICAgIC5maWx0ZXIoJ2VzY2FwZUh0bWwnLCBlc2NhcGVIdG1sKTtcblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtmaWx0ZXJ9XG4gICAgICovXG4gICAgZnVuY3Rpb24gZXNjYXBlSHRtbCgpIHtcbiAgICAgICAgdmFyIGVudGl0eU1hcCA9IHtcbiAgICAgICAgICAgIFwiJlwiOiBcIiZhbXA7XCIsXG4gICAgICAgICAgICBcIjxcIjogXCImbHQ7XCIsXG4gICAgICAgICAgICBcIj5cIjogXCImZ3Q7XCIsXG4gICAgICAgICAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICAgICAgICAgIFwiJ1wiOiAnJiMzOTsnLFxuICAgICAgICAgICAgXCIvXCI6ICcmI3gyRjsnXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGZpbHRlcjtcblxuICAgICAgICBmdW5jdGlvbiBmaWx0ZXIoaHRtbCkge1xuICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhodG1sKS5yZXBsYWNlKC9bJjw+XCInXFwvXS9nLCBmdW5jdGlvbiAocykge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbnRpdHlNYXBbc107XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnZmlsdGVycycpXG4gICAgICAgIC5maWx0ZXIoJ3Nob3J0ZW4nLCBzaG9ydGVuKTtcblxuICAgIGZ1bmN0aW9uIHNob3J0ZW4oKSB7XG4gICAgICAgIHJldHVybiBmaWx0ZXI7XG5cbiAgICAgICAgZnVuY3Rpb24gZmlsdGVyKHZhbHVlLCB3b3Jkd2lzZSwgbWF4LCB0YWlsKSB7XG4gICAgICAgICAgICBpZiAoIXZhbHVlKSByZXR1cm4gJyc7XG5cbiAgICAgICAgICAgIG1heCA9IHBhcnNlSW50KG1heCk7XG5cbiAgICAgICAgICAgIGlmICghbWF4IHx8IHZhbHVlLmxlbmd0aCA8PSBtYXgpIHJldHVybiB2YWx1ZTtcblxuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5zdWJzdHIoMCwgbWF4KTtcblxuICAgICAgICAgICAgaWYgKHdvcmR3aXNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxhc3RwbGFjZSA9IHZhbHVlLmxhc3RJbmRleE9mKCcgJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAobGFzdHBsYWNlICE9IC0xKVxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnN1YnN0cigwLCBsYXN0cGxhY2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUgKyAodGFpbCB8fCAnJmhlbGxpcDsnKTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgndXRpbCcpXHJcbiAgICAgICAgLmZhY3RvcnkoJ3V0aWwnLCB1dGlsKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEByZXR1cm5zIHt7fX1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gdXRpbCgpIHtcclxuICAgICAgICB2YXIgc2VydmljZSA9IHt9O1xyXG5cclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuICAgIH1cclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3NlcnZpY2VzJylcbiAgICAgICAgLmZhY3RvcnkoJ2FwaUludGVyY2VwdG9yJywgYXBpSW50ZXJjZXB0b3IpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIGFwaUludGVyY2VwdG9yLiRpbmplY3QgPSBbJyRxJywgJyRpbmplY3RvciddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICRxXG4gICAgICogQHBhcmFtICRpbmplY3RvclxuICAgICAqIEByZXR1cm5zIHt7cmVxdWVzdDogcmVxdWVzdCwgcmVxdWVzdEVycm9yOiByZXF1ZXN0RXJyb3IsIHJlc3BvbnNlOiByZXNwb25zZSwgcmVzcG9uc2VFcnJvcjogcmVzcG9uc2VFcnJvcn19XG4gICAgICovXG4gICAgZnVuY3Rpb24gYXBpSW50ZXJjZXB0b3IoJHEsICRpbmplY3Rvcikge1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIHJlcXVlc3Q6IHJlcXVlc3QsXG4gICAgICAgICAgICByZXF1ZXN0RXJyb3I6IHJlcXVlc3RFcnJvcixcbiAgICAgICAgICAgIHJlc3BvbnNlOiByZXNwb25zZSxcbiAgICAgICAgICAgIHJlc3BvbnNlRXJyb3I6IHJlc3BvbnNlRXJyb3JcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICAvLyBDYWxsZWQgYmVmb3JlIGEgcmVxdWVzdCBpcyBzZW50LCBjYXBhYmxlIG9mIG11dGF0aW5nIHRoZSByZXF1ZXN0IG9iamVjdFxuICAgICAgICBmdW5jdGlvbiByZXF1ZXN0KGNvbmZpZykge1xuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlcXVlc3RFcnJvcihjb25maWcpIHtcbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDYWxsZWQgd2hlbiBhbiAkaHR0cCByZXF1ZXN0IHN1Y2NlZWRzLCBpcyBwYXNzZWQgdGhlIHJlc3VsdHMgb2JqZWN0XG4gICAgICAgIGZ1bmN0aW9uIHJlc3BvbnNlKHJlcykge1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENhbGxlZCBpZiBhbiAkaHR0cCBtZXRob2QgZmFpbHNcbiAgICAgICAgZnVuY3Rpb24gcmVzcG9uc2VFcnJvcihyZXMpIHtcbiAgICAgICAgICAgIGlmIChyZXMuc3RhdHVzID09IDQwNCkge1xuICAgICAgICAgICAgICAgICRpbmplY3Rvci5nZXQoJyRzdGF0ZScpLmdvKCdhcHAuNDA0Jywge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiByZXMuZGF0YS5lcnJvci5tZXNzYWdlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzKTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3NlcnZpY2VzJylcbiAgICAgICAgLmZhY3RvcnkoJ2FwaVNlcnZpY2UnLCBhcGlTZXJ2aWNlKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBhcGlTZXJ2aWNlLiRpbmplY3QgPSBbJyRxJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gJHFcbiAgICAgKiBAcmV0dXJucyB7e2hhbmRsZVN1Y2Nlc3M6IGhhbmRsZVN1Y2Nlc3MsIGhhbmRsZUVycm9yOiBoYW5kbGVFcnJvcn19XG4gICAgICovXG4gICAgZnVuY3Rpb24gYXBpU2VydmljZSgkcSkge1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGhhbmRsZVN1Y2Nlc3M6IGhhbmRsZVN1Y2Nlc3MsXG4gICAgICAgICAgICBoYW5kbGVFcnJvcjogaGFuZGxlRXJyb3JcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICBmdW5jdGlvbiBoYW5kbGVTdWNjZXNzKHJlcykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiByZXMuZGF0YSA9PT0gJ29iamVjdCcpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5kYXRhO1xuXG4gICAgICAgICAgICBoYW5kbGVFcnJvcihyZXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlRXJyb3IocmVzKSB7XG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3NlcnZpY2VzJylcbiAgICAgICAgLmZhY3RvcnkoJ3JlZGlyZWN0U2VydmljZScsIHJlZGlyZWN0U2VydmljZSk7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgcmVkaXJlY3RTZXJ2aWNlLiRpbmplY3QgPSBbJyRyb290U2NvcGUnLCAnJHN0YXRlJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gJHJvb3RTY29wZVxuICAgICAqIEBwYXJhbSAkc3RhdGVcbiAgICAgKiBAcmV0dXJucyB7e2dvRGVmYXVsdENoaWxkU3RhdGU6IGdvRGVmYXVsdENoaWxkU3RhdGV9fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlZGlyZWN0U2VydmljZSgkcm9vdFNjb3BlLCAkc3RhdGUpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBnb0RlZmF1bHRDaGlsZFN0YXRlOiBnb0RlZmF1bHRDaGlsZFN0YXRlXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgLy8gVGhpcyBpcyB1c2VkIGZvciBzdGF0ZXMgdGhhdCBoYXZlIHN1Yi1tZW51cy4gRWFjaCBzdWItbWVudVxuICAgICAgICAvLyBzaG91bGQgaGF2ZSBpdCdzIG93biBzdGF0ZSwgYW5kIGEgZGVmYXVsdCBjaGlsZCBzdGF0ZSBpcyBzZXRcbiAgICAgICAgLy8gaW4gdGhlIHN0YXRlIHRvIGJlIHJlZGlyZWN0ZWQgdG8gdXNpbmcgdGhpcyBmdW5jdGlvbi5cbiAgICAgICAgZnVuY3Rpb24gZ29EZWZhdWx0Q2hpbGRTdGF0ZSgpIHtcbiAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcykge1xuICAgICAgICAgICAgICAgIGlmICh0b1N0YXRlLmRlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28odG9TdGF0ZS5kZWZhdWx0LCB0b1BhcmFtcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3NlcnZpY2VzJylcbiAgICAgICAgLmZhY3RvcnkoJ3VzZXJTZXJ2aWNlJywgdXNlclNlcnZpY2UpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIHVzZXJTZXJ2aWNlLiRpbmplY3QgPSBbJyRyb290U2NvcGUnXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkcm9vdFNjb3BlXG4gICAgICogQHJldHVybnMge3tpbml0aWFsaXplOiBpbml0aWFsaXplLCBzZXRVc2VyOiBzZXRVc2VyLCByZW1vdmVVc2VyOiByZW1vdmVVc2VyfX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1c2VyU2VydmljZSgkcm9vdFNjb3BlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgaW5pdGlhbGl6ZTogaW5pdGlhbGl6ZSxcbiAgICAgICAgICAgIHNldFVzZXI6IHNldFVzZXIsXG4gICAgICAgICAgICByZW1vdmVVc2VyOiByZW1vdmVVc2VyXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENoZWNrcyB0aGUgYXV0aGVudGljYXRlZCBvZiB1c2VyIG9uIGluaXRpYWwgcGFnZSBsb2FkLlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHtcbiAgICAgICAgICAgIHZhciB1c2VyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXInKTtcblxuICAgICAgICAgICAgaWYgKHVzZXIgIT09IG51bGwpXG4gICAgICAgICAgICAgICAgYWN0aXZhdGVVc2VySW5Sb290U2NvcGUodXNlciwgdHJ1ZSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZGlzYWJsZVVzZXJJblJvb3RTY29wZSgpO1xuXG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogU2V0IGFuZCBhdXRoZW50aWNhdGUgdXNlci5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHVzZXJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHNldFVzZXIodXNlcikge1xuICAgICAgICAgICAgc2V0VXNlckluTG9jYWxTdG9yYWdlKHVzZXIpO1xuICAgICAgICAgICAgYWN0aXZhdGVVc2VySW5Sb290U2NvcGUodXNlcik7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVtb3ZlIGFuZCBkZS1hdXRoZW50aWNhdGUgdXNlci5cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZVVzZXIoKSB7XG4gICAgICAgICAgICByZW1vdmVVc2VyRnJvbUxvY2FsU3RvcmFnZSgpO1xuICAgICAgICAgICAgZGlzYWJsZVVzZXJJblJvb3RTY29wZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldCB1c2VyIGluIGxvY2FsIHN0b3JhZ2UuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB1c2VyXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBzZXRVc2VySW5Mb2NhbFN0b3JhZ2UodXNlcikge1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXInLCBKU09OLnN0cmluZ2lmeSh1c2VyKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVtb3ZlIHVzZXIgZnJvbSBsb2NhbCBzdG9yYWdlLlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlVXNlckZyb21Mb2NhbFN0b3JhZ2UoKSB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndXNlcicpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldCBhbmQgYXV0aGVudGljYXRlIHVzZXIgaW4gJHJvb3RTY29wZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHVzZXJcbiAgICAgICAgICogQHBhcmFtIHNob3VsZFBhcnNlIChPcHRpb25hbDsgc2V0IHRvICd0cnVlJyBpZiB1c2VyIGlzIHN0cmluZyB0aGF0IG5lZWRzXG4gICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgdG8gYmUgcGFyc2VkIHRvIEpTT04uIFVzdWFsbHkgbmVlZGVkIGlmIHVzZXIgaXMgY29taW5nXG4gICAgICAgICAqICAgICAgICAgICAgICAgICAgICAgZnJvbSBsb2NhbCBzdG9yYWdlLilcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlVXNlckluUm9vdFNjb3BlKHVzZXIsIHNob3VsZFBhcnNlKSB7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2F1dGhlbnRpY2F0ZWQnKTtcblxuICAgICAgICAgICAgaWYgKHNob3VsZFBhcnNlKVxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBKU09OLnBhcnNlKHVzZXIpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xuXG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVtb3ZlIGFuZCBkZS1hdXRoZW50aWNhdGUgdXNlciBmcm9tICRyb290U2NvcGUuXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBkaXNhYmxlVXNlckluUm9vdFNjb3BlKCkge1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd1bmF1dGhlbnRpY2F0ZWQnKTtcbiAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd1aS5hZmZpeCcpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3VpQWZmaXgnLCB1aUFmZml4KTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICB1aUFmZml4LiRpbmplY3QgPSBbJyR0aW1lb3V0J107XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7e3Jlc3RyaWN0OiBzdHJpbmcsIGxpbms6IGxpbmt9fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVpQWZmaXgoJHRpbWVvdXQpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICBsaW5rOiBsaW5rXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgICAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtKSB7XG4gICAgICAgICAgICB2YXIgbmF2YmFyID0gYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuYXZiYXInKSksXG4gICAgICAgICAgICAgICAgaGVhZGVyID0gYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNoZWFkZXInKSksXG4gICAgICAgICAgICAgICAgc2VhcmNoSGVhZGVyID0gYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWFyY2gtaGVhZGVyJykpLFxuICAgICAgICAgICAgICAgIHRvcEhlaWdodDtcblxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRvcEhlaWdodCA9IG5hdmJhclswXS5vZmZzZXRUb3AgKyBoZWFkZXJbMF0ub2Zmc2V0SGVpZ2h0IHx8IHNlYXJjaEhlYWRlclswXS5vZmZzZXRIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICBlbGVtLmFmZml4KHtcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHRvcEhlaWdodFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd1aS5hbGVydCcpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3VpQWxlcnQnLCB1aUFsZXJ0KTtcblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgdGVtcGxhdGVVcmw6IHN0cmluZywgbGluazogbGlua319XG4gICAgICovXG4gICAgZnVuY3Rpb24gdWlBbGVydCgpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC91aS9hbGVydC9hbGVydC5odG1sJyxcbiAgICAgICAgICAgIGxpbms6IGxpbmtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUpIHtcbiAgICAgICAgICAgIHNjb3BlLiRvbignaW5wdXQ6c3VjY2VzcycsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUuZXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBzY29wZS5zdWNjZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBzY29wZS5tZXNzYWdlID0gZGF0YS5tZXNzYWdlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHNjb3BlLiRvbignaW5wdXQ6ZXJyb3InLCBmdW5jdGlvbiAoZXZlbnQsIGRhdGEpIHtcbiAgICAgICAgICAgICAgICBzY29wZS5zdWNjZXNzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgc2NvcGUuZXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNjb3BlLm1lc3NhZ2UgPSBkYXRhLm1lc3NhZ2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndWkuZm9ybS1ncm91cC1pdGVtJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0Zvcm1Hcm91cEl0ZW1Db250cm9sbGVyJywgRm9ybUdyb3VwSXRlbUNvbnRyb2xsZXIpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3VpRm9ybUdyb3VwSXRlbScsIHVpRm9ybUdyb3VwSXRlbSk7XG5cbiAgICAvKipcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBGb3JtR3JvdXBJdGVtQ29udHJvbGxlcigpe31cblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgc2NvcGU6IHttb2RlbDogc3RyaW5nLCBlcnJvcnM6IHN0cmluZywgc3VibWl0OiBzdHJpbmd9LCBiaW5kVG9Db250cm9sbGVyOiBib29sZWFuLCBjb250cm9sbGVyOiBzdHJpbmcsIHRlbXBsYXRlVXJsOiBzdHJpbmcsIGxpbms6IGxpbmt9fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVpRm9ybUdyb3VwSXRlbSgpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIG1vZGVsOiAnPScsXG4gICAgICAgICAgICAgICAgZXJyb3JzOiAnPScsXG4gICAgICAgICAgICAgICAgc3VibWl0OiAnPSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0Zvcm1Hcm91cEl0ZW1Db250cm9sbGVyIGFzIHZtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3VpL2Zvcm0tZ3JvdXAtaXRlbS9mb3JtLWdyb3VwLWl0ZW0uaHRtbCcsXG4gICAgICAgICAgICBsaW5rOiBsaW5rXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgICAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtLCBhdHRycykge1xuICAgICAgICAgICAgc2NvcGUuaW5wdXQgPSBhdHRycy5pbnB1dCB8fCBmYWxzZTtcbiAgICAgICAgICAgIHNjb3BlLnRleHRhcmVhID0gYXR0cnMudGV4dGFyZWEgfHwgZmFsc2U7XG4gICAgICAgICAgICBzY29wZS50eXBlID0gYXR0cnMudHlwZSB8fCAndGV4dCc7XG4gICAgICAgICAgICBzY29wZS5sYWJlbCA9IGF0dHJzLmxhYmVsO1xuICAgICAgICAgICAgc2NvcGUuaWQgPSBhdHRycy5pZDtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndWkuaGVhZGluZycpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3VpSGVhZGluZycsIHVpSGVhZGluZyk7XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7e3Jlc3RyaWN0OiBzdHJpbmcsIHRlbXBsYXRlVXJsOiBzdHJpbmcsIGxpbms6IGxpbmt9fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVpSGVhZGluZygpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgc2NvcGU6IHt9LFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvdWkvaGVhZGluZy9oZWFkaW5nLmh0bWwnLFxuICAgICAgICAgICAgbGluazogbGlua1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICAgICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbSwgYXR0cnMpIHtcbiAgICAgICAgICAgIGlmIChhdHRycy50aXRsZSkge1xuICAgICAgICAgICAgICAgIHNjb3BlLnRpdGxlID0gYXR0cnMudGl0bGU7XG4gICAgICAgICAgICAgICAgc2NvcGUuYm9sZCA9IGF0dHJzLmJvbGQgfHwgZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3VpLmZvY3VzJylcbiAgICAgICAgLmRpcmVjdGl2ZSgndWlGb2N1cycsIHVpRm9jdXMpO1xuXG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3tyZXN0cmljdDogc3RyaW5nLCBsaW5rOiBsaW5rfX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1aUZvY3VzKCkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIGxpbms6IGxpbmtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW0pIHtcbiAgICAgICAgICAgIGVsZW0uZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndWkuaGVhZGVyLWNhbm9weScpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3VpSGVhZGVyQ2Fub3B5Q2F0ZWdvcnknLCB1aUhlYWRlckNhbm9weUNhdGVnb3J5KTtcblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgdGVtcGxhdGVVcmw6IHN0cmluZywgbGluazogbGlua319XG4gICAgICovXG4gICAgZnVuY3Rpb24gdWlIZWFkZXJDYW5vcHlDYXRlZ29yeSgpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvdWkvaGVhZGVyLWNhbm9weS9oZWFkZXItY2Fub3B5LWNhdGVnb3J5Lmh0bWwnLFxuICAgICAgICAgICAgbGluazogbGlua1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICAgICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbSwgYXR0cnMpIHtcbiAgICAgICAgICAgIGlmIChhdHRycy50aXRsZSAmJiBhdHRycy5kZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgIHNjb3BlLnRpdGxlID0gYXR0cnMudGl0bGU7XG4gICAgICAgICAgICAgICAgc2NvcGUuZGVzY3JpcHRpb24gPSBhdHRycy5kZXNjcmlwdGlvbjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ01pc3NpbmcgdGl0bGUgb3IgZGVzY3JpcHRpb24gYXR0cmlidXRlIGluIGhlYWRlci1jYW5vcHktY2F0ZWdvcnkgZGlyZWN0aXZlIScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndWkuaGVhZGVyLWNhbm9weScpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3VpSGVhZGVyQ2Fub3B5SG9tZScsIHVpSGVhZGVyQ2Fub3B5SG9tZSk7XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gJHJvb3RTY29wZVxuICAgICAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgbGluazogbGlua319XG4gICAgICovXG4gICAgZnVuY3Rpb24gdWlIZWFkZXJDYW5vcHlIb21lKCkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIGxpbms6IGxpbmtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW0pIHtcbiAgICAgICAgICAgIHNjb3BlLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZWxlbS5oaWRlKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd1aS5oZWFkZXItY2Fub3B5JylcbiAgICAgICAgLmRpcmVjdGl2ZSgndWlIZWFkZXJDYW5vcHlQbGFpbicsIHVpSGVhZGVyQ2Fub3B5UGxhaW4pO1xuXG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3tyZXN0cmljdDogc3RyaW5nLCB0ZW1wbGF0ZVVybDogc3RyaW5nLCBsaW5rOiBsaW5rfX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1aUhlYWRlckNhbm9weVBsYWluKCkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC91aS9oZWFkZXItY2Fub3B5L2hlYWRlci1jYW5vcHktcGxhaW4uaHRtbCcsXG4gICAgICAgICAgICBsaW5rOiBsaW5rXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgICAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtLCBhdHRycykge1xuICAgICAgICAgICAgaWYgKGF0dHJzLnRpdGxlKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUudGl0bGUgPSBhdHRycy50aXRsZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ01pc3NpbmcgdGl0bGUgb3IgZGVzY3JpcHRpb24gYXR0cmlidXRlIGluIGhlYWRlci1jYW5vcHktcGxhaW4gZGlyZWN0aXZlIScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd1aS5oZWFkZXItY2Fub3B5JylcbiAgICAgICAgLmRpcmVjdGl2ZSgndWlIZWFkZXJDYW5vcHlQcm9maWxlJywgdWlIZWFkZXJDYW5vcHlQcm9maWxlKTtcblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgdGVtcGxhdGVVcmw6IHN0cmluZywgbGluazogbGlua319XG4gICAgICovXG4gICAgZnVuY3Rpb24gdWlIZWFkZXJDYW5vcHlQcm9maWxlKCkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC91aS9oZWFkZXItY2Fub3B5L2hlYWRlci1jYW5vcHktcHJvZmlsZS5odG1sJyxcbiAgICAgICAgICAgIGxpbms6IGxpbmtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG4gICAgICAgICAgICBpZiAoYXR0cnMudXNlcikge1xuICAgICAgICAgICAgICAgIHZhciB1c2VyID0gc2NvcGUuJGV2YWwoYXR0cnMudXNlcik7XG5cbiAgICAgICAgICAgICAgICBzY29wZS5uYW1lID0gdXNlci5uYW1lO1xuICAgICAgICAgICAgICAgIHNjb3BlLmJpbyA9IHVzZXIuYmlvO1xuICAgICAgICAgICAgICAgIHNjb3BlLnByb2ZpbGVJbWFnZSA9IHVzZXIucHJvZmlsZUltYWdlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTWlzc2luZyB1c2VyIGF0dHJpYnV0ZSBpbiBoZWFkZXItY2Fub3B5LXByb2ZpbGUgZGlyZWN0aXZlIScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCd1aS5tb2RhbCcpXHJcbiAgICAgICAgLmZhY3RvcnkoJ21vZGFsU2VydmljZScsIG1vZGFsU2VydmljZSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XHJcbiAgICAgKi9cclxuICAgIG1vZGFsU2VydmljZS4kaW5qZWN0ID0gWyckdWliTW9kYWwnXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSAkdWliTW9kYWxcclxuICAgICAqIEByZXR1cm5zIHt7c2hvd01vZGFsOiBzaG93TW9kYWwsIHNob3c6IHNob3d9fVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBtb2RhbFNlcnZpY2UoJHVpYk1vZGFsKSB7XHJcbiAgICAgICAgdmFyIG1vZGFsRGVmYXVsdHMgPSB7XHJcbiAgICAgICAgICAgIGJhY2tkcm9wOiB0cnVlLFxyXG4gICAgICAgICAgICBrZXlib2FyZDogdHJ1ZSxcclxuICAgICAgICAgICAgYW5pbWF0aW9uOiBmYWxzZSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvdWkvbW9kYWwvbW9kYWwuaHRtbCdcclxuICAgICAgICB9LCBtb2RhbE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGNsb3NlQnV0dG9uVGV4dDogJ0NhbmNlbCcsXHJcbiAgICAgICAgICAgIGFjdGlvbkJ1dHRvblRleHQ6ICdDb250aW51ZScsXHJcbiAgICAgICAgICAgIGhlYWRlclRleHQ6ICdBcmUgeW91IHN1cmU/JyxcclxuICAgICAgICAgICAgYm9keVRleHQ6ICdUaGlzIGFjdGlvbiBtYXkgYmUgaXJyZXZlcnNpYmxlLidcclxuICAgICAgICB9LCBzZXJ2aWNlID0ge1xyXG4gICAgICAgICAgICBzaG93TW9kYWw6IHNob3dNb2RhbCxcclxuICAgICAgICAgICAgc2hvdzogc2hvd1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBzaG93TW9kYWwoY3VzdG9tTW9kYWxEZWZhdWx0cywgY3VzdG9tTW9kYWxPcHRpb25zKSB7XHJcbiAgICAgICAgICAgIGlmICghY3VzdG9tTW9kYWxEZWZhdWx0cykgY3VzdG9tTW9kYWxEZWZhdWx0cyA9IHt9O1xyXG5cclxuICAgICAgICAgICAgY3VzdG9tTW9kYWxEZWZhdWx0cy5iYWNrZHJvcCA9ICdzdGF0aWMnO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2Uuc2hvdyhjdXN0b21Nb2RhbERlZmF1bHRzLCBjdXN0b21Nb2RhbE9wdGlvbnMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2hvdyhjdXN0b21Nb2RhbERlZmF1bHRzLCBjdXN0b21Nb2RhbE9wdGlvbnMpIHtcclxuICAgICAgICAgICAgLy8gQ3JlYXRlIHRlbXAgb2JqZWN0cyB0byB3b3JrIHdpdGggc2luY2Ugd2UncmUgaW4gYSBzaW5nbGV0b24gc2VydmljZVxyXG4gICAgICAgICAgICB2YXIgdGVtcE1vZGFsRGVmYXVsdHMgPSB7fTtcclxuICAgICAgICAgICAgdmFyIHRlbXBNb2RhbE9wdGlvbnMgPSB7fTtcclxuXHJcbiAgICAgICAgICAgIC8vIE1hcCBhbmd1bGFyLXVpIG1vZGFsIGN1c3RvbSBkZWZhdWx0cyB0byBtb2RhbCBkZWZhdWx0cyBkZWZpbmVkIGluIHNlcnZpY2VcclxuICAgICAgICAgICAgYW5ndWxhci5leHRlbmQodGVtcE1vZGFsRGVmYXVsdHMsIG1vZGFsRGVmYXVsdHMsIGN1c3RvbU1vZGFsRGVmYXVsdHMpO1xyXG5cclxuICAgICAgICAgICAgLy8gTWFwIG1vZGFsLmh0bWwgJHNjb3BlIGN1c3RvbSBwcm9wZXJ0aWVzIHRvIGRlZmF1bHRzIGRlZmluZSBpbiBzZXJ2aWNlXHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKHRlbXBNb2RhbE9wdGlvbnMsIG1vZGFsT3B0aW9ucywgY3VzdG9tTW9kYWxPcHRpb25zKTtcclxuXHJcbiAgICAgICAgICAgIGlmICghdGVtcE1vZGFsRGVmYXVsdHMuY29udHJvbGxlcikge1xyXG4gICAgICAgICAgICAgICAgdGVtcE1vZGFsRGVmYXVsdHMuY29udHJvbGxlciA9IHRlbXBNb2RhbERlZmF1bHRzQ3RybDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGVtcE1vZGFsRGVmYXVsdHNDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckdWliTW9kYWxJbnN0YW5jZSddO1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gdGVtcE1vZGFsRGVmYXVsdHNDdHJsKCRzY29wZSwgJHVpYk1vZGFsSW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tb2RhbE9wdGlvbnMgPSB0ZW1wTW9kYWxPcHRpb25zO1xyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5tb2RhbE9wdGlvbnMub2sgPSBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHVpYk1vZGFsSW5zdGFuY2UuY2xvc2UocmVzKTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsT3B0aW9ucy5jbG9zZSA9IGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAkdWliTW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiAkdWliTW9kYWwub3Blbih0ZW1wTW9kYWxEZWZhdWx0cykucmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ3VpLm1lc3NhZ2UnKVxyXG4gICAgICAgIC5kaXJlY3RpdmUoJ3VpTWVzc2FnZScsIHVpTWVzc2FnZSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XHJcbiAgICAgKi9cclxuICAgIHVpTWVzc2FnZS4kaW5qZWN0ID0gWyckdGltZW91dCddO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtICR0aW1lb3V0XHJcbiAgICAgKiBAcGFyYW0gJHdpbmRvd1xyXG4gICAgICogQHJldHVybnMge3tyZXN0cmljdDogc3RyaW5nLCB0ZW1wbGF0ZVVybDogc3RyaW5nLCByZXBsYWNlOiBib29sZWFuLCBsaW5rOiBsaW5rfX1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gdWlNZXNzYWdlKCR0aW1lb3V0KSB7XHJcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvdWkvbWVzc2FnZS9tZXNzYWdlLmh0bWwnLFxyXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICBsaW5rOiBsaW5rXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbSwgYXR0cnMpIHtcclxuICAgICAgICAgICAgc2NvcGUuJG9uKCdtZXNzYWdlJywgZnVuY3Rpb24gKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBzY29wZS5tZXNzYWdlID0gZGF0YS5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgc2xpZGVEb3duKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlVXAoKTtcclxuICAgICAgICAgICAgICAgIH0sIDUwMDApO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHNsaWRlRG93bigpIHtcclxuICAgICAgICAgICAgICAgIGVsZW0uYW5pbWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wOiAnMHB4J1xyXG4gICAgICAgICAgICAgICAgfSwgMTAwKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gc2xpZGVVcCgpIHtcclxuICAgICAgICAgICAgICAgIGVsZW0uYW5pbWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wOiAnLTUwMHB4J1xyXG4gICAgICAgICAgICAgICAgfSwgMTAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd1aS5wcm9maWxlLWNhcmQnKVxuICAgICAgICAuZGlyZWN0aXZlKCd1aVByb2ZpbGVDYXJkU20nLCB1aVByb2ZpbGVDYXJkU20pO1xuXG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3tyZXN0cmljdDogc3RyaW5nLCB0ZW1wbGF0ZVVybDogc3RyaW5nLCBsaW5rOiBsaW5rfX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1aVByb2ZpbGVDYXJkU20oKSB7XG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0VBJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3VpL3Byb2ZpbGUtY2FyZC9wcm9maWxlLWNhcmQtc20uaHRtbCcsXG4gICAgICAgICAgICBsaW5rOiBsaW5rXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgICAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtLCBhdHRycykge1xuICAgICAgICAgICAgaWYgKGF0dHJzLnVzZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHNjb3BlLiRldmFsKGF0dHJzLnVzZXIpO1xuICAgICAgICAgICAgICAgIHZhciBhcnRpY2xlRGF0ZSA9IGF0dHJzLmFydGljbGVEYXRlO1xuICAgICAgICAgICAgICAgIHZhciB2aWV3Q291bnQgPSBhdHRycy52aWV3Q291bnQ7XG5cbiAgICAgICAgICAgICAgICBzY29wZS5wcm9maWxlSW1hZ2UgPSB1c2VyLnByb2ZpbGVJbWFnZTtcbiAgICAgICAgICAgICAgICBzY29wZS51c2VybmFtZSA9IHVzZXIudXNlcm5hbWU7XG4gICAgICAgICAgICAgICAgc2NvcGUubmFtZSA9IHVzZXIubmFtZTtcbiAgICAgICAgICAgICAgICBzY29wZS5iaW8gPSB1c2VyLmJpbztcbiAgICAgICAgICAgICAgICBzY29wZS5kYXRlID0gYXJ0aWNsZURhdGU7XG4gICAgICAgICAgICAgICAgc2NvcGUudmlld0NvdW50ID0gdmlld0NvdW50O1xuICAgICAgICAgICAgICAgIHNjb3BlLmhvdmVyVGVtcGxhdGUgPSAnPGRpdiBjbGFzcz1cInByb2ZpbGUtY2FyZC1ob3ZlclwiPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInByb2ZpbGUtY2FyZC1ob3Zlci0tY29udGVudFwiPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxhIGhyZWY9XCIvQCcgKyBzY29wZS51c2VybmFtZSArICdcIj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGgxPicgKyBzY29wZS5uYW1lICsgJzwvaDE+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9hPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxwPicgKyBzY29wZS5iaW8gKyAnPC9wPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwicHJvZmlsZS1jYXJkLWhvdmVyLS1pbWFnZVwiPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxhIGhyZWY9XCIvQCcgKyBzY29wZS51c2VybmFtZSArICdcIiB0aXRsZT1cIlZpZXcgdGhlIHByb2ZpbGUgb2YgJyArIHNjb3BlLm5hbWUgKyAnXCI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxpbWcgY2xhc3M9XCJhdmF0YXIgbWRcIiBzcmM9XCInICsgc2NvcGUucHJvZmlsZUltYWdlICsgJ1wiPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvYT4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNsZWFyZml4XCI+PC9kaXY+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwicHJvZmlsZS1jYXJkLWhvdmVyLS1mb290ZXJcIj4nICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YSBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSB0ZXh0LWNlbnRlclwiIGhyZWY9XCIvQCcgKyBzY29wZS51c2VybmFtZSArICdcIj5WaXNpdCBwcm9maWxlPC9hPicgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2Pic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3VpLnByb2ZpbGUtY2FyZCcpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3VpUHJvZmlsZUNhcmQnLCB1aVByb2ZpbGVDYXJkKTtcblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgdGVtcGxhdGVVcmw6IHN0cmluZywgbGluazogbGlua319XG4gICAgICovXG4gICAgZnVuY3Rpb24gdWlQcm9maWxlQ2FyZCgpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvdWkvcHJvZmlsZS1jYXJkL3Byb2ZpbGUtY2FyZC5odG1sJyxcbiAgICAgICAgICAgIGxpbms6IGxpbmtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG4gICAgICAgICAgICBpZiAoYXR0cnMudXNlcikge1xuICAgICAgICAgICAgICAgIHZhciB1c2VyID0gc2NvcGUuJGV2YWwoYXR0cnMudXNlcik7XG5cbiAgICAgICAgICAgICAgICBzY29wZS5wcm9maWxlSW1hZ2UgPSB1c2VyLnByb2ZpbGVJbWFnZTtcbiAgICAgICAgICAgICAgICBzY29wZS51c2VybmFtZSA9IHVzZXIudXNlcm5hbWU7XG4gICAgICAgICAgICAgICAgc2NvcGUubmFtZSA9IHVzZXIubmFtZTtcbiAgICAgICAgICAgICAgICBzY29wZS5iaW8gPSB1c2VyLmJpbztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndWkubmF2YmFyJywgW10pXG4gICAgICAgIC5kaXJlY3RpdmUoJ3VpTmF2U2Nyb2xsJywgdWlOYXZTY3JvbGwpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIHVpTmF2U2Nyb2xsLiRpbmplY3QgPSBbJyR3aW5kb3cnLCAnJHRpbWVvdXQnXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkd2luZG93XG4gICAgICogQHBhcmFtICR0aW1lb3V0XG4gICAgICogQHJldHVybnMge3tyZXN0cmljdDogc3RyaW5nLCBsaW5rOiBsaW5rfX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1aU5hdlNjcm9sbCgkd2luZG93LCAkdGltZW91dCkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0gIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICBsaW5rOiBsaW5rXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgICAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgd2luZG93RWwgPSBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdyk7XG4gICAgICAgICAgICB2YXIgZGVsdGEgPSA1MDtcbiAgICAgICAgICAgIHZhciBsYXN0U2Nyb2xsVG9wID0gMDtcblxuICAgICAgICAgICAgZWxlbWVudC5iaW5kKCdtb3VzZW92ZXInLCBtb3VzZW92ZXIpO1xuXG4gICAgICAgICAgICB3aW5kb3dFbC5vbignc2Nyb2xsJywgc2Nyb2xsKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gbW91c2VvdmVyKCkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2Nsb3NlZCcpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuICR0aW1lb3V0KChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdmVyZmxvdzogJ3Zpc2libGUnXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pLCAxNTApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBzY3JvbGwoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0ID0gd2luZG93RWwuc2Nyb2xsVG9wKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBhdCB0b3Agb2YgcGFnZVxuICAgICAgICAgICAgICAgIGlmIChzdCA9PT0gMClcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnc2hhZG93Jyk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdzaGFkb3cnKTtcblxuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhsYXN0U2Nyb2xsVG9wIC0gc3QpIDw9IGRlbHRhKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBzY3JvbGxpbmcgZG93blxuICAgICAgICAgICAgICAgIGlmIChzdCA+IGxhc3RTY3JvbGxUb3ApXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ2Nsb3NlZCcpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnY2xvc2VkJyk7XG5cblxuICAgICAgICAgICAgICAgIGxhc3RTY3JvbGxUb3AgPSBzdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndWkubmF2YmFyJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ05hdmJhckNvbnRyb2xsZXInLCBOYXZiYXJDb250cm9sbGVyKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBOYXZiYXJDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzdGF0ZScsICckc2NvcGUnXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkc3RhdGVcbiAgICAgKiBAcGFyYW0gJHNjb3BlXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgZnVuY3Rpb24gTmF2YmFyQ29udHJvbGxlcigkc3RhdGUsICRzY29wZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS53cml0aW5nID0gZmFsc2U7XG4gICAgICAgIHZtLnNlYXJjaCA9IHNlYXJjaDtcbiAgICAgICAgdm0ucSA9ICcnO1xuXG4gICAgICAgIGZ1bmN0aW9uIHNlYXJjaCgpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnYXBwLnNlYXJjaC5yZXN1bHRzJywge3E6IHZtLnF9KTtcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJHN0YXRlLmN1cnJlbnQubmFtZTtcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2bS53cml0aW5nID0gJHN0YXRlLmN1cnJlbnQubmFtZSA9PSAnYXBwLndyaXRlJyB8fCAkc3RhdGUuY3VycmVudC5uYW1lID09ICdhcHAuZWRpdCc7XG5cbiAgICAgICAgICAgIGlmICgkc3RhdGUuY3VycmVudC5uYW1lID09PSAnYXBwLmhvbWUnKSB7XG4gICAgICAgICAgICAgICAgdm0uYWRkQm94ZWRMYXlvdXQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2bS5hZGRCb3hlZExheW91dCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3VpLm5hdmJhcicpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3VpTmF2YmFyJywgdWlOYXZiYXIpO1xuXG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3tyZXN0cmljdDogc3RyaW5nLCB0ZW1wbGF0ZVVybDogc3RyaW5nLCBjb250cm9sbGVyOiBzdHJpbmd9fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVpTmF2YmFyKCkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC91aS9uYXZiYXIvbmF2YmFyLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ05hdmJhckNvbnRyb2xsZXIgYXMgdm0nXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3VpLnN1YnZpZXctbWVudScpXG4gICAgICAgIC5jb250cm9sbGVyKCdTdWJ2aWV3TWVudUNvbnRyb2xsZXInLCBTdWJ2aWV3TWVudUNvbnRyb2xsZXIpO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIFN1YnZpZXdNZW51Q29udHJvbGxlci4kaW5qZWN0ID0gWydzdWJ2aWV3TWVudVNlcnZpY2UnLCAnJHNjb3BlJywgJyRzdGF0ZVBhcmFtcycsICckc3RhdGUnXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSBzdWJ2aWV3TWVudVNlcnZpY2VcbiAgICAgKiBAcGFyYW0gJHNjb3BlXG4gICAgICogQHBhcmFtICRzdGF0ZVBhcmFtc1xuICAgICAqIEBwYXJhbSAkc3RhdGVcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBTdWJ2aWV3TWVudUNvbnRyb2xsZXIoc3Vidmlld01lbnVTZXJ2aWNlLCAkc2NvcGUsICRzdGF0ZVBhcmFtcywgJHN0YXRlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLm1lbnUgPSBbXTtcbiAgICAgICAgdm0uZ28gPSBnbztcblxuICAgICAgICAvLyBXYXRjaCB0aGUgY2hhbmdlIG9mIHRoZSBwYXJlbnQgc3RhdGUgb2YgdGhlIHN1YnZpZXdzICB0b1xuICAgICAgICAvLyBzZWxlY3QgdGhlIHByb3BlciBtZW51IGJhc2VkIG9uIHRoZSAkc3RhdGVQYXJhbXMubWVudSB2YWx1ZS5cbiAgICAgICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAkc3RhdGVQYXJhbXMubWVudTtcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2bS5tZW51ID0gc3Vidmlld01lbnVTZXJ2aWNlLmdldE1lbnUoJHN0YXRlUGFyYW1zLm1lbnUpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBXYXRjaCB0aGUgY2hhbmdlIG9mIHRoZSBzdWJ2aWV3IHN0YXRlIGFuZCBoaWdobGlnaHQgdGhlIHRhYlxuICAgICAgICAvLyB0aGF0IGhhcyB0aGUgc3RhdGUgdmFsdWUgb2YgdGhlIGN1cnJlbnQgc3VidmlldyBzdGF0ZS5cbiAgICAgICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAkc3RhdGUuY3VycmVudC5uYW1lO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGhpZ2hsaWdodFNlbGVjdGVkVGFiKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIGhpZ2hsaWdodFNlbGVjdGVkVGFiKCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2bS5tZW51Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZtLm1lbnVbaV0uc3RhdGUgPT0gJHN0YXRlLmN1cnJlbnQubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgdm0ubWVudVtpXS5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB2bS5tZW51W2ldLnNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnbyh0YWIpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbyh0YWIuc3RhdGUpO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd1aS5zdWJ2aWV3LW1lbnUnKVxuICAgICAgICAuZGlyZWN0aXZlKCd1aVN1YnZpZXdNZW51JywgdWlTdWJ2aWV3TWVudSk7XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7e3Jlc3RyaWN0OiBzdHJpbmcsIHRlbXBsYXRlVXJsOiBzdHJpbmcsIGNvbnRyb2xsZXI6IHN0cmluZ319XG4gICAgICovXG4gICAgZnVuY3Rpb24gdWlTdWJ2aWV3TWVudSgpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9ICB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0VBJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3VpL3N1YnZpZXctbWVudS9zdWJ2aWV3LW1lbnUuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnU3Vidmlld01lbnVDb250cm9sbGVyIGFzIHZtJ1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndWkuc3Vidmlldy1tZW51JylcbiAgICAgICAgLmZhY3RvcnkoJ3N1YnZpZXdNZW51U2VydmljZScsIHN1YnZpZXdNZW51U2VydmljZSk7XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7e2dldE1lbnU6IGdldE1lbnV9fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHN1YnZpZXdNZW51U2VydmljZSgpIHtcbiAgICAgICAgdmFyIGFsbE1lbnVzID0ge1xuICAgICAgICAgICAgICAgICdzZXR0aW5ncyc6IFtcbiAgICAgICAgICAgICAgICAgICAgeydzdGF0ZSc6ICdhcHAubWUuc2V0dGluZ3MuYWNjb3VudCcsICdsYWJlbCc6ICdBY2NvdW50Jywgc2VsZWN0ZWQ6IGZhbHNlfSxcbiAgICAgICAgICAgICAgICAgICAgeydzdGF0ZSc6ICdhcHAubWUuc2V0dGluZ3MucGFzc3dvcmQnLCAnbGFiZWwnOiAnUGFzc3dvcmQnLCBzZWxlY3RlZDogZmFsc2V9XG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAnc3Rvcmllcyc6IFtcbiAgICAgICAgICAgICAgICAgICAgeydzdGF0ZSc6ICdhcHAubWUuc3Rvcmllcy5kcmFmdHMnLCAnbGFiZWwnOiAnRHJhZnRzJywgc2VsZWN0ZWQ6IGZhbHNlfSxcbiAgICAgICAgICAgICAgICAgICAgeydzdGF0ZSc6ICdhcHAubWUuc3Rvcmllcy5wdWJsaXNoZWQnLCAnbGFiZWwnOiAnUHVibGlzaGVkJywgc2VsZWN0ZWQ6IGZhbHNlfSxcbiAgICAgICAgICAgICAgICAgICAgeydzdGF0ZSc6ICdhcHAubWUuc3Rvcmllcy51bnB1Ymxpc2hlZCcsICdsYWJlbCc6ICdVbnB1Ymxpc2hlZCcsIHNlbGVjdGVkOiBmYWxzZX1cbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VydmljZSA9IHtcbiAgICAgICAgICAgICAgICBnZXRNZW51OiBnZXRNZW51XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldE1lbnUoY3VycmVudE1lbnUpIHtcbiAgICAgICAgICAgIHJldHVybiBhbGxNZW51c1tjdXJyZW50TWVudV07XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3VpLnNjcm9sbC10by10b3Atd2hlbicpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3VpU2Nyb2xsVG9Ub3BXaGVuJywgdWlTY3JvbGxUb1RvcFdoZW4pO1xuXG4gICAgLyoqXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxuICAgICAqL1xuICAgIHVpU2Nyb2xsVG9Ub3BXaGVuLiRpbmplY3QgPSBbJyR0aW1lb3V0J107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gJHRpbWVvdXRcbiAgICAgKiBAcmV0dXJucyB7e3Jlc3RyaWN0OiBzdHJpbmcsIGxpbms6IGxpbmt9fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVpU2Nyb2xsVG9Ub3BXaGVuKCR0aW1lb3V0KSB7XG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgbGluazogbGlua1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICAgICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbSwgYXR0cnMpIHtcbiAgICAgICAgICAgIHNjb3BlLiRvbihhdHRycy5zY3JvbGxUb1RvcFdoZW4sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGVsZW0pWzBdLnNjcm9sbFRvcCA9IDA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndWkud2lkZ2V0JylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1dpZGdldEZvb3RlckNvbnRyb2xsZXInLCBXaWRnZXRGb290ZXJDb250cm9sbGVyKTtcblxuICAgIC8qKlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFdpZGdldEZvb3RlckNvbnRyb2xsZXIoKSB7fVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd1aS53aWRnZXQnKVxuICAgICAgICAuZGlyZWN0aXZlKCd1aVdpZGdldEZvb3RlcicsIHVpV2lkZ2V0Rm9vdGVyKTtcblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgc2NvcGU6IHtzdWJtaXQ6IHN0cmluZ30sIGJpbmRUb0NvbnRyb2xsZXI6IGJvb2xlYW4sIGNvbnRyb2xsZXI6IHN0cmluZywgdGVtcGxhdGVVcmw6IHN0cmluZywgbGluazogbGlua319XG4gICAgICovXG4gICAgZnVuY3Rpb24gdWlXaWRnZXRGb290ZXIoKSB7XG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBzdWJtaXQ6ICc9J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnV2lkZ2V0Rm9vdGVyQ29udHJvbGxlciBhcyB2bScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC91aS93aWRnZXQvd2lkZ2V0LWZvb3Rlci5odG1sJyxcbiAgICAgICAgICAgIGxpbms6IGxpbmtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG4gICAgICAgICAgICBzY29wZS50ZXh0ID0gYXR0cnMudGV4dCB8fCBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd1aS53aWRnZXQnKVxuICAgICAgICAuZGlyZWN0aXZlKCd1aVdpZGdldEhlYWRlcicsIHVpV2lkZ2V0SGVhZGVyKTtcblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgdGVtcGxhdGVVcmw6IHN0cmluZywgbGluazogbGlua319XG4gICAgICovXG4gICAgZnVuY3Rpb24gdWlXaWRnZXRIZWFkZXIoKSB7XG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvdWkvd2lkZ2V0L3dpZGdldC1oZWFkZXIuaHRtbCcsXG4gICAgICAgICAgICBsaW5rOiBsaW5rXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgICAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtLCBhdHRycykge1xuICAgICAgICAgICAgc2NvcGUudGl0bGUgPSBhdHRycy50aXRsZSB8fCBudWxsO1xuICAgICAgICAgICAgc2NvcGUuZGVzY3JpcHRpb24gPSBhdHRycy5kZXNjcmlwdGlvbiB8fCBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCd1aS50b2dnbGUtYWN0aXZlJylcclxuICAgICAgICAuZGlyZWN0aXZlKCd1aVRvZ2dsZUFjdGl2ZScsIHVpVG9nZ2xlQWN0aXZlKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEByZXR1cm5zIHt7cmVzdHJpY3Q6IHN0cmluZywgbGluazogbGlua319XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHVpVG9nZ2xlQWN0aXZlKCkge1xyXG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgICAgIGxpbms6IGxpbmtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtKSB7XHJcbiAgICAgICAgICAgIGVsZW0uYmluZCgnY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGVsZW0udG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KSgpOyIsIihmdW5jdGlvbigpIHsgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCd1aS53aGVuLXNjcm9sbGVkJylcclxuICAgICAgICAuZGlyZWN0aXZlKCd1aVdoZW5TY3JvbGxlZCcsIHVpV2hlblNjcm9sbGVkKTtcclxuXHJcbiAgICB1aVdoZW5TY3JvbGxlZC4kaW5qZWN0ID0gWyckd2luZG93JywgJyRkb2N1bWVudCddO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHJldHVybnMge3tyZXN0cmljdDogc3RyaW5nLCBsaW5rOiBsaW5rfX1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gdWlXaGVuU2Nyb2xsZWQoJHdpbmRvdywgJGRvY3VtZW50KSB7XHJcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICAgICAgbGluazogbGlua1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIHZhciB3aW5kb3dFbCA9IGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KSxcclxuICAgICAgICAgICAgICAgIGNhbkxvYWRPblNjcm9sbCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICB3aW5kb3dFbC5vbignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FuTG9hZE9uU2Nyb2xsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCh3aW5kb3dFbC5zY3JvbGxUb3AoKSArIHdpbmRvd0VsLmhlaWdodCgpKSA+PSAoJGRvY3VtZW50LmhlaWdodCgpIC8gMikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FuTG9hZE9uU2Nyb2xsID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShhdHRycy51aVdoZW5TY3JvbGxlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHNjb3BlLiRvbignc3Rvcmllczpsb2FkZWQnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNhbkxvYWRPblNjcm9sbCA9IHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdzdG9yaWVzJylcclxuICAgICAgICAuY29udHJvbGxlcignRHJhZnRzQ29udHJvbGxlcicsIERyYWZ0c0NvbnRyb2xsZXIpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxyXG4gICAgICovXHJcbiAgICBEcmFmdHNDb250cm9sbGVyLiRpbmplY3QgPSBbJ2RyYWZ0c1Jlc29sdmVyJywgJ21lU3Rvcmllc1NlcnZpY2UnLCAnYXJ0aWNsZVNlcnZpY2UnLCAnbW9kYWxTZXJ2aWNlJywgJyRyb290U2NvcGUnXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBkcmFmdHNSZXNvbHZlclxyXG4gICAgICogQHBhcmFtIG1lU3Rvcmllc1NlcnZpY2VcclxuICAgICAqIEBwYXJhbSBhcnRpY2xlU2VydmljZVxyXG4gICAgICogQHBhcmFtIG1vZGFsU2VydmljZVxyXG4gICAgICogQHBhcmFtICRyb290U2NvcGVcclxuICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBEcmFmdHNDb250cm9sbGVyKGRyYWZ0c1Jlc29sdmVyLCBtZVN0b3JpZXNTZXJ2aWNlLCBhcnRpY2xlU2VydmljZSwgbW9kYWxTZXJ2aWNlLCAkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2bS5kcmFmdHMgPSBkcmFmdHNSZXNvbHZlci5kcmFmdHM7XHJcbiAgICAgICAgdm0ubWVzc2FnZSA9IGRyYWZ0c1Jlc29sdmVyLm1lc3NhZ2UgfHwgXCJZb3UgaGF2ZSBubyBkcmFmdHMuXCI7XHJcbiAgICAgICAgdm0uZm9yY2VEZWxldGUgPSBmb3JjZURlbGV0ZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZm9yY2VEZWxldGUoc2x1Zykge1xyXG4gICAgICAgICAgICB2YXIgbW9kYWxPcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgYWN0aW9uQnV0dG9uVGV4dDogJ0RlbGV0ZScsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJUZXh0OiAnRGVsZXRlJyxcclxuICAgICAgICAgICAgICAgIGJvZHlUZXh0OiAnRGVsZXRlZCBkcmFmdHMgYXJlIGdvbmUgZm9yZXZlci4gQXJlIHlvdSBzdXJlPydcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIG1vZGFsU2VydmljZVxyXG4gICAgICAgICAgICAgICAgLnNob3dNb2RhbCh7fSwgbW9kYWxPcHRpb25zKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFydGljbGVTZXJ2aWNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JjZURlbGV0ZShzbHVnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lU3Rvcmllc1NlcnZpY2UucmVtb3ZlRnJvbUNvbGxlY3Rpb24odm0uZHJhZnRzLCBzbHVnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ21lc3NhZ2UnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogcmVzLm1lc3NhZ2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdzdG9yaWVzJylcclxuICAgICAgICAuY29udHJvbGxlcignUHVibGlzaGVkQ29udHJvbGxlcicsIFB1Ymxpc2hlZENvbnRyb2xsZXIpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHR5cGUge3N0cmluZ1tdfVxyXG4gICAgICovXHJcbiAgICBQdWJsaXNoZWRDb250cm9sbGVyLiRpbmplY3QgPSBbJ3B1Ymxpc2hlZFJlc29sdmVyJywgJ21lU3Rvcmllc1NlcnZpY2UnLCAnYXJ0aWNsZVNlcnZpY2UnLCAnbW9kYWxTZXJ2aWNlJywgJyRyb290U2NvcGUnXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBwdWJsaXNoZWRSZXNvbHZlclxyXG4gICAgICogQHBhcmFtIG1lU3Rvcmllc1NlcnZpY2VcclxuICAgICAqIEBwYXJhbSBhcnRpY2xlU2VydmljZVxyXG4gICAgICogQHBhcmFtIG1vZGFsU2VydmljZVxyXG4gICAgICogQHBhcmFtICRyb290U2NvcGVcclxuICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBQdWJsaXNoZWRDb250cm9sbGVyKHB1Ymxpc2hlZFJlc29sdmVyLCBtZVN0b3JpZXNTZXJ2aWNlLCBhcnRpY2xlU2VydmljZSwgbW9kYWxTZXJ2aWNlLCAkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2bS5hcnRpY2xlcyA9IHB1Ymxpc2hlZFJlc29sdmVyLmFydGljbGVzO1xyXG4gICAgICAgIHZtLm1lc3NhZ2UgPSBwdWJsaXNoZWRSZXNvbHZlci5tZXNzYWdlIHx8IFwiWW91IGhhdmVuJ3QgcHVibGlzaGVkIGFueSBzdG9yaWVzIHlldC5cIjtcclxuICAgICAgICB2bS51bnB1Ymxpc2ggPSB1bnB1Ymxpc2g7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHVucHVibGlzaChzbHVnKSB7XHJcbiAgICAgICAgICAgIHZtLmFydGljbGVTbHVnID0gc2x1ZztcclxuXHJcbiAgICAgICAgICAgIHZhciBtb2RhbE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICBhY3Rpb25CdXR0b25UZXh0OiAnVW5wdWJsaXNoJyxcclxuICAgICAgICAgICAgICAgIGhlYWRlclRleHQ6ICdVbnB1Ymxpc2gnLFxyXG4gICAgICAgICAgICAgICAgYm9keVRleHQ6ICdVbnB1Ymxpc2hlZCBzdG9yaWVzIGFyZSBoaWRkZW4gZnJvbSB0aGUgcHVibGljLidcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIG1vZGFsU2VydmljZVxyXG4gICAgICAgICAgICAgICAgLnNob3dNb2RhbCh7fSwgbW9kYWxPcHRpb25zKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJ0aWNsZVNlcnZpY2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnVucHVibGlzaChzbHVnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lU3Rvcmllc1NlcnZpY2UucmVtb3ZlRnJvbUNvbGxlY3Rpb24odm0uYXJ0aWNsZXMsIHNsdWcpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbWVzc2FnZScsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiByZXMubWVzc2FnZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdzdG9yaWVzJylcclxuICAgICAgICAuY29udHJvbGxlcignVW5wdWJsaXNoZWRDb250cm9sbGVyJywgVW5wdWJsaXNoZWRDb250cm9sbGVyKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cclxuICAgICAqL1xyXG4gICAgVW5wdWJsaXNoZWRDb250cm9sbGVyLiRpbmplY3QgPSBbJ3VucHVibGlzaGVkUmVzb2x2ZXInLCAnbWVTdG9yaWVzU2VydmljZScsICdhcnRpY2xlU2VydmljZScsICdtb2RhbFNlcnZpY2UnLCAnJHJvb3RTY29wZSddO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIHVucHVibGlzaGVkUmVzb2x2ZXJcclxuICAgICAqIEBwYXJhbSBtZVN0b3JpZXNTZXJ2aWNlXHJcbiAgICAgKiBAcGFyYW0gYXJ0aWNsZVNlcnZpY2VcclxuICAgICAqIEBwYXJhbSBtb2RhbFNlcnZpY2VcclxuICAgICAqIEBwYXJhbSAkcm9vdFNjb3BlXHJcbiAgICAgKiBAY29uc3RydWN0b3JcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gVW5wdWJsaXNoZWRDb250cm9sbGVyKHVucHVibGlzaGVkUmVzb2x2ZXIsIG1lU3Rvcmllc1NlcnZpY2UsIGFydGljbGVTZXJ2aWNlLCBtb2RhbFNlcnZpY2UsICRyb290U2NvcGUpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZtLmFydGljbGVzID0gdW5wdWJsaXNoZWRSZXNvbHZlci5hcnRpY2xlcztcclxuICAgICAgICB2bS5tZXNzYWdlID0gdW5wdWJsaXNoZWRSZXNvbHZlci5tZXNzYWdlIHx8IFwiWW91IGRvbid0IGhhdmUgYW55IHVucHVibGlzaGVkIHN0b3JpZXMuXCI7XHJcbiAgICAgICAgdm0ucHVibGlzaCA9IHB1Ymxpc2g7XHJcbiAgICAgICAgdm0uZm9yY2VEZWxldGUgPSBmb3JjZURlbGV0ZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcHVibGlzaChzbHVnKSB7XHJcbiAgICAgICAgICAgIHZhciBtb2RhbE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICBhY3Rpb25CdXR0b25UZXh0OiAnUHVibGlzaCcsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJUZXh0OiAnUHVibGlzaCcsXHJcbiAgICAgICAgICAgICAgICBib2R5VGV4dDogJ1B1Ymxpc2hlZCBzdG9yaWVzIGFyZSB2aWV3YWJsZSBieSB0aGUgcHVibGljLidcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIG1vZGFsU2VydmljZVxyXG4gICAgICAgICAgICAgICAgLnNob3dNb2RhbCh7fSwgbW9kYWxPcHRpb25zKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFydGljbGVTZXJ2aWNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wdWJsaXNoKHNsdWcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVTdG9yaWVzU2VydmljZS5yZW1vdmVGcm9tQ29sbGVjdGlvbih2bS5hcnRpY2xlcywgc2x1Zyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdtZXNzYWdlJywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5tZXNzYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGZvcmNlRGVsZXRlKHNsdWcpIHtcclxuICAgICAgICAgICAgdmFyIG1vZGFsT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgIGFjdGlvbkJ1dHRvblRleHQ6ICdEZWxldGUnLFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyVGV4dDogJ0RlbGV0ZScsXHJcbiAgICAgICAgICAgICAgICBib2R5VGV4dDogJ0RlbGV0ZWQgc3RvcmllcyBhcmUgZ29uZSBmb3JldmVyLiBBcmUgeW91IHN1cmU/J1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgbW9kYWxTZXJ2aWNlXHJcbiAgICAgICAgICAgICAgICAuc2hvd01vZGFsKHt9LCBtb2RhbE9wdGlvbnMpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJ0aWNsZVNlcnZpY2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmNlRGVsZXRlKHNsdWcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVTdG9yaWVzU2VydmljZS5yZW1vdmVGcm9tQ29sbGVjdGlvbih2bS5hcnRpY2xlcywgc2x1Zyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdtZXNzYWdlJywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5tZXNzYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnc2V0dGluZ3MnKVxuICAgICAgICAuY29udHJvbGxlcignU2V0dGluZ3NQYXNzd29yZENvbnRyb2xsZXInLCBTZXR0aW5nc1Bhc3N3b3JkQ29udHJvbGxlcik7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgU2V0dGluZ3NQYXNzd29yZENvbnRyb2xsZXIuJGluamVjdCA9IFsnJHJvb3RTY29wZScsICdzZXR0aW5nc1Bhc3N3b3JkU2VydmljZSddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICRyb290U2NvcGVcbiAgICAgKiBAcGFyYW0gc2V0dGluZ3NQYXNzd29yZFNlcnZpY2VcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBTZXR0aW5nc1Bhc3N3b3JkQ29udHJvbGxlcigkcm9vdFNjb3BlLCBzZXR0aW5nc1Bhc3N3b3JkU2VydmljZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5zdWJtaXQgPSBzdWJtaXQ7XG5cbiAgICAgICAgZnVuY3Rpb24gc3VibWl0KCkge1xuICAgICAgICAgICAgc2V0dGluZ3NQYXNzd29yZFNlcnZpY2UuY2hhbmdlUGFzc3dvcmQoe1xuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLnVzZXJuYW1lLFxuICAgICAgICAgICAgICAgIGVtYWlsOiAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLmVtYWlsLFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB2bS5wYXNzd29yZCxcbiAgICAgICAgICAgICAgICBuZXdQYXNzd29yZDogdm0ubmV3UGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgbmV3UGFzc3dvcmRDb25maXJtYXRpb246IHZtLm5ld1Bhc3N3b3JkQ29uZmlybWF0aW9uXG4gICAgICAgICAgICB9KS50aGVuKHN1Y2Nlc3MsIGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTdWNjZXNzZnVsbHkgdXBkYXRlZCBwYXNzd29yZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHJlc1xuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc3VjY2VzcyhyZXMpIHtcbiAgICAgICAgICAgIHZtLmVycm9ycyA9IFtdO1xuXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2lucHV0OnN1Y2Nlc3MnLCB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogcmVzLm1lc3NhZ2VcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEVycm9yIHVwZGF0aW5nIHBhc3N3b3JkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gcmVzXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBlcnJvcihyZXMpIHtcbiAgICAgICAgICAgIGlmIChyZXMuZGF0YSAmJiAhcmVzLmRhdGEuZXJyb3IpIHsgLy8gVmFsaWRhdGlvbiBlcnJvcnNcbiAgICAgICAgICAgICAgICB2bS5lcnJvcnMgPSByZXMuZGF0YTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh2bS5lcnJvcnMpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMuZGF0YS5lcnJvcikgeyAvLyBJbmNvcnJlY3QgcGFzc3dvcmRcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2lucHV0OmVycm9yJywge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiByZXMuZGF0YS5lcnJvci5tZXNzYWdlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdzZXR0aW5ncycpXG4gICAgICAgIC5mYWN0b3J5KCdzZXR0aW5nc1Bhc3N3b3JkU2VydmljZScsIHNldHRpbmdzUGFzc3dvcmRTZXJ2aWNlKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBzZXR0aW5nc1Bhc3N3b3JkU2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsICdjb25maWcnLCAnYXBpU2VydmljZSddO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtICRodHRwXG4gICAgICogQHBhcmFtIGNvbmZpZ1xuICAgICAqIEBwYXJhbSBhcGlTZXJ2aWNlXG4gICAgICogQHJldHVybnMge3tjaGFuZ2VQYXNzd29yZDogY2hhbmdlUGFzc3dvcmR9fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNldHRpbmdzUGFzc3dvcmRTZXJ2aWNlKCRodHRwLCBjb25maWcsIGFwaVNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBjaGFuZ2VQYXNzd29yZDogY2hhbmdlUGFzc3dvcmRcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICBmdW5jdGlvbiBjaGFuZ2VQYXNzd29yZChjcmVkZW50aWFscykge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dChjb25maWcudXJsICsgJy9zZXR0aW5ncy9wYXNzd29yZCcsIGNyZWRlbnRpYWxzKVxuICAgICAgICAgICAgICAgIC50aGVuKGFwaVNlcnZpY2UuaGFuZGxlU3VjY2VzcywgYXBpU2VydmljZS5oYW5kbGVFcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdzZXR0aW5ncycpXG4gICAgICAgIC5jb250cm9sbGVyKCdTZXR0aW5nc0FjY291bnRDb250cm9sbGVyJywgU2V0dGluZ3NBY2NvdW50Q29udHJvbGxlcik7XG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7c3RyaW5nW119XG4gICAgICovXG4gICAgU2V0dGluZ3NBY2NvdW50Q29udHJvbGxlci4kaW5qZWN0ID0gWyckcm9vdFNjb3BlJywgJ3NldHRpbmdzQWNjb3VudFNlcnZpY2UnLCAndXNlclNlcnZpY2UnXTtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSAkcm9vdFNjb3BlXG4gICAgICogQHBhcmFtIHNldHRpbmdzQWNjb3VudFNlcnZpY2VcbiAgICAgKiBAcGFyYW0gdXNlclNlcnZpY2VcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBTZXR0aW5nc0FjY291bnRDb250cm9sbGVyKCRyb290U2NvcGUsIHNldHRpbmdzQWNjb3VudFNlcnZpY2UsIHVzZXJTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLnVwZGF0ZVVzZXJuYW1lID0gdXBkYXRlVXNlcm5hbWU7XG4gICAgICAgIHZtLnVwZGF0ZUJpbyA9IHVwZGF0ZUJpbztcbiAgICAgICAgdm0udXNlcm5hbWUgPSAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLnVzZXJuYW1lO1xuICAgICAgICB2bS5iaW8gPSAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyLmJpbztcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2hhbmdlIHVzZXJzIHVzZXJuYW1lLlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlVXNlcm5hbWUoKSB7XG4gICAgICAgICAgICBzZXR0aW5nc0FjY291bnRTZXJ2aWNlXG4gICAgICAgICAgICAgICAgLnVwZGF0ZVVzZXJuYW1lKHt1c2VybmFtZTogdm0udXNlcm5hbWV9KVxuICAgICAgICAgICAgICAgIC50aGVuKHN1Y2Nlc3MsIGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDaGFuZ2UgdXNlcnMgYmlvLlxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQmlvKCkge1xuICAgICAgICAgICAgc2V0dGluZ3NBY2NvdW50U2VydmljZVxuICAgICAgICAgICAgICAgIC51cGRhdGVCaW8oe2Jpbzogdm0uYmlvfSlcbiAgICAgICAgICAgICAgICAudGhlbihzdWNjZXNzLCBlcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogU3VjY2Vzc2Z1bGx5IHVwZGF0ZWQgZGF0YS5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHJlc1xuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc3VjY2VzcyhyZXMpIHtcbiAgICAgICAgICAgIHZtLmVycm9ycyA9IFtdO1xuXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2lucHV0OnN1Y2Nlc3MnLCB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogcmVzLm1lc3NhZ2VcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB1c2VyU2VydmljZS5zZXRVc2VyKHJlcy51c2VyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFcnJvciB1cGRhdGluZyBkYXRhLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gcmVzXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBlcnJvcihyZXMpIHtcbiAgICAgICAgICAgIGlmIChyZXMuZGF0YSAmJiAhcmVzLmRhdGEuZXJyb3IpIHsgLy8gVmFsaWRhdGlvbiBlcnJvcnNcbiAgICAgICAgICAgICAgICB2bS5lcnJvcnMgPSByZXMuZGF0YTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2lucHV0OmVycm9yJywge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiByZXMuZGF0YS5lcnJvci5tZXNzYWdlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3NldHRpbmdzJylcbiAgICAgICAgLmZhY3RvcnkoJ3NldHRpbmdzQWNjb3VudFNlcnZpY2UnLCBzZXR0aW5nc0FjY291bnRTZXJ2aWNlKTtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cbiAgICAgKi9cbiAgICBzZXR0aW5nc0FjY291bnRTZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJywgJ2FwaVNlcnZpY2UnLCAnY29uZmlnJ107XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gJGh0dHBcbiAgICAgKiBAcGFyYW0gYXBpU2VydmljZVxuICAgICAqIEBwYXJhbSBjb25maWdcbiAgICAgKiBAcmV0dXJucyB7e3VwZGF0ZVVzZXJuYW1lOiB1cGRhdGVVc2VybmFtZSwgdXBkYXRlQmlvOiB1cGRhdGVCaW99fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNldHRpbmdzQWNjb3VudFNlcnZpY2UoJGh0dHAsIGFwaVNlcnZpY2UsIGNvbmZpZykge1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIHVwZGF0ZVVzZXJuYW1lOiB1cGRhdGVVc2VybmFtZSxcbiAgICAgICAgICAgIHVwZGF0ZUJpbzogdXBkYXRlQmlvXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVwZGF0ZSB1c2VycyB1c2VybmFtZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIGRhdGFcbiAgICAgICAgICogQHJldHVybnMgeyp9XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiB1cGRhdGVVc2VybmFtZShkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucHV0KGNvbmZpZy51cmwgKyAnL3NldHRpbmdzL2FjY291bnQvdXNlcm5hbWUnLCBkYXRhKVxuICAgICAgICAgICAgICAgIC50aGVuKGFwaVNlcnZpY2UuaGFuZGxlU3VjY2VzcywgYXBpU2VydmljZS5oYW5kbGVFcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVXBkYXRlIHVzZXJzIGJpby5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIGRhdGFcbiAgICAgICAgICogQHJldHVybnMgeyp9XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiB1cGRhdGVCaW8oZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dChjb25maWcudXJsICsgJy9zZXR0aW5ncy9hY2NvdW50L2JpbycsIGRhdGEpXG4gICAgICAgICAgICAgICAgLnRoZW4oYXBpU2VydmljZS5oYW5kbGVTdWNjZXNzLCBhcGlTZXJ2aWNlLmhhbmRsZUVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
